!function(){"use strict";function o(o){if(!(o.driver instanceof Object))throw new Error("Driver parameter mast be set!");this.options=o,this.options.skip=o.skip||[];var e=window.location.pathname.replace(/\/.*\..*?$/g,"/");this.options.qoobUrl=this.options.qoobUrl||window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")+e+(-1!==e.indexOf("/",e.length-"/".length)?"":"/")+"qoob/",this.options.qoobUrl=this.options.qoobUrl+(-1!==this.options.qoobUrl.indexOf("/",this.options.qoobUrl.length-"/".length)?"":"/"),this.options.debug=this.options.debug||!1,this.options.mode=this.options.mode||"prod",this.options.skin=this.options.skin||"simple",this.options.skinUrl=this.options.skinUrl||this.options.qoobUrl+"skins/"+this.options.skin+"/",this.options.librariesData=this.options.librariesData||[],this.options.pageData=this.options.pageData||{},this.options.translations=this.options.translations||null,window.onload=this.startStage1.bind(this)}o.prototype.loadingProgress=function(o,e,t,i){var n=this.loader.getCountLoaded()-this.loader.stageLoaded,r=100*(i+n)/(o+e+i+n),a=parseInt((this.loader.stage-1)*(100/7)+100/7/100*r);document.getElementById("qoob_loader_precent").innerHTML=a,100==a&&this.loadingComplete()},o.prototype.loadingComplete=function(){null!==document.getElementById("qoob_loader_precent")&&(document.getElementById("qoob_loader_precent").innerHTML=100,this.loader.off("progress",this.loadingProgressListener),jQuery("#loader-wrapper").delay(100).fadeOut(1e3,function(){jQuery("#loader-wrapper").remove()}))},o.prototype.startStage1=function(){var o=this,e=document.createElement("script");e.setAttribute("type","text/javascript"),e.setAttribute("src",this.options.qoobUrl+"loader.min.js"),e.onload=function(){o.loader=new Loader,o.loader.stage=1,o.loader.stageLoaded=0,o.options.loader=o.loader,o.attachLoaderHTML(),o.loadingProgressListener=o.loadingProgress.bind(o),o.options.loader.on("progress",o.loadingProgressListener);for(var e=0;e<o.options.skip.length;e++)o.loader.loaded[o.options.skip[e]]=1;o.loader.add([{type:"js",name:"jquery",src:o.options.qoobUrl+"libs/jquery.min.js"},{type:"js",name:"underscore",src:o.options.qoobUrl+"libs/underscore.min.js",dep:["jquery"]},{type:"js",name:"backbone",src:o.options.qoobUrl+"libs/backbone-min.js",dep:["jquery","underscore"]},{type:"js",name:"handlebars",src:o.options.qoobUrl+"libs/handlebars.min-latest.js"},{type:"js",name:"handlebars-helper",src:o.options.qoobUrl+"libs/handlebars-helper.js",dep:["handlebars"]}]),o.loader.once("complete",o.startStage2.bind(o)),o.loader.start()},e.onerror=function(){console.error("Can't load loader.js file")},document.head.appendChild(e)},o.prototype.startStage2=function(){var o=this;o.loader.stage=2,o.loader.stageLoaded=o.loader.getCountLoaded(),this.options.driver.loadLibrariesData(function(e,t){if(e)console.error("Libraries have been not loaded from driver "+o.options.driver.constructor.name+"."+e);else if(void 0!==t){for(var i=0;i<t.length;i++){var n=t[i].url.replace(/\/+$/g,"")+"/";if(t[i].res)for(var r=t[i].res,a=0;a<r.length;a++)r[a].backend&&!0===r[a].backend&&(0!==r[a].src.indexOf("http://")&&0!==r[a].src.indexOf("https://")&&(r[a].src=n+r[a].src.replace(/^\/+/g,"")),o.loader.add(r[a]));var s=t[i].blocks;if(void 0!==s)for(var l=0;l<s.length;l++)void 0!==s[l]&&(s[l].url=s[l].url.replace(/\/+$/g,"")+"/",0!==s[l].url.indexOf("http://")&&0!==s[l].url.indexOf("https://")&&(s[l].url=n+s[l].url),s[l].config_url?0!==s[l].config_url.indexOf("http://")&&0!==s[l].config_url.indexOf("https://")&&(s[l].config_url=n+s[l].config_url.replace(/^\/+/g,"")):s[l].config_url=s[l].url+"config.json",o.loader.add({type:"json",name:t[i].name+"_"+s[l].name,src:s[l].config_url}))}o.loader.once("complete",function(){o.options.librariesData=o.parseBlockData(t),o.startStage3()})}else console.error("Libraries have been not loaded from driver "+o.options.driver.constructor.name+". Check 'loadLibrariesData' method.")})},o.prototype.startStage3=function(){var o=this;o.loader.stage=3,o.loader.stageLoaded=o.loader.getCountLoaded(),o.options.driver.loadPageData(function(e,t){o.options.pageData=t,o.startStage4()})},o.prototype.startStage4=function(){var o=this;o.loader.stage=4,o.loader.stageLoaded=o.loader.getCountLoaded(),void 0!==o.options.driver.translationsUrl?o.options.driver.loadTranslations(function(e,t){o.options.translations=t,o.startStage5()}):o.startStage5()},o.prototype.startStage5=function(){var o=this;o.loader.stage=5,o.loader.stageLoaded=o.loader.getCountLoaded(),o.loader.once("complete",function(){window.qoob=new Skin,o.loader.stage=6,o.loader.stageLoaded=o.loader.getCountLoaded(),o.loader.once("complete",function(){o.loader.stage=7,o.loader.stageLoaded=o.loader.getCountLoaded(),o.loader.once("skin_loaded",function(){o.loadingComplete()}),window.qoob.activate(o.options)}),o.loader.add(window.qoob.assets[o.options.mode],{prefix:o.options.skinUrl}),o.loader.add(window.qoob.assets.all,{prefix:o.options.skinUrl})}),o.loader.add({type:"js",src:o.options.skinUrl+"skin.js",name:"skin"}),o.options.driver.assets&&o.loader.add(o.options.driver.assets)},o.prototype.applyGlobalMask=function(o){for(var e=function(e){var t=e.replace(/%lib_url\(|\)%\/|%lib_url\(|\)%/g,"").trim(),i=_.findWhere(o,{name:t.trim()});if(i)return i.url},t=function(e){var t,i,a,s,l=e.replace(/%block_url\(|\)%\/|%block_url\(|\)%/g,"").split(",");if(2===l.length)t=l[0],i=l[1];else{if(1!==l.length)return e;t=n.name,i=l[0]}if(a=_.findWhere(o,{name:t.trim()}))return(s=_.findWhere(a.blocks,{name:i}))?s.url:(console.error("Can't apply mask '"+e+"' for block '"+n.blocks[r].name+"' in lib '"+n.name+"'. Block '"+i+"' not found in '"+t+"'."),e)},i=0;i<o.length;i++){var n=o[i];if(void 0!==n.blocks)for(var r=0;r<n.blocks.length;r++)if(void 0!==o[i].blocks[r]){var a=JSON.stringify(o[i].blocks[r].config);a=(a=a.replace(/%lib_url\(.*?\)%\/|%lib_url\(.*?\)%/g,e)).replace(/%block_url\(.*?\)%\/|%block_url\(.*?\)%/g,t),n.blocks[r]=_.extend(JSON.parse(a),n.blocks[r])}}return o},o.prototype.applySelfMask=function(o,e,t){var i=JSON.stringify(o);return i=(i=i.replace(/%lib_url%\/|%lib_url%/g,function(o){return e})).replace(/%block_url%\/|%block_url%/g,function(o){return t}),JSON.parse(i)},o.prototype.parseBlockData=function(o){for(var e=[],t=0;t<o.length;t++){var i=o[t];if(void 0!==i.blocks)for(var n=0;n<i.blocks.length;n++)this.loader.loaded[i.name+"_"+i.blocks[n].name]?(i.blocks[n].lib=i.name,i.blocks[n].config=this.applySelfMask(this.loader.loaded[i.name+"_"+i.blocks[n].name].data,i.url,i.blocks[n].url)):delete i.blocks[n];e.push(i)}return this.applyGlobalMask(e)},o.prototype.getLoaderHTML=function(){return"<div id='loader-wrapper' style=' font-size: 20px; font-weight: 700; font-family: robotobold, sans-serif; position: relative; line-height: 1;  z-index: 9999; height: 100vh; background-color: #fff; display: flex; align-items: center; justify-content: center;'><div class='loading-panel' style='text-align: center;  letter-spacing: 0.05em; color: #010833; -webkit-transition: -webkit-transform .5s ease 0s; -moz-transition: -moz-transform .5s ease 0s; -o-transition: -o-transform .5s ease 0s; transition: transform .5s ease 0s;  width: 100%;'><span>Loading <span id='qoob_loader_precent'>0</span>%</span><div class='loading-dots' style='margin: 19px auto 0 auto;'><div class='loading-dot' style='width: 18px; height: 18px; margin-right: 7px; background-color: #010833; border-radius: 100%; display: inline-block; -webkit-animation: block-elements 1.4s ease-in-out 0s infinite both; animation: block-elements 1.4s ease-in-out 0s infinite both; -webkit-animation-delay: -.32s; animation-delay: -.32s;'></div><div class='loading-dot' style='width: 18px; height: 18px; margin-right: 7px; background-color: #010833; border-radius: 100%; display: inline-block; -webkit-animation: block-elements 1.4s ease-in-out 0s infinite both; animation: block-elements 1.4s ease-in-out 0s infinite both; -webkit-animation-delay: -.16s; animation-delay: -.16s;'></div><div class='loading-dot' style='width: 18px; height: 18px; margin-right: 7px; background-color: #010833; border-radius: 100%; display: inline-block; -webkit-animation: block-elements 1.4s ease-in-out 0s infinite both; animation: block-elements 1.4s ease-in-out 0s infinite both; margin-right: 0;'></div></div></div><style>html {-webkit-box-sizing: border-box;box-sizing: border-box;}*,*:before,*:after {-webkit-box-sizing: inherit;box-sizing: inherit;}body {margin:0; overflow: hidden; line-height: 1;}@-webkit-keyframes block-elements {0%,100%,80%{-webkit-transform:scale(0);transform:scale(0)}40%{-webkit-transform:scale(1);transform:scale(1)}}@keyframes block-elements {0%,100%,80%{-webkit-transform:scale(0);transform:scale(0)}40%{-webkit-transform:scale(1);transform:scale(1)}}   </style></div>"},o.prototype.attachLoaderHTML=function(){document.body.innerHTML=this.getLoaderHTML()+document.body.innerHTML},window.QoobStarter=o,window.QoobVersion="3.0.4"}();