!function(){"use strict";function a(a){if(!(a.driver instanceof Object))throw new Error("Driver parameter mast be set!");this.options=a,this.options.skip=a.skip||[];var b=window.location.pathname.replace(/\/.*\..*?$/g,"/");this.options.qoobUrl=this.options.qoobUrl||window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")+b+(-1!==b.indexOf("/",b.length-"/".length)?"":"/")+"qoob/",this.options.qoobUrl=this.options.qoobUrl+(-1!==this.options.qoobUrl.indexOf("/",this.options.qoobUrl.length-"/".length)?"":"/"),this.options.debug=this.options.debug||!1,this.options.mode=this.options.mode||"prod",this.options.skin=this.options.skin||"black",this.options.skinUrl=this.options.skinUrl||this.options.qoobUrl+"skins/"+this.options.skin+"/",this.options.librariesData=this.options.librariesData||[],this.options.pageData=this.options.pageData||{},window.onload=this.startStage1.bind(this)}a.prototype.loadingProgress=function(a,b,c,d){var e=this.loader.getCountLoaded()-this.loader.stageLoaded,f=a+b+d+e,g=100*(d+e)/f,h=parseInt((this.loader.stage-1)*(100/6)+100/6/100*g);document.getElementById("qoob_loader_precent").innerHTML=h,100==h&&this.loadingComplete()},a.prototype.loadingComplete=function(){document.getElementById("qoob_loader_precent").innerHTML=100,this.loader.off("progress",this.loadingProgressListener),jQuery("#loader-wrapper").delay(100).fadeOut(1e3,function(){jQuery("#loader-wrapper").remove()})},a.prototype.startStage1=function(){var a=this,b=document.createElement("script");b.setAttribute("type","text/javascript"),b.setAttribute("src",this.options.qoobUrl+"loader.min.js"),b.onload=function(){a.loader=new Loader,a.loader.stage=1,a.loader.stageLoaded=0,a.options.loader=a.loader,a.attachLoaderHTML(),a.loadingProgressListener=a.loadingProgress.bind(a),a.options.loader.on("progress",a.loadingProgressListener);for(var b=0;b<a.options.skip.length;b++)a.loader.loaded[a.options.skip[b]]=1;a.loader.add([{type:"js",name:"jquery",src:a.options.qoobUrl+"libs/jquery.min.js"},{type:"js",name:"underscore",src:a.options.qoobUrl+"libs/underscore.min.js",dep:["jquery"]},{type:"js",name:"backbone",src:a.options.qoobUrl+"libs/backbone-min.js",dep:["jquery","underscore"]},{type:"js",name:"handlebars",src:a.options.qoobUrl+"libs/handlebars.min-latest.js"},{type:"js",name:"handlebars-helper",src:a.options.qoobUrl+"libs/handlebars-helper.js",dep:["handlebars"]}]),a.loader.once("complete",a.startStage2.bind(a)),a.loader.start()},b.onerror=function(){console.error("Can't load loader.js file")},document.head.appendChild(b)},a.prototype.startStage2=function(){var a=this;a.loader.stage=2,a.loader.stageLoaded=a.loader.getCountLoaded(),this.options.driver.loadLibrariesData(function(b,c){if(b)return void console.error("Libraries have been not loaded from driver "+a.options.driver.constructor.name+"."+b);if(void 0===c)return void console.error("Libraries have been not loaded from driver "+a.options.driver.constructor.name+". Check 'loadLibrariesData' method.");for(var d=0;d<c.length;d++){var e=c[d].url.replace(/\/+$/g,"")+"/";if(c[d].res)for(var f=c[d].res,g=0;g<f.length;g++)f[g].backend&&!0===f[g].backend&&(0!==f[g].src.indexOf("http://")&&0!==f[g].src.indexOf("https://")&&(f[g].src=e+f[g].src.replace(/^\/+/g,"")),a.loader.add(f[g]));var h=c[d].blocks;if(void 0!==h)for(var i=0;i<h.length;i++)void 0!==h[i]&&(h[i].url=h[i].url.replace(/\/+$/g,"")+"/",0!==h[i].url.indexOf("http://")&&0!==h[i].url.indexOf("https://")&&(h[i].url=e+h[i].url),h[i].config_url?0!==h[i].config_url.indexOf("http://")&&0!==h[i].config_url.indexOf("https://")&&(h[i].config_url=e+h[i].config_url.replace(/^\/+/g,"")):h[i].config_url=h[i].url+"config.json",a.loader.add({type:"json",name:c[d].name+"_"+h[i].name,src:h[i].config_url}))}a.loader.once("complete",function(){a.options.librariesData=a.parseBlockData(c),a.startStage3()})})},a.prototype.startStage3=function(){var a=this;a.loader.stage=3,a.loader.stageLoaded=a.loader.getCountLoaded(),a.options.driver.loadPageData(function(b,c){a.options.pageData=c,a.startStage4()})},a.prototype.startStage4=function(){var a=this;a.loader.stage=4,a.loader.stageLoaded=a.loader.getCountLoaded(),a.loader.once("complete",function(){window.qoob=new Skin,a.loader.stage=5,a.loader.stageLoaded=a.loader.getCountLoaded(),a.loader.once("complete",function(){a.loader.stage=6,a.loader.stageLoaded=a.loader.getCountLoaded(),a.loader.once("skin_loaded",function(){a.loadingComplete()}),window.qoob.activate(a.options)}),a.loader.add(window.qoob.assets[a.options.mode],{prefix:a.options.skinUrl}),a.loader.add(window.qoob.assets.all,{prefix:a.options.skinUrl})}),a.loader.add({type:"js",src:a.options.skinUrl+"skin.js",name:"skin"}),a.options.driver.assets&&a.loader.add(a.options.driver.assets)},a.prototype.applyGlobalMask=function(a){for(var b=function(b){var c=b.replace(/%lib_url\(|\)%\/|%lib_url\(|\)%/g,"").trim(),d=_.findWhere(a,{name:c.trim()});if(d)return d.url},c=function(b){var c,d,g,h,i=b.replace(/%block_url\(|\)%\/|%block_url\(|\)%/g,""),j=i.split(",");if(2===j.length)c=j[0],d=j[1];else{if(1!==j.length)return b;c=e.name,d=j[0]}if(g=_.findWhere(a,{name:c.trim()}))return h=_.findWhere(g.blocks,{name:d}),h?h.url:(console.error("Can't apply mask '"+b+"' for block '"+e.blocks[f].name+"' in lib '"+e.name+"'. Block '"+d+"' not found in '"+c+"'."),b)},d=0;d<a.length;d++){var e=a[d];if(void 0!==e.blocks)for(var f=0;f<e.blocks.length;f++)if(void 0!==a[d].blocks[f]){var g=JSON.stringify(a[d].blocks[f].config);g=g.replace(/%lib_url\(.*?\)%\/|%lib_url\(.*?\)%/g,b),g=g.replace(/%block_url\(.*?\)%\/|%block_url\(.*?\)%/g,c),e.blocks[f]=_.extend(JSON.parse(g),e.blocks[f])}}return a},a.prototype.applySelfMask=function(a,b,c){var d=JSON.stringify(a);return d=d.replace(/%lib_url%\/|%lib_url%/g,function(a){return b}),d=d.replace(/%block_url%\/|%block_url%/g,function(a){return c}),JSON.parse(d)},a.prototype.parseBlockData=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];if(void 0!==d.blocks)for(var e=0;e<d.blocks.length;e++)this.loader.loaded[d.name+"_"+d.blocks[e].name]?(d.blocks[e].lib=d.name,d.blocks[e].config=this.applySelfMask(this.loader.loaded[d.name+"_"+d.blocks[e].name].data,d.url,d.blocks[e].url)):delete d.blocks[e];b.push(d)}return this.applyGlobalMask(b)},a.prototype.getLoaderHTML=function(){return"<div id='loader-wrapper' style=' font-size: 20px; font-weight: 700; font-family: robotobold, sans-serif; position: relative; line-height: 1;  z-index: 9999; height: 100vh; background-color: #fff; display: flex; align-items: center; justify-content: center;'><div class='loading-panel' style='text-align: center;  letter-spacing: 0.05em; color: #010833; -webkit-transition: -webkit-transform .5s ease 0s; -moz-transition: -moz-transform .5s ease 0s; -o-transition: -o-transform .5s ease 0s; transition: transform .5s ease 0s;  width: 100%;'><span>Loading <span id='qoob_loader_precent'>0</span>%</span><div class='loading-dots' style='margin: 19px auto 0 auto;'><div class='loading-dot' style='width: 18px; height: 18px; margin-right: 7px; background-color: #010833; border-radius: 100%; display: inline-block; -webkit-animation: block-elements 1.4s ease-in-out 0s infinite both; animation: block-elements 1.4s ease-in-out 0s infinite both; -webkit-animation-delay: -.32s; animation-delay: -.32s;'></div><div class='loading-dot' style='width: 18px; height: 18px; margin-right: 7px; background-color: #010833; border-radius: 100%; display: inline-block; -webkit-animation: block-elements 1.4s ease-in-out 0s infinite both; animation: block-elements 1.4s ease-in-out 0s infinite both; -webkit-animation-delay: -.16s; animation-delay: -.16s;'></div><div class='loading-dot' style='width: 18px; height: 18px; margin-right: 7px; background-color: #010833; border-radius: 100%; display: inline-block; -webkit-animation: block-elements 1.4s ease-in-out 0s infinite both; animation: block-elements 1.4s ease-in-out 0s infinite both; margin-right: 0;'></div></div></div><style>html {-webkit-box-sizing: border-box;box-sizing: border-box;}*,*:before,*:after {-webkit-box-sizing: inherit;box-sizing: inherit;}body {margin:0; overflow: hidden; line-height: 1;}@-webkit-keyframes block-elements {0%,100%,80%{-webkit-transform:scale(0);transform:scale(0)}40%{-webkit-transform:scale(1);transform:scale(1)}}@keyframes block-elements {0%,100%,80%{-webkit-transform:scale(0);transform:scale(0)}40%{-webkit-transform:scale(1);transform:scale(1)}}   </style></div>"},a.prototype.attachLoaderHTML=function(){document.body.innerHTML=this.getLoaderHTML()+document.body.innerHTML},window.QoobStarter=a,window.QoobVersion="2.0.4"}();