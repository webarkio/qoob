!function(){"use strict";function o(o){if(!(o.driver instanceof Object))throw new Error("Driver parameter mast be set!");this.options=o,this.options.skip=o.skip||[];var e=window.location.pathname.replace(/\/.*\..*?$/g,"/");this.options.qoobUrl=this.options.qoobUrl||window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")+e+(-1!==e.indexOf("/",e.length-"/".length)?"":"/")+"qoob/",this.options.qoobUrl=this.options.qoobUrl+(-1!==this.options.qoobUrl.indexOf("/",this.options.qoobUrl.length-"/".length)?"":"/"),this.options.debug=this.options.debug||!1,this.options.mode=this.options.mode||"prod",this.options.skin=this.options.skin||"simple",this.options.skinUrl=this.options.skinUrl||this.options.qoobUrl+"skins/"+this.options.skin+"/",this.options.librariesData=this.options.librariesData||[],this.options.pageData=this.options.pageData||{},this.options.translations=this.options.translations||null,window.onload=this.startStage1.bind(this)}o.prototype.loadingProgress=function(o,e,t,i){var n=this.loader.getCountLoaded()-this.loader.stageLoaded,r=100*(i+n)/(o+e+i+n),a=parseInt((this.loader.stage-1)*(100/7)+100/7/100*r);100==(document.getElementById("qoob_loader_precent").innerHTML=a)&&this.loadingComplete()},o.prototype.loadingComplete=function(){null!==document.getElementById("qoob_loader_precent")&&(document.getElementById("qoob_loader_precent").innerHTML=100,this.loader.off("progress",this.loadingProgressListener),jQuery("#loader-wrapper").delay(100).fadeOut(1e3,function(){jQuery("#loader-wrapper").remove()}))},o.prototype.startStage1=function(){var e=this,o=document.createElement("script");o.setAttribute("type","text/javascript"),o.setAttribute("src",this.options.qoobUrl+"loader.min.js"),o.onload=function(){e.loader=new Loader,e.loader.stage=1,e.loader.stageLoaded=0,e.options.loader=e.loader,e.attachLoaderHTML(),e.loadingProgressListener=e.loadingProgress.bind(e),e.options.loader.on("progress",e.loadingProgressListener);for(var o=0;o<e.options.skip.length;o++)e.loader.loaded[e.options.skip[o]]=1;e.loader.add([{type:"js",name:"jquery",src:e.options.qoobUrl+"libs/jquery.min.js"},{type:"js",name:"underscore",src:e.options.qoobUrl+"libs/underscore.min.js",dep:["jquery"]},{type:"js",name:"backbone",src:e.options.qoobUrl+"libs/backbone-min.js",dep:["jquery","underscore"]},{type:"js",name:"handlebars",src:e.options.qoobUrl+"libs/handlebars.min-latest.js"},{type:"js",name:"handlebars-helper",src:e.options.qoobUrl+"libs/handlebars-helper.js",dep:["handlebars"]}]),e.loader.once("complete",e.startStage2.bind(e)),e.loader.start()},o.onerror=function(){console.error("Can't load loader.js file")},document.head.appendChild(o)},o.prototype.startStage2=function(){var l=this;l.loader.stage=2,l.loader.stageLoaded=l.loader.getCountLoaded(),this.options.driver.loadLibrariesData(function(o,e){if(o)console.error("Libraries have been not loaded from driver "+l.options.driver.constructor.name+"."+o);else if(void 0!==e){for(var t=0;t<e.length;t++){var i=e[t].url.replace(/\/+$/g,"")+"/";if(e[t].res)for(var n=e[t].res,r=0;r<n.length;r++)n[r].backend&&!0===n[r].backend&&(0!==n[r].src.indexOf("http://")&&0!==n[r].src.indexOf("https://")&&(n[r].src=i+n[r].src.replace(/^\/+/g,"")),l.loader.add(n[r]));var a=e[t].blocks;if(void 0!==a)for(var s=0;s<a.length;s++)void 0!==a[s]&&(a[s].url=a[s].url.replace(/\/+$/g,"")+"/",0!==a[s].url.indexOf("http://")&&0!==a[s].url.indexOf("https://")&&(a[s].url=i+a[s].url),a[s].config_url?0!==a[s].config_url.indexOf("http://")&&0!==a[s].config_url.indexOf("https://")&&(a[s].config_url=i+a[s].config_url.replace(/^\/+/g,"")):a[s].config_url=a[s].url+"config.json",l.loader.add({type:"json",name:e[t].name+"_"+a[s].name,src:a[s].config_url}))}l.loader.once("complete",function(){l.options.librariesData=l.parseBlockData(e),l.startStage3()})}else console.error("Libraries have been not loaded from driver "+l.options.driver.constructor.name+". Check 'loadLibrariesData' method.")})},o.prototype.startStage3=function(){var t=this;t.loader.stage=3,t.loader.stageLoaded=t.loader.getCountLoaded(),t.options.driver.loadPageData(function(o,e){t.options.pageData=e,t.startStage4()})},o.prototype.startStage4=function(){var t=this;t.loader.stage=4,t.loader.stageLoaded=t.loader.getCountLoaded(),void 0!==t.options.driver.translationsUrl?t.options.driver.loadTranslations(function(o,e){t.options.translations=e,t.startStage5()}):t.startStage5()},o.prototype.startStage5=function(){var o=this;o.loader.stage=5,o.loader.stageLoaded=o.loader.getCountLoaded(),o.loader.once("complete",function(){window.qoob=new Skin,o.loader.stage=6,o.loader.stageLoaded=o.loader.getCountLoaded(),o.loader.once("complete",function(){o.loader.stage=7,o.loader.stageLoaded=o.loader.getCountLoaded(),o.loader.once("skin_loaded",function(){o.loadingComplete()}),window.qoob.activate(o.options)}),o.loader.add(window.qoob.assets[o.options.mode],{prefix:o.options.skinUrl}),o.loader.add(window.qoob.assets.all,{prefix:o.options.skinUrl})}),o.loader.add({type:"js",src:o.options.skinUrl+"skin.js",name:"skin"}),o.options.driver.assets&&o.loader.add(o.options.driver.assets)},o.prototype.applyGlobalMask=function(a){for(var o=function(o){var e=o.replace(/%lib_url\(|\)%\/|%lib_url\(|\)%/g,"").trim(),t=_.findWhere(a,{name:e.trim()});if(t)return t.url},e=function(o){var e,t,i,n,r=o.replace(/%block_url\(|\)%\/|%block_url\(|\)%/g,"").split(",");if(2===r.length)e=r[0],t=r[1];else{if(1!==r.length)return o;e=s.name,t=r[0]}if(i=_.findWhere(a,{name:e.trim()}))return(n=_.findWhere(i.blocks,{name:t}))?n.url:(console.error("Can't apply mask '"+o+"' for block '"+s.blocks[l].name+"' in lib '"+s.name+"'. Block '"+t+"' not found in '"+e+"'."),o)},t=0;t<a.length;t++){var s=a[t];if(void 0!==s.blocks)for(var l=0;l<s.blocks.length;l++)if(void 0!==a[t].blocks[l]){var i=JSON.stringify(a[t].blocks[l].config);i=(i=i.replace(/%lib_url\(.*?\)%\/|%lib_url\(.*?\)%/g,o)).replace(/%block_url\(.*?\)%\/|%block_url\(.*?\)%/g,e),s.blocks[l]=_.extend(JSON.parse(i),s.blocks[l])}}return a},o.prototype.applySelfMask=function(o,e,t){var i=JSON.stringify(o);return i=(i=i.replace(/%lib_url%\/|%lib_url%/g,function(o){return e})).replace(/%block_url%\/|%block_url%/g,function(o){return t}),JSON.parse(i)},o.prototype.parseBlockData=function(o){for(var e=[],t=0;t<o.length;t++){var i=o[t];if(void 0!==i.blocks)for(var n=0;n<i.blocks.length;n++)this.loader.loaded[i.name+"_"+i.blocks[n].name]?(i.blocks[n].lib=i.name,i.blocks[n].config=this.applySelfMask(this.loader.loaded[i.name+"_"+i.blocks[n].name].data,i.url,i.blocks[n].url)):delete i.blocks[n];e.push(i)}return this.applyGlobalMask(e)},o.prototype.getLoaderHTML=function(){return"<div id='loader-wrapper' style=' font-size: 20px; font-weight: 700; font-family: robotobold, sans-serif; position: relative; line-height: 1;  z-index: 9999; height: 100vh; background-color: #fff; display: flex; align-items: center; justify-content: center;'><div class='loading-panel' style='text-align: center;  letter-spacing: 0.05em; color: #010833; -webkit-transition: -webkit-transform .5s ease 0s; -moz-transition: -moz-transform .5s ease 0s; -o-transition: -o-transform .5s ease 0s; transition: transform .5s ease 0s;  width: 100%;'><span>Loading <span id='qoob_loader_precent'>0</span>%</span><div class='loading-dots' style='margin: 19px auto 0 auto;'><div class='loading-dot' style='width: 18px; height: 18px; margin-right: 7px; background-color: #010833; border-radius: 100%; display: inline-block; -webkit-animation: block-elements 1.4s ease-in-out 0s infinite both; animation: block-elements 1.4s ease-in-out 0s infinite both; -webkit-animation-delay: -.32s; animation-delay: -.32s;'></div><div class='loading-dot' style='width: 18px; height: 18px; margin-right: 7px; background-color: #010833; border-radius: 100%; display: inline-block; -webkit-animation: block-elements 1.4s ease-in-out 0s infinite both; animation: block-elements 1.4s ease-in-out 0s infinite both; -webkit-animation-delay: -.16s; animation-delay: -.16s;'></div><div class='loading-dot' style='width: 18px; height: 18px; margin-right: 7px; background-color: #010833; border-radius: 100%; display: inline-block; -webkit-animation: block-elements 1.4s ease-in-out 0s infinite both; animation: block-elements 1.4s ease-in-out 0s infinite both; margin-right: 0;'></div></div></div><style>html {-webkit-box-sizing: border-box;box-sizing: border-box;}*,*:before,*:after {-webkit-box-sizing: inherit;box-sizing: inherit;}body {margin:0; overflow: hidden; line-height: 1;}@-webkit-keyframes block-elements {0%,100%,80%{-webkit-transform:scale(0);transform:scale(0)}40%{-webkit-transform:scale(1);transform:scale(1)}}@keyframes block-elements {0%,100%,80%{-webkit-transform:scale(0);transform:scale(0)}40%{-webkit-transform:scale(1);transform:scale(1)}}   </style></div>"},o.prototype.attachLoaderHTML=function(){document.body.innerHTML=this.getLoaderHTML()+document.body.innerHTML},window.QoobStarter=o,window.QoobVersion="3.0.5"}();