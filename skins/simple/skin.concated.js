"use strict";function QoobStorage(a){this.loader=a.loader,this.driver=a.driver||new LocalDriver,this.skinTemplates=a.loader.loaded.skin_templates.data||null,this.librariesData=a.librariesData||{},this.pageData=a.pageData||null,this.blockTemplates=[],this.blockTemplateAdapter=a.blockTemplateAdapter||"hbs",this.pageTemplatesCollection=new Backbone.Collection}if(function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function b(a){for(var b=a.css("visibility");"inherit"===b;)a=a.parent(),b=a.css("visibility");return"hidden"!==b}a.ui=a.ui||{},a.ui.version="1.12.1";var c=0,d=Array.prototype.slice;a.cleanData=function(b){return function(c){var d,e,f;for(f=0;null!=(e=c[f]);f++)try{(d=a._data(e,"events"))&&d.remove&&a(e).triggerHandler("remove")}catch(a){}b(c)}}(a.cleanData),a.widget=function(b,c,d){var e,f,g,h={},i=b.split(".")[0];b=b.split(".")[1];var j=i+"-"+b;return d||(d=c,c=a.Widget),a.isArray(d)&&(d=a.extend.apply(null,[{}].concat(d))),a.expr[":"][j.toLowerCase()]=function(b){return!!a.data(b,j)},a[i]=a[i]||{},e=a[i][b],f=a[i][b]=function(a,b){return this._createWidget?void(arguments.length&&this._createWidget(a,b)):new f(a,b)},a.extend(f,e,{version:d.version,_proto:a.extend({},d),_childConstructors:[]}),g=new c,g.options=a.widget.extend({},g.options),a.each(d,function(b,d){return a.isFunction(d)?void(h[b]=function(){function a(){return c.prototype[b].apply(this,arguments)}function e(a){return c.prototype[b].apply(this,a)}return function(){var b,c=this._super,f=this._superApply;return this._super=a,this._superApply=e,b=d.apply(this,arguments),this._super=c,this._superApply=f,b}}()):void(h[b]=d)}),f.prototype=a.widget.extend(g,{widgetEventPrefix:e?g.widgetEventPrefix||b:b},h,{constructor:f,namespace:i,widgetName:b,widgetFullName:j}),e?(a.each(e._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,f,c._proto)}),delete e._childConstructors):c._childConstructors.push(f),a.widget.bridge(b,f),f},a.widget.extend=function(b){for(var c,e,f=d.call(arguments,1),g=0,h=f.length;h>g;g++)for(c in f[g])e=f[g][c],f[g].hasOwnProperty(c)&&void 0!==e&&(b[c]=a.isPlainObject(e)?a.isPlainObject(b[c])?a.widget.extend({},b[c],e):a.widget.extend({},e):e);return b},a.widget.bridge=function(b,c){var e=c.prototype.widgetFullName||b;a.fn[b]=function(f){var g="string"==typeof f,h=d.call(arguments,1),i=this;return g?this.length||"instance"!==f?this.each(function(){var c,d=a.data(this,e);return"instance"===f?(i=d,!1):d?a.isFunction(d[f])&&"_"!==f.charAt(0)?(c=d[f].apply(d,h),c!==d&&void 0!==c?(i=c&&c.jquery?i.pushStack(c.get()):c,!1):void 0):a.error("no such method '"+f+"' for "+b+" widget instance"):a.error("cannot call methods on "+b+" prior to initialization; attempted to call method '"+f+"'")}):i=void 0:(h.length&&(f=a.widget.extend.apply(null,[f].concat(h))),this.each(function(){var b=a.data(this,e);b?(b.option(f||{}),b._init&&b._init()):a.data(this,e,new c(f,this))})),i}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(b,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=a(),this.hoverable=a(),this.focusable=a(),this.classesElementLookup={},d!==this&&(a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){var b=this;this._destroy(),a.each(this.classesElementLookup,function(a,c){b._removeClass(c,a)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:a.noop,widget:function(){return this.element},option:function(b,c){var d,e,f,g=b;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof b)if(g={},d=b.split("."),b=d.shift(),d.length){for(e=g[b]=a.widget.extend({},this.options[b]),f=0;d.length-1>f;f++)e[d[f]]=e[d[f]]||{},e=e[d[f]];if(b=d.pop(),1===arguments.length)return void 0===e[b]?null:e[b];e[b]=c}else{if(1===arguments.length)return void 0===this.options[b]?null:this.options[b];g[b]=c}return this._setOptions(g),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return"classes"===a&&this._setOptionClasses(b),this.options[a]=b,"disabled"===a&&this._setOptionDisabled(b),this},_setOptionClasses:function(b){var c,d,e;for(c in b)e=this.classesElementLookup[c],b[c]!==this.options.classes[c]&&e&&e.length&&(d=a(e.get()),this._removeClass(e,c),d.addClass(this._classes({element:d,keys:c,classes:b,add:!0})))},_setOptionDisabled:function(a){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!a),a&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(b){function c(c,f){var g,h;for(h=0;c.length>h;h++)g=e.classesElementLookup[c[h]]||a(),g=a(b.add?a.unique(g.get().concat(b.element.get())):g.not(b.element).get()),e.classesElementLookup[c[h]]=g,d.push(c[h]),f&&b.classes[c[h]]&&d.push(b.classes[c[h]])}var d=[],e=this;return b=a.extend({element:this.element,classes:this.options.classes||{}},b),this._on(b.element,{remove:"_untrackClassesElement"}),b.keys&&c(b.keys.match(/\S+/g)||[],!0),b.extra&&c(b.extra.match(/\S+/g)||[]),d.join(" ")},_untrackClassesElement:function(b){var c=this;a.each(c.classesElementLookup,function(d,e){-1!==a.inArray(b.target,e)&&(c.classesElementLookup[d]=a(e.not(b.target).get()))})},_removeClass:function(a,b,c){return this._toggleClass(a,b,c,!1)},_addClass:function(a,b,c){return this._toggleClass(a,b,c,!0)},_toggleClass:function(a,b,c,d){d="boolean"==typeof d?d:c;var e="string"==typeof a||null===a,f={extra:e?b:c,keys:e?a:b,element:e?this.element:a,add:d};return f.element.toggleClass(this._classes(f),d),this},_on:function(b,c,d){var e,f=this;"boolean"!=typeof b&&(d=c,c=b,b=!1),d?(c=e=a(c),this.bindings=this.bindings.add(c)):(d=c,c=this.element,e=this.widget()),a.each(d,function(d,g){function h(){return b||!0!==f.options.disabled&&!a(this).hasClass("ui-state-disabled")?("string"==typeof g?f[g]:g).apply(f,arguments):void 0}"string"!=typeof g&&(h.guid=g.guid=g.guid||h.guid||a.guid++);var i=d.match(/^([\w:-]*)\s*(.*)$/),j=i[1]+f.eventNamespace,k=i[2];k?e.on(j,k,h):c.on(j,h)})},_off:function(b,c){c=(c||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,b.off(c).off(c),this.bindings=a(this.bindings.not(b).get()),this.focusable=a(this.focusable.not(b).get()),this.hoverable=a(this.hoverable.not(b).get())},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){this._addClass(a(b.currentTarget),null,"ui-state-hover")},mouseleave:function(b){this._removeClass(a(b.currentTarget),null,"ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){this._addClass(a(b.currentTarget),null,"ui-state-focus")},focusout:function(b){this._removeClass(a(b.currentTarget),null,"ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&!1===g.apply(this.element[0],[c].concat(d))||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?!0===e||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}}),a.widget,function(){function b(a,b,c){return[parseFloat(a[0])*(l.test(a[0])?b/100:1),parseFloat(a[1])*(l.test(a[1])?c/100:1)]}function c(b,c){return parseInt(a.css(b,c),10)||0}function d(b){var c=b[0];return 9===c.nodeType?{width:b.width(),height:b.height(),offset:{top:0,left:0}}:a.isWindow(c)?{width:b.width(),height:b.height(),offset:{top:b.scrollTop(),left:b.scrollLeft()}}:c.preventDefault?{width:0,height:0,offset:{top:c.pageY,left:c.pageX}}:{width:b.outerWidth(),height:b.outerHeight(),offset:b.offset()}}var e,f=Math.max,g=Math.abs,h=/left|center|right/,i=/top|center|bottom/,j=/[\+\-]\d+(\.[\d]+)?%?/,k=/^\w+/,l=/%$/,m=a.fn.position;a.position={scrollbarWidth:function(){if(void 0!==e)return e;var b,c,d=a("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),f=d.children()[0];return a("body").append(d),b=f.offsetWidth,d.css("overflow","scroll"),c=f.offsetWidth,b===c&&(c=d[0].clientWidth),d.remove(),e=b-c},getScrollInfo:function(b){var c=b.isWindow||b.isDocument?"":b.element.css("overflow-x"),d=b.isWindow||b.isDocument?"":b.element.css("overflow-y"),e="scroll"===c||"auto"===c&&b.width<b.element[0].scrollWidth;return{width:"scroll"===d||"auto"===d&&b.height<b.element[0].scrollHeight?a.position.scrollbarWidth():0,height:e?a.position.scrollbarWidth():0}},getWithinInfo:function(b){var c=a(b||window),d=a.isWindow(c[0]),e=!!c[0]&&9===c[0].nodeType;return{element:c,isWindow:d,isDocument:e,offset:d||e?{left:0,top:0}:a(b).offset(),scrollLeft:c.scrollLeft(),scrollTop:c.scrollTop(),width:c.outerWidth(),height:c.outerHeight()}}},a.fn.position=function(e){if(!e||!e.of)return m.apply(this,arguments);e=a.extend({},e);var l,n,o,p,q,r,s=a(e.of),t=a.position.getWithinInfo(e.within),u=a.position.getScrollInfo(t),v=(e.collision||"flip").split(" "),w={};return r=d(s),s[0].preventDefault&&(e.at="left top"),n=r.width,o=r.height,p=r.offset,q=a.extend({},p),a.each(["my","at"],function(){var a,b,c=(e[this]||"").split(" ");1===c.length&&(c=h.test(c[0])?c.concat(["center"]):i.test(c[0])?["center"].concat(c):["center","center"]),c[0]=h.test(c[0])?c[0]:"center",c[1]=i.test(c[1])?c[1]:"center",a=j.exec(c[0]),b=j.exec(c[1]),w[this]=[a?a[0]:0,b?b[0]:0],e[this]=[k.exec(c[0])[0],k.exec(c[1])[0]]}),1===v.length&&(v[1]=v[0]),"right"===e.at[0]?q.left+=n:"center"===e.at[0]&&(q.left+=n/2),"bottom"===e.at[1]?q.top+=o:"center"===e.at[1]&&(q.top+=o/2),l=b(w.at,n,o),q.left+=l[0],q.top+=l[1],this.each(function(){var d,h,i=a(this),j=i.outerWidth(),k=i.outerHeight(),m=c(this,"marginLeft"),r=c(this,"marginTop"),x=j+m+c(this,"marginRight")+u.width,y=k+r+c(this,"marginBottom")+u.height,z=a.extend({},q),A=b(w.my,i.outerWidth(),i.outerHeight());"right"===e.my[0]?z.left-=j:"center"===e.my[0]&&(z.left-=j/2),"bottom"===e.my[1]?z.top-=k:"center"===e.my[1]&&(z.top-=k/2),z.left+=A[0],z.top+=A[1],d={marginLeft:m,marginTop:r},a.each(["left","top"],function(b,c){a.ui.position[v[b]]&&a.ui.position[v[b]][c](z,{targetWidth:n,targetHeight:o,elemWidth:j,elemHeight:k,collisionPosition:d,collisionWidth:x,collisionHeight:y,offset:[l[0]+A[0],l[1]+A[1]],my:e.my,at:e.at,within:t,elem:i})}),e.using&&(h=function(a){var b=p.left-z.left,c=b+n-j,d=p.top-z.top,h=d+o-k,l={target:{element:s,left:p.left,top:p.top,width:n,height:o},element:{element:i,left:z.left,top:z.top,width:j,height:k},horizontal:0>c?"left":b>0?"right":"center",vertical:0>h?"top":d>0?"bottom":"middle"};j>n&&n>g(b+c)&&(l.horizontal="center"),k>o&&o>g(d+h)&&(l.vertical="middle"),l.important=f(g(b),g(c))>f(g(d),g(h))?"horizontal":"vertical",e.using.call(this,a,l)}),i.offset(a.extend(z,{using:h}))})},a.ui.position={fit:{left:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollLeft:d.offset.left,g=d.width,h=a.left-b.collisionPosition.marginLeft,i=e-h,j=h+b.collisionWidth-g-e;b.collisionWidth>g?i>0&&0>=j?(c=a.left+i+b.collisionWidth-g-e,a.left+=i-c):a.left=j>0&&0>=i?e:i>j?e+g-b.collisionWidth:e:i>0?a.left+=i:j>0?a.left-=j:a.left=f(a.left-h,a.left)},top:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollTop:d.offset.top,g=b.within.height,h=a.top-b.collisionPosition.marginTop,i=e-h,j=h+b.collisionHeight-g-e;b.collisionHeight>g?i>0&&0>=j?(c=a.top+i+b.collisionHeight-g-e,a.top+=i-c):a.top=j>0&&0>=i?e:i>j?e+g-b.collisionHeight:e:i>0?a.top+=i:j>0?a.top-=j:a.top=f(a.top-h,a.top)}},flip:{left:function(a,b){var c,d,e=b.within,f=e.offset.left+e.scrollLeft,h=e.width,i=e.isWindow?e.scrollLeft:e.offset.left,j=a.left-b.collisionPosition.marginLeft,k=j-i,l=j+b.collisionWidth-h-i,m="left"===b.my[0]?-b.elemWidth:"right"===b.my[0]?b.elemWidth:0,n="left"===b.at[0]?b.targetWidth:"right"===b.at[0]?-b.targetWidth:0,o=-2*b.offset[0];0>k?(0>(c=a.left+m+n+o+b.collisionWidth-h-f)||g(k)>c)&&(a.left+=m+n+o):l>0&&((d=a.left-b.collisionPosition.marginLeft+m+n+o-i)>0||l>g(d))&&(a.left+=m+n+o)},top:function(a,b){var c,d,e=b.within,f=e.offset.top+e.scrollTop,h=e.height,i=e.isWindow?e.scrollTop:e.offset.top,j=a.top-b.collisionPosition.marginTop,k=j-i,l=j+b.collisionHeight-h-i,m="top"===b.my[1],n=m?-b.elemHeight:"bottom"===b.my[1]?b.elemHeight:0,o="top"===b.at[1]?b.targetHeight:"bottom"===b.at[1]?-b.targetHeight:0,p=-2*b.offset[1];0>k?(0>(d=a.top+n+o+p+b.collisionHeight-h-f)||g(k)>d)&&(a.top+=n+o+p):l>0&&((c=a.top-b.collisionPosition.marginTop+n+o+p-i)>0||l>g(c))&&(a.top+=n+o+p)}},flipfit:{left:function(){a.ui.position.flip.left.apply(this,arguments),a.ui.position.fit.left.apply(this,arguments)},top:function(){a.ui.position.flip.top.apply(this,arguments),a.ui.position.fit.top.apply(this,arguments)}}}}(),a.ui.position,a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])}}),a.fn.extend({disableSelection:function(){var a="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.on(a+".ui-disableSelection",function(a){a.preventDefault()})}}(),enableSelection:function(){return this.off(".ui-disableSelection")}}),a.ui.focusable=function(c,d){var e,f,g,h,i,j=c.nodeName.toLowerCase();return"area"===j?(e=c.parentNode,f=e.name,!(!c.href||!f||"map"!==e.nodeName.toLowerCase())&&(g=a("img[usemap='#"+f+"']"),g.length>0&&g.is(":visible"))):(/^(input|select|textarea|button|object)$/.test(j)?(h=!c.disabled)&&(i=a(c).closest("fieldset")[0])&&(h=!i.disabled):h="a"===j?c.href||d:d,h&&a(c).is(":visible")&&b(a(c)))},a.extend(a.expr[":"],{focusable:function(b){return a.ui.focusable(b,null!=a.attr(b,"tabindex"))}}),a.ui.focusable,a.fn.form=function(){return"string"==typeof this[0].form?this.closest("form"):a(this[0].form)},a.ui.formResetMixin={_formResetHandler:function(){var b=a(this);setTimeout(function(){var c=b.data("ui-form-reset-instances");a.each(c,function(){this.refresh()})})},_bindFormResetHandler:function(){if(this.form=this.element.form(),this.form.length){var a=this.form.data("ui-form-reset-instances")||[];a.length||this.form.on("reset.ui-form-reset",this._formResetHandler),a.push(this),this.form.data("ui-form-reset-instances",a)}},_unbindFormResetHandler:function(){if(this.form.length){var b=this.form.data("ui-form-reset-instances");b.splice(a.inArray(this,b),1),b.length?this.form.data("ui-form-reset-instances",b):this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset")}}},"1.7"===a.fn.jquery.substring(0,3)&&(a.each(["Width","Height"],function(b,c){function d(b,c,d,f){return a.each(e,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),f&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var e="Width"===c?["Left","Right"]:["Top","Bottom"],f=c.toLowerCase(),g={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+c]=function(b){return void 0===b?g["inner"+c].call(this):this.each(function(){a(this).css(f,d(this,b)+"px")})},a.fn["outer"+c]=function(b,e){return"number"!=typeof b?g["outer"+c].call(this,b):this.each(function(){a(this).css(f,d(this,b,!0,e)+"px")})}}),a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},a.ui.escapeSelector=function(){var a=/([!"#$%&'()*+,.\/:;<=>?@[\]^`{|}~])/g;return function(b){return b.replace(a,"\\$1")}}(),a.fn.labels=function(){var b,c,d,e,f;return this[0].labels&&this[0].labels.length?this.pushStack(this[0].labels):(e=this.eq(0).parents("label"),d=this.attr("id"),d&&(b=this.eq(0).parents().last(),f=b.add(b.length?b.siblings():this.siblings()),c="label[for='"+a.ui.escapeSelector(d)+"']",e=e.add(f.find(c).addBack(c))),this.pushStack(e))},a.fn.scrollParent=function(b){var c=this.css("position"),d="absolute"===c,e=b?/(auto|scroll|hidden)/:/(auto|scroll)/,f=this.parents().filter(function(){var b=a(this);return(!d||"static"!==b.css("position"))&&e.test(b.css("overflow")+b.css("overflow-y")+b.css("overflow-x"))}).eq(0);return"fixed"!==c&&f.length?f:a(this[0].ownerDocument||document)},a.extend(a.expr[":"],{tabbable:function(b){var c=a.attr(b,"tabindex"),d=null!=c;return(!d||c>=0)&&a.ui.focusable(b,d)}}),a.fn.extend({uniqueId:function(){var a=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++a)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&a(this).removeAttr("id")})}}),a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var e=!1;a(document).on("mouseup",function(){e=!1}),a.widget("ui.mouse",{version:"1.12.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.on("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).on("click."+this.widgetName,function(c){return!0===a.data(c.target,b.widgetName+".preventClickEvent")?(a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(b){if(!e){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(b),this._mouseDownEvent=b;var c=this,d=1===b.which,f=!("string"!=typeof this.options.cancel||!b.target.nodeName)&&a(b.target).closest(this.options.cancel).length;return!(d&&!f&&this._mouseCapture(b))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){c.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=!1!==this._mouseStart(b),!this._mouseStarted)?(b.preventDefault(),!0):(!0===a.data(b.target,this.widgetName+".preventClickEvent")&&a.removeData(b.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return c._mouseMove(a)},this._mouseUpDelegate=function(a){return c._mouseUp(a)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),b.preventDefault(),e=!0,!0))}},_mouseMove:function(b){if(this._mouseMoved){if(a.ui.ie&&(!document.documentMode||9>document.documentMode)&&!b.button)return this._mouseUp(b);if(!b.which)if(b.originalEvent.altKey||b.originalEvent.ctrlKey||b.originalEvent.metaKey||b.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(b)}return(b.which||b.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,b),this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted)},_mouseUp:function(b){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target===this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,e=!1,b.preventDefault()},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),a.ui.plugin={add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c,d){var e,f=a.plugins[b];if(f&&(d||a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType))for(e=0;f.length>e;e++)a.options[f[e][0]]&&f[e][1].apply(a.element,c)}},a.ui.safeActiveElement=function(a){var b;try{b=a.activeElement}catch(c){b=a.body}return b||(b=a.body),b.nodeName||(b=a.body),b},a.ui.safeBlur=function(b){b&&"body"!==b.nodeName.toLowerCase()&&a(b).trigger("blur")},a.widget("ui.draggable",a.ui.mouse,{version:"1.12.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this._addClass("ui-draggable"),this._setHandleClassName(),this._mouseInit()},_setOption:function(a,b){this._super(a,b),"handle"===a&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(b){var c=this.options;return!(this.helper||c.disabled||a(b.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(b),!!this.handle&&(this._blurActiveElement(b),this._blockFrames(!0===c.iframeFix?"iframe":c.iframeFix),!0))},_blockFrames:function(b){this.iframeBlocks=this.document.find(b).map(function(){var b=a(this);return a("<div>").css("position","absolute").appendTo(b.parent()).outerWidth(b.outerWidth()).outerHeight(b.outerHeight()).offset(b.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(b){var c=a.ui.safeActiveElement(this.document[0]);a(b.target).closest(c).length||a.ui.safeBlur(c)},_mouseStart:function(b){var c=this.options;return this.helper=this._createHelper(b),this._addClass(this.helper,"ui-draggable-dragging"),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===a(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(b),this.originalPosition=this.position=this._generatePosition(b,!1),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),this._setContainment(),!1===this._trigger("start",b)?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b),!0)},_refreshOffsets:function(a){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:a.pageX-this.offset.left,top:a.pageY-this.offset.top}},_mouseDrag:function(b,c){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(b,!0),this.positionAbs=this._convertPositionTo("absolute"),!c){var d=this._uiHash();if(!1===this._trigger("drag",b,d))return this._mouseUp(new a.Event("mouseup",b)),!1;this.position=d.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),!1},_mouseStop:function(b){var c=this,d=!1;return a.ui.ddmanager&&!this.options.dropBehaviour&&(d=a.ui.ddmanager.drop(this,b)),this.dropped&&(d=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!d||"valid"===this.options.revert&&d||!0===this.options.revert||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)?a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==c._trigger("stop",b)&&c._clear()}):!1!==this._trigger("stop",b)&&this._clear(),!1},_mouseUp:function(b){return this._unblockFrames(),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),this.handleElement.is(b.target)&&this.element.trigger("focus"),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp(new a.Event("mouseup",{target:this.element[0]})):this._clear(),this},_getHandle:function(b){return!this.options.handle||!!a(b.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper),e=d?a(c.helper.apply(this.element[0],[b])):"clone"===c.helper?this.element.clone().removeAttr("id"):this.element;return e.parents("body").length||e.appendTo("parent"===c.appendTo?this.element[0].parentNode:c.appendTo),d&&e[0]===this.element[0]&&this._setPositionRelative(),e[0]===this.element[0]||/(fixed|absolute)/.test(e.css("position"))||e.css("position","absolute"),e},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_isRootNode:function(a){return/(html|body)/i.test(a.tagName)||a===this.document[0]},_getParentOffset:function(){var b=this.offsetParent.offset(),c=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==c&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var a=this.element.position(),b=this._isRootNode(this.scrollParent[0]);return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+(b?0:this.scrollParent.scrollTop()),left:a.left-(parseInt(this.helper.css("left"),10)||0)+(b?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options,f=this.document[0];return this.relativeContainer=null,e.containment?"window"===e.containment?void(this.containment=[a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,a(window).scrollLeft()+a(window).width()-this.helperProportions.width-this.margins.left,a(window).scrollTop()+(a(window).height()||f.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===e.containment?void(this.containment=[0,0,a(f).width()-this.helperProportions.width-this.margins.left,(a(f).height()||f.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):e.containment.constructor===Array?void(this.containment=e.containment):("parent"===e.containment&&(e.containment=this.helper[0].parentNode),c=a(e.containment),void((d=c[0])&&(b=/(scroll|auto)/.test(c.css("overflow")),this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(b?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(b?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=c))):void(this.containment=null)},_convertPositionTo:function(a,b){b||(b=this.position);var c="absolute"===a?1:-1,d=this._isRootNode(this.scrollParent[0]);return{top:b.top+this.offset.relative.top*c+this.offset.parent.top*c-("fixed"===this.cssPosition?-this.offset.scroll.top:d?0:this.offset.scroll.top)*c,left:b.left+this.offset.relative.left*c+this.offset.parent.left*c-("fixed"===this.cssPosition?-this.offset.scroll.left:d?0:this.offset.scroll.left)*c}},_generatePosition:function(a,b){var c,d,e,f,g=this.options,h=this._isRootNode(this.scrollParent[0]),i=a.pageX,j=a.pageY;return h&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),b&&(this.containment&&(this.relativeContainer?(d=this.relativeContainer.offset(),c=[this.containment[0]+d.left,this.containment[1]+d.top,this.containment[2]+d.left,this.containment[3]+d.top]):c=this.containment,a.pageX-this.offset.click.left<c[0]&&(i=c[0]+this.offset.click.left),a.pageY-this.offset.click.top<c[1]&&(j=c[1]+this.offset.click.top),a.pageX-this.offset.click.left>c[2]&&(i=c[2]+this.offset.click.left),a.pageY-this.offset.click.top>c[3]&&(j=c[3]+this.offset.click.top)),g.grid&&(e=g.grid[1]?this.originalPageY+Math.round((j-this.originalPageY)/g.grid[1])*g.grid[1]:this.originalPageY,j=c?e-this.offset.click.top>=c[1]||e-this.offset.click.top>c[3]?e:e-this.offset.click.top>=c[1]?e-g.grid[1]:e+g.grid[1]:e,f=g.grid[0]?this.originalPageX+Math.round((i-this.originalPageX)/g.grid[0])*g.grid[0]:this.originalPageX,i=c?f-this.offset.click.left>=c[0]||f-this.offset.click.left>c[2]?f:f-this.offset.click.left>=c[0]?f-g.grid[0]:f+g.grid[0]:f),
"y"===g.axis&&(i=this.originalPageX),"x"===g.axis&&(j=this.originalPageY)),{top:j-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:h?0:this.offset.scroll.top),left:i-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:h?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(b,c,d){return d=d||this._uiHash(),a.ui.plugin.call(this,b,[c,d,this],!0),/^(drag|start|stop)/.test(b)&&(this.positionAbs=this._convertPositionTo("absolute"),d.offset=this.positionAbs),a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c,d){var e=a.extend({},c,{item:d.element});d.sortables=[],a(d.options.connectToSortable).each(function(){var c=a(this).sortable("instance");c&&!c.options.disabled&&(d.sortables.push(c),c.refreshPositions(),c._trigger("activate",b,e))})},stop:function(b,c,d){var e=a.extend({},c,{item:d.element});d.cancelHelperRemoval=!1,a.each(d.sortables,function(){var a=this;a.isOver?(a.isOver=0,d.cancelHelperRemoval=!0,a.cancelHelperRemoval=!1,a._storedCSS={position:a.placeholder.css("position"),top:a.placeholder.css("top"),left:a.placeholder.css("left")},a._mouseStop(b),a.options.helper=a.options._helper):(a.cancelHelperRemoval=!0,a._trigger("deactivate",b,e))})},drag:function(b,c,d){a.each(d.sortables,function(){var e=!1,f=this;f.positionAbs=d.positionAbs,f.helperProportions=d.helperProportions,f.offset.click=d.offset.click,f._intersectsWith(f.containerCache)&&(e=!0,a.each(d.sortables,function(){return this.positionAbs=d.positionAbs,this.helperProportions=d.helperProportions,this.offset.click=d.offset.click,this!==f&&this._intersectsWith(this.containerCache)&&a.contains(f.element[0],this.element[0])&&(e=!1),e})),e?(f.isOver||(f.isOver=1,d._parent=c.helper.parent(),f.currentItem=c.helper.appendTo(f.element).data("ui-sortable-item",!0),f.options._helper=f.options.helper,f.options.helper=function(){return c.helper[0]},b.target=f.currentItem[0],f._mouseCapture(b,!0),f._mouseStart(b,!0,!0),f.offset.click.top=d.offset.click.top,f.offset.click.left=d.offset.click.left,f.offset.parent.left-=d.offset.parent.left-f.offset.parent.left,f.offset.parent.top-=d.offset.parent.top-f.offset.parent.top,d._trigger("toSortable",b),d.dropped=f.element,a.each(d.sortables,function(){this.refreshPositions()}),d.currentItem=d.element,f.fromOutside=d),f.currentItem&&(f._mouseDrag(b),c.position=f.position)):f.isOver&&(f.isOver=0,f.cancelHelperRemoval=!0,f.options._revert=f.options.revert,f.options.revert=!1,f._trigger("out",b,f._uiHash(f)),f._mouseStop(b,!0),f.options.revert=f.options._revert,f.options.helper=f.options._helper,f.placeholder&&f.placeholder.remove(),c.helper.appendTo(d._parent),d._refreshOffsets(b),c.position=d._generatePosition(b,!0),d._trigger("fromSortable",b),d.dropped=!1,a.each(d.sortables,function(){this.refreshPositions()}))})}}),a.ui.plugin.add("draggable","cursor",{start:function(b,c,d){var e=a("body"),f=d.options;e.css("cursor")&&(f._cursor=e.css("cursor")),e.css("cursor",f.cursor)},stop:function(b,c,d){var e=d.options;e._cursor&&a("body").css("cursor",e._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(b,c,d){var e=a(c.helper),f=d.options;e.css("opacity")&&(f._opacity=e.css("opacity")),e.css("opacity",f.opacity)},stop:function(b,c,d){var e=d.options;e._opacity&&a(c.helper).css("opacity",e._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(a,b,c){c.scrollParentNotHidden||(c.scrollParentNotHidden=c.helper.scrollParent(!1)),c.scrollParentNotHidden[0]!==c.document[0]&&"HTML"!==c.scrollParentNotHidden[0].tagName&&(c.overflowOffset=c.scrollParentNotHidden.offset())},drag:function(b,c,d){var e=d.options,f=!1,g=d.scrollParentNotHidden[0],h=d.document[0];g!==h&&"HTML"!==g.tagName?(e.axis&&"x"===e.axis||(d.overflowOffset.top+g.offsetHeight-b.pageY<e.scrollSensitivity?g.scrollTop=f=g.scrollTop+e.scrollSpeed:b.pageY-d.overflowOffset.top<e.scrollSensitivity&&(g.scrollTop=f=g.scrollTop-e.scrollSpeed)),e.axis&&"y"===e.axis||(d.overflowOffset.left+g.offsetWidth-b.pageX<e.scrollSensitivity?g.scrollLeft=f=g.scrollLeft+e.scrollSpeed:b.pageX-d.overflowOffset.left<e.scrollSensitivity&&(g.scrollLeft=f=g.scrollLeft-e.scrollSpeed))):(e.axis&&"x"===e.axis||(b.pageY-a(h).scrollTop()<e.scrollSensitivity?f=a(h).scrollTop(a(h).scrollTop()-e.scrollSpeed):a(window).height()-(b.pageY-a(h).scrollTop())<e.scrollSensitivity&&(f=a(h).scrollTop(a(h).scrollTop()+e.scrollSpeed))),e.axis&&"y"===e.axis||(b.pageX-a(h).scrollLeft()<e.scrollSensitivity?f=a(h).scrollLeft(a(h).scrollLeft()-e.scrollSpeed):a(window).width()-(b.pageX-a(h).scrollLeft())<e.scrollSensitivity&&(f=a(h).scrollLeft(a(h).scrollLeft()+e.scrollSpeed)))),!1!==f&&a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(d,b)}}),a.ui.plugin.add("draggable","snap",{start:function(b,c,d){var e=d.options;d.snapElements=[],a(e.snap.constructor!==String?e.snap.items||":data(ui-draggable)":e.snap).each(function(){var b=a(this),c=b.offset();this!==d.element[0]&&d.snapElements.push({item:this,width:b.outerWidth(),height:b.outerHeight(),top:c.top,left:c.left})})},drag:function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o=d.options,p=o.snapTolerance,q=c.offset.left,r=q+d.helperProportions.width,s=c.offset.top,t=s+d.helperProportions.height;for(m=d.snapElements.length-1;m>=0;m--)i=d.snapElements[m].left-d.margins.left,j=i+d.snapElements[m].width,k=d.snapElements[m].top-d.margins.top,l=k+d.snapElements[m].height,i-p>r||q>j+p||k-p>t||s>l+p||!a.contains(d.snapElements[m].item.ownerDocument,d.snapElements[m].item)?(d.snapElements[m].snapping&&d.options.snap.release&&d.options.snap.release.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[m].item})),d.snapElements[m].snapping=!1):("inner"!==o.snapMode&&(e=p>=Math.abs(k-t),f=p>=Math.abs(l-s),g=p>=Math.abs(i-r),h=p>=Math.abs(j-q),e&&(c.position.top=d._convertPositionTo("relative",{top:k-d.helperProportions.height,left:0}).top),f&&(c.position.top=d._convertPositionTo("relative",{top:l,left:0}).top),g&&(c.position.left=d._convertPositionTo("relative",{top:0,left:i-d.helperProportions.width}).left),h&&(c.position.left=d._convertPositionTo("relative",{top:0,left:j}).left)),n=e||f||g||h,"outer"!==o.snapMode&&(e=p>=Math.abs(k-s),f=p>=Math.abs(l-t),g=p>=Math.abs(i-q),h=p>=Math.abs(j-r),e&&(c.position.top=d._convertPositionTo("relative",{top:k,left:0}).top),f&&(c.position.top=d._convertPositionTo("relative",{top:l-d.helperProportions.height,left:0}).top),g&&(c.position.left=d._convertPositionTo("relative",{top:0,left:i}).left),h&&(c.position.left=d._convertPositionTo("relative",{top:0,left:j-d.helperProportions.width}).left)),!d.snapElements[m].snapping&&(e||f||g||h||n)&&d.options.snap.snap&&d.options.snap.snap.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[m].item})),d.snapElements[m].snapping=e||f||g||h||n)}}),a.ui.plugin.add("draggable","stack",{start:function(b,c,d){var e,f=d.options,g=a.makeArray(a(f.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});g.length&&(e=parseInt(a(g[0]).css("zIndex"),10)||0,a(g).each(function(b){a(this).css("zIndex",e+b)}),this.css("zIndex",e+g.length))}}),a.ui.plugin.add("draggable","zIndex",{start:function(b,c,d){var e=a(c.helper),f=d.options;e.css("zIndex")&&(f._zIndex=e.css("zIndex")),e.css("zIndex",f.zIndex)},stop:function(b,c,d){var e=d.options;e._zIndex&&a(c.helper).css("zIndex",e._zIndex)}}),a.ui.draggable,a.widget("ui.droppable",{version:"1.12.1",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var b,c=this.options,d=c.accept;this.isover=!1,this.isout=!0,this.accept=a.isFunction(d)?d:function(a){return a.is(d)},this.proportions=function(){return arguments.length?void(b=arguments[0]):b||(b={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight})},this._addToManager(c.scope),c.addClasses&&this._addClass("ui-droppable")},_addToManager:function(b){a.ui.ddmanager.droppables[b]=a.ui.ddmanager.droppables[b]||[],a.ui.ddmanager.droppables[b].push(this)},_splice:function(a){for(var b=0;a.length>b;b++)a[b]===this&&a.splice(b,1)},_destroy:function(){var b=a.ui.ddmanager.droppables[this.options.scope];this._splice(b)},_setOption:function(b,c){if("accept"===b)this.accept=a.isFunction(c)?c:function(a){return a.is(c)};else if("scope"===b){var d=a.ui.ddmanager.droppables[this.options.scope];this._splice(d),this._addToManager(c)}this._super(b,c)},_activate:function(b){var c=a.ui.ddmanager.current;this._addActiveClass(),c&&this._trigger("activate",b,this.ui(c))},_deactivate:function(b){var c=a.ui.ddmanager.current;this._removeActiveClass(),c&&this._trigger("deactivate",b,this.ui(c))},_over:function(b){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!==this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this._addHoverClass(),this._trigger("over",b,this.ui(c)))},_out:function(b){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!==this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this._removeHoverClass(),this._trigger("out",b,this.ui(c)))},_drop:function(b,c){var d=c||a.ui.ddmanager.current,e=!1;return!(!d||(d.currentItem||d.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var c=a(this).droppable("instance");return c.options.greedy&&!c.options.disabled&&c.options.scope===d.options.scope&&c.accept.call(c.element[0],d.currentItem||d.element)&&f(d,a.extend(c,{offset:c.element.offset()}),c.options.tolerance,b)?(e=!0,!1):void 0}),!e&&(!!this.accept.call(this.element[0],d.currentItem||d.element)&&(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",b,this.ui(d)),this.element)))},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}});var f=a.ui.intersect=function(){function a(a,b,c){return a>=b&&b+c>a}return function(b,c,d,e){if(!c.offset)return!1;var f=(b.positionAbs||b.position.absolute).left+b.margins.left,g=(b.positionAbs||b.position.absolute).top+b.margins.top,h=f+b.helperProportions.width,i=g+b.helperProportions.height,j=c.offset.left,k=c.offset.top,l=j+c.proportions().width,m=k+c.proportions().height;switch(d){case"fit":return f>=j&&l>=h&&g>=k&&m>=i;case"intersect":return f+b.helperProportions.width/2>j&&l>h-b.helperProportions.width/2&&g+b.helperProportions.height/2>k&&m>i-b.helperProportions.height/2;case"pointer":return a(e.pageY,k,c.proportions().height)&&a(e.pageX,j,c.proportions().width);case"touch":return(g>=k&&m>=g||i>=k&&m>=i||k>g&&i>m)&&(f>=j&&l>=f||h>=j&&l>=h||j>f&&h>l);default:return!1}}}();a.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(b,c){var d,e,f=a.ui.ddmanager.droppables[b.options.scope]||[],g=c?c.type:null,h=(b.currentItem||b.element).find(":data(ui-droppable)").addBack();a:for(d=0;f.length>d;d++)if(!(f[d].options.disabled||b&&!f[d].accept.call(f[d].element[0],b.currentItem||b.element))){for(e=0;h.length>e;e++)if(h[e]===f[d].element[0]){f[d].proportions().height=0;continue a}f[d].visible="none"!==f[d].element.css("display"),f[d].visible&&("mousedown"===g&&f[d]._activate.call(f[d],c),f[d].offset=f[d].element.offset(),f[d].proportions({width:f[d].element[0].offsetWidth,height:f[d].element[0].offsetHeight}))}},drop:function(b,c){var d=!1;return a.each((a.ui.ddmanager.droppables[b.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&f(b,this,this.options.tolerance,c)&&(d=this._drop.call(this,c)||d),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,c)))}),d},dragStart:function(b,c){b.element.parentsUntil("body").on("scroll.droppable",function(){b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)})},drag:function(b,c){b.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(b,c),a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var d,e,g,h=f(b,this,this.options.tolerance,c),i=!h&&this.isover?"isout":h&&!this.isover?"isover":null;i&&(this.options.greedy&&(e=this.options.scope,g=this.element.parents(":data(ui-droppable)").filter(function(){return a(this).droppable("instance").options.scope===e}),g.length&&(d=a(g[0]).droppable("instance"),d.greedyChild="isover"===i)),d&&"isover"===i&&(d.isover=!1,d.isout=!0,d._out.call(d,c)),this[i]=!0,this["isout"===i?"isover":"isout"]=!1,this["isover"===i?"_over":"_out"].call(this,c),d&&"isout"===i&&(d.isout=!1,d.isover=!0,d._over.call(d,c)))}})},dragStop:function(b,c){b.element.parentsUntil("body").off("scroll.droppable"),b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)}},!1!==a.uiBackCompat&&a.widget("ui.droppable",a.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}}),a.ui.droppable,a.widget("ui.resizable",a.ui.mouse,{version:"1.12.1",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(a){return parseFloat(a)||0},_isNumber:function(a){return!isNaN(parseFloat(a))},_hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",e=!1;return b[d]>0||(b[d]=1,e=b[d]>0,b[d]=0,e)},_create:function(){var b,c=this.options,d=this;this._addClass("ui-resizable"),a.extend(this,{_aspectRatio:!!c.aspectRatio,aspectRatio:c.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:c.helper||c.ghost||c.animate?c.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(a("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,b={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")},this.element.css(b),this.originalElement.css("margin",0),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css(b),this._proportionallyResize()),this._setupHandles(),c.autoHide&&a(this.element).on("mouseenter",function(){c.disabled||(d._removeClass("ui-resizable-autohide"),d._handles.show())}).on("mouseleave",function(){c.disabled||d.resizing||(d._addClass("ui-resizable-autohide"),d._handles.hide())}),this._mouseInit()},_destroy:function(){this._mouseDestroy();var b,c=function(b){a(b).removeData("resizable").removeData("ui-resizable").off(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(c(this.element),b=this.element,this.originalElement.css({position:b.css("position"),width:b.outerWidth(),height:b.outerHeight(),top:b.css("top"),left:b.css("left")}).insertAfter(b),b.remove()),this.originalElement.css("resize",this.originalResizeStyle),c(this.originalElement),this},_setOption:function(a,b){switch(this._super(a,b),a){case"handles":this._removeHandles(),this._setupHandles()}},_setupHandles:function(){var b,c,d,e,f,g=this.options,h=this;if(this.handles=g.handles||(a(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=a(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),d=this.handles.split(","),this.handles={},c=0;d.length>c;c++)b=a.trim(d[c]),e="ui-resizable-"+b,f=a("<div>"),this._addClass(f,"ui-resizable-handle "+e),f.css({zIndex:g.zIndex}),this.handles[b]=".ui-resizable-"+b,this.element.append(f);this._renderAxis=function(b){var c,d,e,f;b=b||this.element;for(c in this.handles)this.handles[c].constructor===String?this.handles[c]=this.element.children(this.handles[c]).first().show():(this.handles[c].jquery||this.handles[c].nodeType)&&(this.handles[c]=a(this.handles[c]),this._on(this.handles[c],{mousedown:h._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(d=a(this.handles[c],this.element),f=/sw|ne|nw|se|n|s/.test(c)?d.outerHeight():d.outerWidth(),e=["padding",/ne|nw|n/.test(c)?"Top":/se|sw|s/.test(c)?"Bottom":/^e$/.test(c)?"Right":"Left"].join(""),b.css(e,f),this._proportionallyResize()),this._handles=this._handles.add(this.handles[c])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.on("mouseover",function(){h.resizing||(this.className&&(f=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),h.axis=f&&f[1]?f[1]:"se")}),g.autoHide&&(this._handles.hide(),this._addClass("ui-resizable-autohide"))},_removeHandles:function(){this._handles.remove()},_mouseCapture:function(b){var c,d,e=!1;for(c in this.handles)((d=a(this.handles[c])[0])===b.target||a.contains(d,b.target))&&(e=!0);return!this.options.disabled&&e},_mouseStart:function(b){var c,d,e,f=this.options,g=this.element;return this.resizing=!0,this._renderProxy(),c=this._num(this.helper.css("left")),d=this._num(this.helper.css("top")),f.containment&&(c+=a(f.containment).scrollLeft()||0,d+=a(f.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:c,top:d},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:g.width(),height:g.height()},this.originalSize=this._helper?{width:g.outerWidth(),height:g.outerHeight()}:{width:g.width(),height:g.height()},this.sizeDiff={width:g.outerWidth()-g.width(),height:g.outerHeight()-g.height()},this.originalPosition={left:c,top:d},this.originalMousePosition={left:b.pageX,top:b.pageY},this.aspectRatio="number"==typeof f.aspectRatio?f.aspectRatio:this.originalSize.width/this.originalSize.height||1,e=a(".ui-resizable-"+this.axis).css("cursor"),a("body").css("cursor","auto"===e?this.axis+"-resize":e),this._addClass("ui-resizable-resizing"),this._propagate("start",b),!0},_mouseDrag:function(b){var c,d,e=this.originalMousePosition,f=this.axis,g=b.pageX-e.left||0,h=b.pageY-e.top||0,i=this._change[f];return this._updatePrevProperties(),!!i&&(c=i.apply(this,[b,g,h]),this._updateVirtualBoundaries(b.shiftKey),(this._aspectRatio||b.shiftKey)&&(c=this._updateRatio(c,b)),c=this._respectSize(c,b),this._updateCache(c),this._propagate("resize",b),d=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),a.isEmptyObject(d)||(this._updatePrevProperties(),this._trigger("resize",b,this.ui()),this._applyChanges()),!1)},_mouseStop:function(b){this.resizing=!1;var c,d,e,f,g,h,i,j=this.options,k=this;return this._helper&&(c=this._proportionallyResizeElements,d=c.length&&/textarea/i.test(c[0].nodeName),e=d&&this._hasScroll(c[0],"left")?0:k.sizeDiff.height,f=d?0:k.sizeDiff.width,g={width:k.helper.width()-f,height:k.helper.height()-e},h=parseFloat(k.element.css("left"))+(k.position.left-k.originalPosition.left)||null,i=parseFloat(k.element.css("top"))+(k.position.top-k.originalPosition.top)||null,j.animate||this.element.css(a.extend(g,{top:i,left:h})),k.helper.height(k.size.height),k.helper.width(k.size.width),this._helper&&!j.animate&&this._proportionallyResize()),a("body").css("cursor","auto"),this._removeClass("ui-resizable-resizing"),this._propagate("stop",b),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var a={};return this.position.top!==this.prevPosition.top&&(a.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(a.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(a.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(a.height=this.size.height+"px"),this.helper.css(a),a},_updateVirtualBoundaries:function(a){var b,c,d,e,f,g=this.options;f={minWidth:this._isNumber(g.minWidth)?g.minWidth:0,maxWidth:this._isNumber(g.maxWidth)?g.maxWidth:1/0,minHeight:this._isNumber(g.minHeight)?g.minHeight:0,maxHeight:this._isNumber(g.maxHeight)?g.maxHeight:1/0},(this._aspectRatio||a)&&(b=f.minHeight*this.aspectRatio,d=f.minWidth/this.aspectRatio,c=f.maxHeight*this.aspectRatio,e=f.maxWidth/this.aspectRatio,b>f.minWidth&&(f.minWidth=b),d>f.minHeight&&(f.minHeight=d),f.maxWidth>c&&(f.maxWidth=c),f.maxHeight>e&&(f.maxHeight=e)),this._vBoundaries=f},_updateCache:function(a){this.offset=this.helper.offset(),this._isNumber(a.left)&&(this.position.left=a.left),this._isNumber(a.top)&&(this.position.top=a.top),this._isNumber(a.height)&&(this.size.height=a.height),this._isNumber(a.width)&&(this.size.width=a.width)},_updateRatio:function(a){var b=this.position,c=this.size,d=this.axis;return this._isNumber(a.height)?a.width=a.height*this.aspectRatio:this._isNumber(a.width)&&(a.height=a.width/this.aspectRatio),"sw"===d&&(a.left=b.left+(c.width-a.width),a.top=null),"nw"===d&&(a.top=b.top+(c.height-a.height),a.left=b.left+(c.width-a.width)),a},_respectSize:function(a){var b=this._vBoundaries,c=this.axis,d=this._isNumber(a.width)&&b.maxWidth&&b.maxWidth<a.width,e=this._isNumber(a.height)&&b.maxHeight&&b.maxHeight<a.height,f=this._isNumber(a.width)&&b.minWidth&&b.minWidth>a.width,g=this._isNumber(a.height)&&b.minHeight&&b.minHeight>a.height,h=this.originalPosition.left+this.originalSize.width,i=this.originalPosition.top+this.originalSize.height,j=/sw|nw|w/.test(c),k=/nw|ne|n/.test(c);return f&&(a.width=b.minWidth),g&&(a.height=b.minHeight),d&&(a.width=b.maxWidth),e&&(a.height=b.maxHeight),f&&j&&(a.left=h-b.minWidth),d&&j&&(a.left=h-b.maxWidth),g&&k&&(a.top=i-b.minHeight),e&&k&&(a.top=i-b.maxHeight),a.width||a.height||a.left||!a.top?a.width||a.height||a.top||!a.left||(a.left=null):a.top=null,a},_getPaddingPlusBorderDimensions:function(a){for(var b=0,c=[],d=[a.css("borderTopWidth"),a.css("borderRightWidth"),a.css("borderBottomWidth"),a.css("borderLeftWidth")],e=[a.css("paddingTop"),a.css("paddingRight"),a.css("paddingBottom"),a.css("paddingLeft")];4>b;b++)c[b]=parseFloat(d[b])||0,c[b]+=parseFloat(e[b])||0;return{height:c[0]+c[2],width:c[1]+c[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var a,b=0,c=this.helper||this.element;this._proportionallyResizeElements.length>b;b++)a=this._proportionallyResizeElements[b],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(a)),a.css({height:c.height()-this.outerDimensions.height||0,width:c.width()-this.outerDimensions.width||0})},_renderProxy:function(){var b=this.element,c=this.options;this.elementOffset=b.offset(),this._helper?(this.helper=this.helper||a("<div style='overflow:hidden;'></div>"),this._addClass(this.helper,this._helper),this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++c.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(a,b){return{width:this.originalSize.width+b}},w:function(a,b){var c=this.originalSize;return{left:this.originalPosition.left+b,width:c.width-b}},n:function(a,b,c){var d=this.originalSize;return{top:this.originalPosition.top+c,height:d.height-c}},s:function(a,b,c){return{height:this.originalSize.height+c}},se:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},sw:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[b,c,d]))},ne:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},nw:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[b,c,d]))}},_propagate:function(b,c){a.ui.plugin.call(this,b,[c,this.ui()]),"resize"!==b&&this._trigger(b,c,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),a.ui.plugin.add("resizable","animate",{stop:function(b){var c=a(this).resizable("instance"),d=c.options,e=c._proportionallyResizeElements,f=e.length&&/textarea/i.test(e[0].nodeName),g=f&&c._hasScroll(e[0],"left")?0:c.sizeDiff.height,h=f?0:c.sizeDiff.width,i={width:c.size.width-h,height:c.size.height-g},j=parseFloat(c.element.css("left"))+(c.position.left-c.originalPosition.left)||null,k=parseFloat(c.element.css("top"))+(c.position.top-c.originalPosition.top)||null;c.element.animate(a.extend(i,k&&j?{top:k,left:j}:{}),{duration:d.animateDuration,easing:d.animateEasing,step:function(){var d={width:parseFloat(c.element.css("width")),height:parseFloat(c.element.css("height")),top:parseFloat(c.element.css("top")),left:parseFloat(c.element.css("left"))};e&&e.length&&a(e[0]).css({width:d.width,height:d.height}),c._updateCache(d),c._propagate("resize",b)}})}}),a.ui.plugin.add("resizable","containment",{start:function(){var b,c,d,e,f,g,h,i=a(this).resizable("instance"),j=i.options,k=i.element,l=j.containment,m=l instanceof a?l.get(0):/parent/.test(l)?k.parent().get(0):l;m&&(i.containerElement=a(m),/document/.test(l)||l===document?(i.containerOffset={left:0,top:0},i.containerPosition={left:0,top:0},i.parentData={element:a(document),left:0,top:0,width:a(document).width(),height:a(document).height()||document.body.parentNode.scrollHeight}):(b=a(m),c=[],a(["Top","Right","Left","Bottom"]).each(function(a,d){c[a]=i._num(b.css("padding"+d))}),i.containerOffset=b.offset(),i.containerPosition=b.position(),i.containerSize={height:b.innerHeight()-c[3],width:b.innerWidth()-c[1]},d=i.containerOffset,e=i.containerSize.height,f=i.containerSize.width,g=i._hasScroll(m,"left")?m.scrollWidth:f,h=i._hasScroll(m)?m.scrollHeight:e,i.parentData={element:m,left:d.left,top:d.top,width:g,height:h}))},resize:function(b){var c,d,e,f,g=a(this).resizable("instance"),h=g.options,i=g.containerOffset,j=g.position,k=g._aspectRatio||b.shiftKey,l={top:0,left:0},m=g.containerElement,n=!0;m[0]!==document&&/static/.test(m.css("position"))&&(l=i),j.left<(g._helper?i.left:0)&&(g.size.width=g.size.width+(g._helper?g.position.left-i.left:g.position.left-l.left),k&&(g.size.height=g.size.width/g.aspectRatio,n=!1),g.position.left=h.helper?i.left:0),j.top<(g._helper?i.top:0)&&(g.size.height=g.size.height+(g._helper?g.position.top-i.top:g.position.top),k&&(g.size.width=g.size.height*g.aspectRatio,n=!1),g.position.top=g._helper?i.top:0),e=g.containerElement.get(0)===g.element.parent().get(0),f=/relative|absolute/.test(g.containerElement.css("position")),e&&f?(g.offset.left=g.parentData.left+g.position.left,g.offset.top=g.parentData.top+g.position.top):(g.offset.left=g.element.offset().left,g.offset.top=g.element.offset().top),c=Math.abs(g.sizeDiff.width+(g._helper?g.offset.left-l.left:g.offset.left-i.left)),d=Math.abs(g.sizeDiff.height+(g._helper?g.offset.top-l.top:g.offset.top-i.top)),c+g.size.width>=g.parentData.width&&(g.size.width=g.parentData.width-c,k&&(g.size.height=g.size.width/g.aspectRatio,n=!1)),d+g.size.height>=g.parentData.height&&(g.size.height=g.parentData.height-d,k&&(g.size.width=g.size.height*g.aspectRatio,n=!1)),n||(g.position.left=g.prevPosition.left,g.position.top=g.prevPosition.top,g.size.width=g.prevSize.width,g.size.height=g.prevSize.height)},stop:function(){var b=a(this).resizable("instance"),c=b.options,d=b.containerOffset,e=b.containerPosition,f=b.containerElement,g=a(b.helper),h=g.offset(),i=g.outerWidth()-b.sizeDiff.width,j=g.outerHeight()-b.sizeDiff.height;b._helper&&!c.animate&&/relative/.test(f.css("position"))&&a(this).css({left:h.left-e.left-d.left,width:i,height:j}),b._helper&&!c.animate&&/static/.test(f.css("position"))&&a(this).css({left:h.left-e.left-d.left,width:i,height:j})}}),a.ui.plugin.add("resizable","alsoResize",{start:function(){var b=a(this).resizable("instance"),c=b.options;a(c.alsoResize).each(function(){var b=a(this);b.data("ui-resizable-alsoresize",{width:parseFloat(b.width()),height:parseFloat(b.height()),left:parseFloat(b.css("left")),top:parseFloat(b.css("top"))})})},resize:function(b,c){var d=a(this).resizable("instance"),e=d.options,f=d.originalSize,g=d.originalPosition,h={height:d.size.height-f.height||0,width:d.size.width-f.width||0,top:d.position.top-g.top||0,left:d.position.left-g.left||0};a(e.alsoResize).each(function(){var b=a(this),d=a(this).data("ui-resizable-alsoresize"),e={},f=b.parents(c.originalElement[0]).length?["width","height"]:["width","height","top","left"];a.each(f,function(a,b){var c=(d[b]||0)+(h[b]||0);c&&c>=0&&(e[b]=c||null)}),b.css(e)})},stop:function(){a(this).removeData("ui-resizable-alsoresize")}}),a.ui.plugin.add("resizable","ghost",{start:function(){var b=a(this).resizable("instance"),c=b.size;b.ghost=b.originalElement.clone(),b.ghost.css({opacity:.25,display:"block",position:"relative",height:c.height,width:c.width,margin:0,left:0,top:0}),b._addClass(b.ghost,"ui-resizable-ghost"),!1!==a.uiBackCompat&&"string"==typeof b.options.ghost&&b.ghost.addClass(this.options.ghost),b.ghost.appendTo(b.helper)},resize:function(){var b=a(this).resizable("instance");b.ghost&&b.ghost.css({position:"relative",height:b.size.height,width:b.size.width})},stop:function(){var b=a(this).resizable("instance");b.ghost&&b.helper&&b.helper.get(0).removeChild(b.ghost.get(0))}}),a.ui.plugin.add("resizable","grid",{resize:function(){var b,c=a(this).resizable("instance"),d=c.options,e=c.size,f=c.originalSize,g=c.originalPosition,h=c.axis,i="number"==typeof d.grid?[d.grid,d.grid]:d.grid,j=i[0]||1,k=i[1]||1,l=Math.round((e.width-f.width)/j)*j,m=Math.round((e.height-f.height)/k)*k,n=f.width+l,o=f.height+m,p=d.maxWidth&&n>d.maxWidth,q=d.maxHeight&&o>d.maxHeight,r=d.minWidth&&d.minWidth>n,s=d.minHeight&&d.minHeight>o;d.grid=i,r&&(n+=j),s&&(o+=k),p&&(n-=j),q&&(o-=k),/^(se|s|e)$/.test(h)?(c.size.width=n,
c.size.height=o):/^(ne)$/.test(h)?(c.size.width=n,c.size.height=o,c.position.top=g.top-m):/^(sw)$/.test(h)?(c.size.width=n,c.size.height=o,c.position.left=g.left-l):((0>=o-k||0>=n-j)&&(b=c._getPaddingPlusBorderDimensions(this)),o-k>0?(c.size.height=o,c.position.top=g.top-m):(o=k-b.height,c.size.height=o,c.position.top=g.top+f.height-o),n-j>0?(c.size.width=n,c.position.left=g.left-l):(n=j-b.width,c.size.width=n,c.position.left=g.left+f.width-n))}}),a.ui.resizable,a.widget("ui.selectable",a.ui.mouse,{version:"1.12.1",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var b=this;this._addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){b.elementPos=a(b.element[0]).offset(),b.selectees=a(b.options.filter,b.element[0]),b._addClass(b.selectees,"ui-selectee"),b.selectees.each(function(){var c=a(this),d=c.offset(),e={left:d.left-b.elementPos.left,top:d.top-b.elementPos.top};a.data(this,"selectable-item",{element:this,$element:c,left:e.left,top:e.top,right:e.left+c.outerWidth(),bottom:e.top+c.outerHeight(),startselected:!1,selected:c.hasClass("ui-selected"),selecting:c.hasClass("ui-selecting"),unselecting:c.hasClass("ui-unselecting")})})},this.refresh(),this._mouseInit(),this.helper=a("<div>"),this._addClass(this.helper,"ui-selectable-helper")},_destroy:function(){this.selectees.removeData("selectable-item"),this._mouseDestroy()},_mouseStart:function(b){var c=this,d=this.options;this.opos=[b.pageX,b.pageY],this.elementPos=a(this.element[0]).offset(),this.options.disabled||(this.selectees=a(d.filter,this.element[0]),this._trigger("start",b),a(d.appendTo).append(this.helper),this.helper.css({left:b.pageX,top:b.pageY,width:0,height:0}),d.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var d=a.data(this,"selectable-item");d.startselected=!0,b.metaKey||b.ctrlKey||(c._removeClass(d.$element,"ui-selected"),d.selected=!1,c._addClass(d.$element,"ui-unselecting"),d.unselecting=!0,c._trigger("unselecting",b,{unselecting:d.element}))}),a(b.target).parents().addBack().each(function(){var d,e=a.data(this,"selectable-item");return e?(d=!b.metaKey&&!b.ctrlKey||!e.$element.hasClass("ui-selected"),c._removeClass(e.$element,d?"ui-unselecting":"ui-selected")._addClass(e.$element,d?"ui-selecting":"ui-unselecting"),e.unselecting=!d,e.selecting=d,e.selected=d,d?c._trigger("selecting",b,{selecting:e.element}):c._trigger("unselecting",b,{unselecting:e.element}),!1):void 0}))},_mouseDrag:function(b){if(this.dragged=!0,!this.options.disabled){var c,d=this,e=this.options,f=this.opos[0],g=this.opos[1],h=b.pageX,i=b.pageY;return f>h&&(c=h,h=f,f=c),g>i&&(c=i,i=g,g=c),this.helper.css({left:f,top:g,width:h-f,height:i-g}),this.selectees.each(function(){var c=a.data(this,"selectable-item"),j=!1,k={};c&&c.element!==d.element[0]&&(k.left=c.left+d.elementPos.left,k.right=c.right+d.elementPos.left,k.top=c.top+d.elementPos.top,k.bottom=c.bottom+d.elementPos.top,"touch"===e.tolerance?j=!(k.left>h||f>k.right||k.top>i||g>k.bottom):"fit"===e.tolerance&&(j=k.left>f&&h>k.right&&k.top>g&&i>k.bottom),j?(c.selected&&(d._removeClass(c.$element,"ui-selected"),c.selected=!1),c.unselecting&&(d._removeClass(c.$element,"ui-unselecting"),c.unselecting=!1),c.selecting||(d._addClass(c.$element,"ui-selecting"),c.selecting=!0,d._trigger("selecting",b,{selecting:c.element}))):(c.selecting&&((b.metaKey||b.ctrlKey)&&c.startselected?(d._removeClass(c.$element,"ui-selecting"),c.selecting=!1,d._addClass(c.$element,"ui-selected"),c.selected=!0):(d._removeClass(c.$element,"ui-selecting"),c.selecting=!1,c.startselected&&(d._addClass(c.$element,"ui-unselecting"),c.unselecting=!0),d._trigger("unselecting",b,{unselecting:c.element}))),c.selected&&(b.metaKey||b.ctrlKey||c.startselected||(d._removeClass(c.$element,"ui-selected"),c.selected=!1,d._addClass(c.$element,"ui-unselecting"),c.unselecting=!0,d._trigger("unselecting",b,{unselecting:c.element})))))}),!1}},_mouseStop:function(b){var c=this;return this.dragged=!1,a(".ui-unselecting",this.element[0]).each(function(){var d=a.data(this,"selectable-item");c._removeClass(d.$element,"ui-unselecting"),d.unselecting=!1,d.startselected=!1,c._trigger("unselected",b,{unselected:d.element})}),a(".ui-selecting",this.element[0]).each(function(){var d=a.data(this,"selectable-item");c._removeClass(d.$element,"ui-selecting")._addClass(d.$element,"ui-selected"),d.selecting=!1,d.selected=!0,d.startselected=!0,c._trigger("selected",b,{selected:d.element})}),this._trigger("stop",b),this.helper.remove(),!1}}),a.widget("ui.sortable",a.ui.mouse,{version:"1.12.1",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(a,b,c){return a>=b&&b+c>a},_isFloating:function(a){return/left|right/.test(a.css("float"))||/inline|table-cell/.test(a.css("display"))},_create:function(){this.containerCache={},this._addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(a,b){this._super(a,b),"handle"===a&&this._setHandleClassName()},_setHandleClassName:function(){var b=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle"),a.each(this.items,function(){b._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")})},_destroy:function(){this._mouseDestroy();for(var a=this.items.length-1;a>=0;a--)this.items[a].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(b,c){var d=null,e=!1,f=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(b),a(b.target).parents().each(function(){return a.data(this,f.widgetName+"-item")===f?(d=a(this),!1):void 0}),a.data(b.target,f.widgetName+"-item")===f&&(d=a(b.target)),!!d&&(!(this.options.handle&&!c&&(a(this.options.handle,d).find("*").addBack().each(function(){this===b.target&&(e=!0)}),!e))&&(this.currentItem=d,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(b,c,d){var e,f,g=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(b),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,g.cursorAt&&this._adjustOffsetFromHelper(g.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),g.containment&&this._setContainment(),g.cursor&&"auto"!==g.cursor&&(f=this.document.find("body"),this.storedCursor=f.css("cursor"),f.css("cursor",g.cursor),this.storedStylesheet=a("<style>*{ cursor: "+g.cursor+" !important; }</style>").appendTo(f)),g.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",g.opacity)),g.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",g.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",b,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!d)for(e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("activate",b,this._uiHash(this));return a.ui.ddmanager&&(a.ui.ddmanager.current=this),a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.dragging=!0,this._addClass(this.helper,"ui-sortable-helper"),this._mouseDrag(b),!0},_mouseDrag:function(b){var c,d,e,f,g=this.options,h=!1;for(this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<g.scrollSensitivity?this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop+g.scrollSpeed:b.pageY-this.overflowOffset.top<g.scrollSensitivity&&(this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop-g.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<g.scrollSensitivity?this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft+g.scrollSpeed:b.pageX-this.overflowOffset.left<g.scrollSensitivity&&(this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft-g.scrollSpeed)):(b.pageY-this.document.scrollTop()<g.scrollSensitivity?h=this.document.scrollTop(this.document.scrollTop()-g.scrollSpeed):this.window.height()-(b.pageY-this.document.scrollTop())<g.scrollSensitivity&&(h=this.document.scrollTop(this.document.scrollTop()+g.scrollSpeed)),b.pageX-this.document.scrollLeft()<g.scrollSensitivity?h=this.document.scrollLeft(this.document.scrollLeft()-g.scrollSpeed):this.window.width()-(b.pageX-this.document.scrollLeft())<g.scrollSensitivity&&(h=this.document.scrollLeft(this.document.scrollLeft()+g.scrollSpeed))),!1!==h&&a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),c=this.items.length-1;c>=0;c--)if(d=this.items[c],e=d.item[0],(f=this._intersectsWithPointer(d))&&d.instance===this.currentContainer&&e!==this.currentItem[0]&&this.placeholder[1===f?"next":"prev"]()[0]!==e&&!a.contains(this.placeholder[0],e)&&("semi-dynamic"!==this.options.type||!a.contains(this.element[0],e))){if(this.direction=1===f?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(d))break;this._rearrange(b,d),this._trigger("change",b,this._uiHash());break}return this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(b,c){if(b){if(a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b),this.options.revert){var d=this,e=this.placeholder.offset(),f=this.options.axis,g={};f&&"x"!==f||(g.left=e.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),f&&"y"!==f||(g.top=e.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,a(this.helper).animate(g,parseInt(this.options.revert,10)||500,function(){d._clear(b)})}else this._clear(b,c);return!1}},cancel:function(){if(this.dragging){this._mouseUp(new a.Event("mouseup",{target:null})),"original"===this.options.helper?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")):this.currentItem.show();for(var b=this.containers.length-1;b>=0;b--)this.containers[b]._trigger("deactivate",null,this._uiHash(this)),this.containers[b].containerCache.over&&(this.containers[b]._trigger("out",null,this._uiHash(this)),this.containers[b].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},a(c).each(function(){var c=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[\-=_](.+)/);c&&d.push((b.key||c[1]+"[]")+"="+(b.key&&b.expression?c[1]:c[2]))}),!d.length&&b.key&&d.push(b.key+"="),d.join("&")},toArray:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},c.each(function(){d.push(a(b.item||this).attr(b.attribute||"id")||"")}),d},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,d=this.positionAbs.top,e=d+this.helperProportions.height,f=a.left,g=f+a.width,h=a.top,i=h+a.height,j=this.offset.click.top,k=this.offset.click.left,l="x"===this.options.axis||d+j>h&&i>d+j,m="y"===this.options.axis||b+k>f&&g>b+k,n=l&&m;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?n:b+this.helperProportions.width/2>f&&g>c-this.helperProportions.width/2&&d+this.helperProportions.height/2>h&&i>e-this.helperProportions.height/2},_intersectsWithPointer:function(a){var b,c,d="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,a.top,a.height),e="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,a.left,a.width);return!(!d||!e)&&(b=this._getDragVerticalDirection(),c=this._getDragHorizontalDirection(),this.floating?"right"===c||"down"===b?2:1:b&&("down"===b?2:1))},_intersectsWithSides:function(a){var b=this._isOverAxis(this.positionAbs.top+this.offset.click.top,a.top+a.height/2,a.height),c=this._isOverAxis(this.positionAbs.left+this.offset.click.left,a.left+a.width/2,a.width),d=this._getDragVerticalDirection(),e=this._getDragHorizontalDirection();return this.floating&&e?"right"===e&&c||"left"===e&&!c:d&&("down"===d&&b||"up"===d&&!b)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return 0!==a&&(a>0?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return 0!==a&&(a>0?"right":"left")},refresh:function(a){return this._refreshItems(a),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var a=this.options;return a.connectWith.constructor===String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){function c(){h.push(this)}var d,e,f,g,h=[],i=[],j=this._connectWith();if(j&&b)for(d=j.length-1;d>=0;d--)for(f=a(j[d],this.document[0]),e=f.length-1;e>=0;e--)(g=a.data(f[e],this.widgetFullName))&&g!==this&&!g.options.disabled&&i.push([a.isFunction(g.options.items)?g.options.items.call(g.element):a(g.options.items,g.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),g]);for(i.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),d=i.length-1;d>=0;d--)i[d][0].each(c);return a(h)},_removeCurrentsFromItems:function(){var b=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=a.grep(this.items,function(a){for(var c=0;b.length>c;c++)if(b[c]===a.item[0])return!1;return!0})},_refreshItems:function(b){this.items=[],this.containers=[this];var c,d,e,f,g,h,i,j,k=this.items,l=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],m=this._connectWith();if(m&&this.ready)for(c=m.length-1;c>=0;c--)for(e=a(m[c],this.document[0]),d=e.length-1;d>=0;d--)(f=a.data(e[d],this.widgetFullName))&&f!==this&&!f.options.disabled&&(l.push([a.isFunction(f.options.items)?f.options.items.call(f.element[0],b,{item:this.currentItem}):a(f.options.items,f.element),f]),this.containers.push(f));for(c=l.length-1;c>=0;c--)for(g=l[c][1],h=l[c][0],d=0,j=h.length;j>d;d++)i=a(h[d]),i.data(this.widgetName+"-item",g),k.push({item:i,instance:g,width:0,height:0,left:0,top:0})},refreshPositions:function(b){this.floating=!!this.items.length&&("x"===this.options.axis||this._isFloating(this.items[0].item)),this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var c,d,e,f;for(c=this.items.length-1;c>=0;c--)d=this.items[c],d.instance!==this.currentContainer&&this.currentContainer&&d.item[0]!==this.currentItem[0]||(e=this.options.toleranceElement?a(this.options.toleranceElement,d.item):d.item,b||(d.width=e.outerWidth(),d.height=e.outerHeight()),f=e.offset(),d.left=f.left,d.top=f.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(c=this.containers.length-1;c>=0;c--)f=this.containers[c].element.offset(),this.containers[c].containerCache.left=f.left,this.containers[c].containerCache.top=f.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),this.containers[c].containerCache.height=this.containers[c].element.outerHeight();return this},_createPlaceholder:function(b){b=b||this;var c,d=b.options;d.placeholder&&d.placeholder.constructor!==String||(c=d.placeholder,d.placeholder={element:function(){var d=b.currentItem[0].nodeName.toLowerCase(),e=a("<"+d+">",b.document[0]);return b._addClass(e,"ui-sortable-placeholder",c||b.currentItem[0].className)._removeClass(e,"ui-sortable-helper"),"tbody"===d?b._createTrPlaceholder(b.currentItem.find("tr").eq(0),a("<tr>",b.document[0]).appendTo(e)):"tr"===d?b._createTrPlaceholder(b.currentItem,e):"img"===d&&e.attr("src",b.currentItem.attr("src")),c||e.css("visibility","hidden"),e},update:function(a,e){(!c||d.forcePlaceholderSize)&&(e.height()||e.height(b.currentItem.innerHeight()-parseInt(b.currentItem.css("paddingTop")||0,10)-parseInt(b.currentItem.css("paddingBottom")||0,10)),e.width()||e.width(b.currentItem.innerWidth()-parseInt(b.currentItem.css("paddingLeft")||0,10)-parseInt(b.currentItem.css("paddingRight")||0,10)))}}),b.placeholder=a(d.placeholder.element.call(b.element,b.currentItem)),b.currentItem.after(b.placeholder),d.placeholder.update(b,b.placeholder)},_createTrPlaceholder:function(b,c){var d=this;b.children().each(function(){a("<td>&#160;</td>",d.document[0]).attr("colspan",a(this).attr("colspan")||1).appendTo(c)})},_contactContainers:function(b){var c,d,e,f,g,h,i,j,k,l,m=null,n=null;for(c=this.containers.length-1;c>=0;c--)if(!a.contains(this.currentItem[0],this.containers[c].element[0]))if(this._intersectsWith(this.containers[c].containerCache)){if(m&&a.contains(this.containers[c].element[0],m.element[0]))continue;m=this.containers[c],n=c}else this.containers[c].containerCache.over&&(this.containers[c]._trigger("out",b,this._uiHash(this)),this.containers[c].containerCache.over=0);if(m)if(1===this.containers.length)this.containers[n].containerCache.over||(this.containers[n]._trigger("over",b,this._uiHash(this)),this.containers[n].containerCache.over=1);else{for(e=1e4,f=null,k=m.floating||this._isFloating(this.currentItem),g=k?"left":"top",h=k?"width":"height",l=k?"pageX":"pageY",d=this.items.length-1;d>=0;d--)a.contains(this.containers[n].element[0],this.items[d].item[0])&&this.items[d].item[0]!==this.currentItem[0]&&(i=this.items[d].item.offset()[g],j=!1,b[l]-i>this.items[d][h]/2&&(j=!0),e>Math.abs(b[l]-i)&&(e=Math.abs(b[l]-i),f=this.items[d],this.direction=j?"up":"down"));if(!f&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[n])return void(this.currentContainer.containerCache.over||(this.containers[n]._trigger("over",b,this._uiHash()),this.currentContainer.containerCache.over=1));f?this._rearrange(b,f,null,!0):this._rearrange(b,null,this.containers[n].element,!0),this._trigger("change",b,this._uiHash()),this.containers[n]._trigger("change",b,this._uiHash(this)),this.currentContainer=this.containers[n],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[n]._trigger("over",b,this._uiHash(this)),this.containers[n].containerCache.over=1}},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b,this.currentItem])):"clone"===c.helper?this.currentItem.clone():this.currentItem;return d.parents("body").length||a("parent"!==c.appendTo?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(d[0]),d[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!d[0].style.width||c.forceHelperSize)&&d.width(this.currentItem.width()),(!d[0].style.height||c.forceHelperSize)&&d.height(this.currentItem.height()),d},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options;"parent"===e.containment&&(e.containment=this.helper[0].parentNode),("document"===e.containment||"window"===e.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===e.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===e.containment?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(e.containment)||(b=a(e.containment)[0],c=a(e.containment).offset(),d="hidden"!==a(b).css("overflow"),this.containment=[c.left+(parseInt(a(b).css("borderLeftWidth"),10)||0)+(parseInt(a(b).css("paddingLeft"),10)||0)-this.margins.left,c.top+(parseInt(a(b).css("borderTopWidth"),10)||0)+(parseInt(a(b).css("paddingTop"),10)||0)-this.margins.top,c.left+(d?Math.max(b.scrollWidth,b.offsetWidth):b.offsetWidth)-(parseInt(a(b).css("borderLeftWidth"),10)||0)-(parseInt(a(b).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,c.top+(d?Math.max(b.scrollHeight,b.offsetHeight):b.offsetHeight)-(parseInt(a(b).css("borderTopWidth"),10)||0)-(parseInt(a(b).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"===b?1:-1,e="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():f?0:e.scrollTop())*d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*d}},_generatePosition:function(b){var c,d,e=this.options,f=b.pageX,g=b.pageY,h="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(h[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(g=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(g=this.containment[3]+this.offset.click.top)),e.grid&&(c=this.originalPageY+Math.round((g-this.originalPageY)/e.grid[1])*e.grid[1],g=this.containment?c-this.offset.click.top>=this.containment[1]&&c-this.offset.click.top<=this.containment[3]?c:c-this.offset.click.top>=this.containment[1]?c-e.grid[1]:c+e.grid[1]:c,d=this.originalPageX+Math.round((f-this.originalPageX)/e.grid[0])*e.grid[0],f=this.containment?d-this.offset.click.left>=this.containment[0]&&d-this.offset.click.left<=this.containment[2]?d:d-this.offset.click.left>=this.containment[0]?d-e.grid[0]:d+e.grid[0]:d)),{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():i?0:h.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():i?0:h.scrollLeft())}},_rearrange:function(a,b,c,d){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var e=this.counter;this._delay(function(){e===this.counter&&this.refreshPositions(!d)})},_clear:function(a,b){function c(a,b,c){return function(d){c._trigger(a,d,b._uiHash(b))}}this.reverting=!1;var d,e=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(d in this._storedCSS)("auto"===this._storedCSS[d]||"static"===this._storedCSS[d])&&(this._storedCSS[d]="");this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!b&&e.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||b||e.push(function(a){this._trigger("update",a,this._uiHash())}),this!==this.currentContainer&&(b||(e.push(function(a){this._trigger("remove",a,this._uiHash())}),e.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.currentContainer)),e.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.currentContainer)))),d=this.containers.length-1;d>=0;d--)b||e.push(c("deactivate",this,this.containers[d])),this.containers[d].containerCache.over&&(e.push(c("out",this,this.containers[d])),this.containers[d].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,b||this._trigger("beforeStop",a,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!b){for(d=0;e.length>d;d++)e[d].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===a.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(b){var c=b||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:b?b.element:null}}}),a.widget("ui.accordion",{version:"1.12.1",options:{active:0,animate:{},classes:{"ui-accordion-header":"ui-corner-top","ui-accordion-header-collapsed":"ui-corner-all","ui-accordion-content":"ui-corner-bottom"},collapsible:!1,event:"click",header:"> li > :first-child, > :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var b=this.options;this.prevShow=this.prevHide=a(),this._addClass("ui-accordion","ui-widget ui-helper-reset"),this.element.attr("role","tablist"),b.collapsible||!1!==b.active&&null!=b.active||(b.active=0),this._processPanels(),0>b.active&&(b.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():a()}},_createIcons:function(){var b,c,d=this.options.icons;d&&(b=a("<span>"),this._addClass(b,"ui-accordion-header-icon","ui-icon "+d.header),b.prependTo(this.headers),c=this.active.children(".ui-accordion-header-icon"),this._removeClass(c,d.header)._addClass(c,null,d.activeHeader)._addClass(this.headers,"ui-accordion-icons"))},_destroyIcons:function(){this._removeClass(this.headers,"ui-accordion-icons"),this.headers.children(".ui-accordion-header-icon").remove()},_destroy:function(){var a;this.element.removeAttr("role"),this.headers.removeAttr("role aria-expanded aria-selected aria-controls tabIndex").removeUniqueId(),this._destroyIcons(),a=this.headers.next().css("display","").removeAttr("role aria-hidden aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&a.css("height","")},_setOption:function(a,b){return"active"===a?void this._activate(b):("event"===a&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(b)),this._super(a,b),"collapsible"!==a||b||!1!==this.options.active||this._activate(0),void("icons"===a&&(this._destroyIcons(),b&&this._createIcons())))},_setOptionDisabled:function(a){this._super(a),this.element.attr("aria-disabled",a),this._toggleClass(null,"ui-state-disabled",!!a),this._toggleClass(this.headers.add(this.headers.next()),null,"ui-state-disabled",!!a)},_keydown:function(b){if(!b.altKey&&!b.ctrlKey){var c=a.ui.keyCode,d=this.headers.length,e=this.headers.index(b.target),f=!1;switch(b.keyCode){case c.RIGHT:case c.DOWN:f=this.headers[(e+1)%d];break;case c.LEFT:case c.UP:f=this.headers[(e-1+d)%d];break;case c.SPACE:case c.ENTER:this._eventHandler(b);break;case c.HOME:f=this.headers[0];break;case c.END:f=this.headers[d-1]}f&&(a(b.target).attr("tabIndex",-1),
a(f).attr("tabIndex",0),a(f).trigger("focus"),b.preventDefault())}},_panelKeyDown:function(b){b.keyCode===a.ui.keyCode.UP&&b.ctrlKey&&a(b.currentTarget).prev().trigger("focus")},refresh:function(){var b=this.options;this._processPanels(),!1===b.active&&!0===b.collapsible||!this.headers.length?(b.active=!1,this.active=a()):!1===b.active?this._activate(0):this.active.length&&!a.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(b.active=!1,this.active=a()):this._activate(Math.max(0,b.active-1)):b.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var a=this.headers,b=this.panels;this.headers=this.element.find(this.options.header),this._addClass(this.headers,"ui-accordion-header ui-accordion-header-collapsed","ui-state-default"),this.panels=this.headers.next().filter(":not(.ui-accordion-content-active)").hide(),this._addClass(this.panels,"ui-accordion-content","ui-helper-reset ui-widget-content"),b&&(this._off(a.not(this.headers)),this._off(b.not(this.panels)))},_refresh:function(){var b,c=this.options,d=c.heightStyle,e=this.element.parent();this.active=this._findActive(c.active),this._addClass(this.active,"ui-accordion-header-active","ui-state-active")._removeClass(this.active,"ui-accordion-header-collapsed"),this._addClass(this.active.next(),"ui-accordion-content-active"),this.active.next().show(),this.headers.attr("role","tab").each(function(){var b=a(this),c=b.uniqueId().attr("id"),d=b.next(),e=d.uniqueId().attr("id");b.attr("aria-controls",e),d.attr("aria-labelledby",c)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(c.event),"fill"===d?(b=e.height(),this.element.siblings(":visible").each(function(){var c=a(this),d=c.css("position");"absolute"!==d&&"fixed"!==d&&(b-=c.outerHeight(!0))}),this.headers.each(function(){b-=a(this).outerHeight(!0)}),this.headers.next().each(function(){a(this).height(Math.max(0,b-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")):"auto"===d&&(b=0,this.headers.next().each(function(){var c=a(this).is(":visible");c||a(this).show(),b=Math.max(b,a(this).css("height","").height()),c||a(this).hide()}).height(b))},_activate:function(b){var c=this._findActive(b)[0];c!==this.active[0]&&(c=c||this.active[0],this._eventHandler({target:c,currentTarget:c,preventDefault:a.noop}))},_findActive:function(b){return"number"==typeof b?this.headers.eq(b):a()},_setupEvents:function(b){var c={keydown:"_keydown"};b&&a.each(b.split(" "),function(a,b){c[b]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,c),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(b){var c,d,e=this.options,f=this.active,g=a(b.currentTarget),h=g[0]===f[0],i=h&&e.collapsible,j=i?a():g.next(),k=f.next(),l={oldHeader:f,oldPanel:k,newHeader:i?a():g,newPanel:j};b.preventDefault(),h&&!e.collapsible||!1===this._trigger("beforeActivate",b,l)||(e.active=!i&&this.headers.index(g),this.active=h?a():g,this._toggle(l),this._removeClass(f,"ui-accordion-header-active","ui-state-active"),e.icons&&(c=f.children(".ui-accordion-header-icon"),this._removeClass(c,null,e.icons.activeHeader)._addClass(c,null,e.icons.header)),h||(this._removeClass(g,"ui-accordion-header-collapsed")._addClass(g,"ui-accordion-header-active","ui-state-active"),e.icons&&(d=g.children(".ui-accordion-header-icon"),this._removeClass(d,null,e.icons.header)._addClass(d,null,e.icons.activeHeader)),this._addClass(g.next(),"ui-accordion-content-active")))},_toggle:function(b){var c=b.newPanel,d=this.prevShow.length?this.prevShow:b.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=c,this.prevHide=d,this.options.animate?this._animate(c,d,b):(d.hide(),c.show(),this._toggleComplete(b)),d.attr({"aria-hidden":"true"}),d.prev().attr({"aria-selected":"false","aria-expanded":"false"}),c.length&&d.length?d.prev().attr({tabIndex:-1,"aria-expanded":"false"}):c.length&&this.headers.filter(function(){return 0===parseInt(a(this).attr("tabIndex"),10)}).attr("tabIndex",-1),c.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(a,b,c){var d,e,f,g=this,h=0,i=a.css("box-sizing"),j=a.length&&(!b.length||a.index()<b.index()),k=this.options.animate||{},l=j&&k.down||k,m=function(){g._toggleComplete(c)};return"number"==typeof l&&(f=l),"string"==typeof l&&(e=l),e=e||l.easing||k.easing,f=f||l.duration||k.duration,b.length?a.length?(d=a.show().outerHeight(),b.animate(this.hideProps,{duration:f,easing:e,step:function(a,b){b.now=Math.round(a)}}),void a.hide().animate(this.showProps,{duration:f,easing:e,complete:m,step:function(a,c){c.now=Math.round(a),"height"!==c.prop?"content-box"===i&&(h+=c.now):"content"!==g.options.heightStyle&&(c.now=Math.round(d-b.outerHeight()-h),h=0)}})):b.animate(this.hideProps,f,e,m):a.animate(this.showProps,f,e,m)},_toggleComplete:function(a){var b=a.oldPanel,c=b.prev();this._removeClass(b,"ui-accordion-content-active"),this._removeClass(c,"ui-accordion-header-active")._addClass(c,"ui-accordion-header-collapsed"),b.length&&(b.parent()[0].className=b.parent()[0].className),this._trigger("activate",null,a)}}),a.widget("ui.menu",{version:"1.12.1",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().attr({role:this.options.role,tabIndex:0}),this._addClass("ui-menu","ui-widget ui-widget-content"),this._on({"mousedown .ui-menu-item":function(a){a.preventDefault()},"click .ui-menu-item":function(b){var c=a(b.target),d=a(a.ui.safeActiveElement(this.document[0]));!this.mouseHandled&&c.not(".ui-state-disabled").length&&(this.select(b),b.isPropagationStopped()||(this.mouseHandled=!0),c.has(".ui-menu").length?this.expand(b):!this.element.is(":focus")&&d.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(b){if(!this.previousFilter){var c=a(b.target).closest(".ui-menu-item"),d=a(b.currentTarget);c[0]===d[0]&&(this._removeClass(d.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(b,d))}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(a,b){var c=this.active||this.element.find(this.options.items).eq(0);b||this.focus(a,c)},blur:function(b){this._delay(function(){!a.contains(this.element[0],a.ui.safeActiveElement(this.document[0]))&&this.collapseAll(b)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(a){this._closeOnDocumentClick(a)&&this.collapseAll(a),this.mouseHandled=!1}})},_destroy:function(){var b=this.element.find(".ui-menu-item").removeAttr("role aria-disabled"),c=b.children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(),c.children().each(function(){var b=a(this);b.data("ui-menu-submenu-caret")&&b.remove()})},_keydown:function(b){var c,d,e,f,g=!0;switch(b.keyCode){case a.ui.keyCode.PAGE_UP:this.previousPage(b);break;case a.ui.keyCode.PAGE_DOWN:this.nextPage(b);break;case a.ui.keyCode.HOME:this._move("first","first",b);break;case a.ui.keyCode.END:this._move("last","last",b);break;case a.ui.keyCode.UP:this.previous(b);break;case a.ui.keyCode.DOWN:this.next(b);break;case a.ui.keyCode.LEFT:this.collapse(b);break;case a.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(b);break;case a.ui.keyCode.ENTER:case a.ui.keyCode.SPACE:this._activate(b);break;case a.ui.keyCode.ESCAPE:this.collapse(b);break;default:g=!1,d=this.previousFilter||"",f=!1,e=b.keyCode>=96&&105>=b.keyCode?""+(b.keyCode-96):String.fromCharCode(b.keyCode),clearTimeout(this.filterTimer),e===d?f=!0:e=d+e,c=this._filterMenuItems(e),c=f&&-1!==c.index(this.active.next())?this.active.nextAll(".ui-menu-item"):c,c.length||(e=String.fromCharCode(b.keyCode),c=this._filterMenuItems(e)),c.length?(this.focus(b,c),this.previousFilter=e,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}g&&b.preventDefault()},_activate:function(a){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(a):this.select(a))},refresh:function(){var b,c,d,e,f,g=this,h=this.options.icons.submenu,i=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length),d=i.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var b=a(this),c=b.prev(),d=a("<span>").data("ui-menu-submenu-caret",!0);g._addClass(d,"ui-menu-icon","ui-icon "+h),c.attr("aria-haspopup","true").prepend(d),b.attr("aria-labelledby",c.attr("id"))}),this._addClass(d,"ui-menu","ui-widget ui-widget-content ui-front"),b=i.add(this.element),c=b.find(this.options.items),c.not(".ui-menu-item").each(function(){var b=a(this);g._isDivider(b)&&g._addClass(b,"ui-menu-divider","ui-widget-content")}),e=c.not(".ui-menu-item, .ui-menu-divider"),f=e.children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),this._addClass(e,"ui-menu-item")._addClass(f,"ui-menu-item-wrapper"),c.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!a.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(a,b){if("icons"===a){var c=this.element.find(".ui-menu-icon");this._removeClass(c,null,this.options.icons.submenu)._addClass(c,null,b.submenu)}this._super(a,b)},_setOptionDisabled:function(a){this._super(a),this.element.attr("aria-disabled",a+""),this._toggleClass(null,"ui-state-disabled",!!a)},focus:function(a,b){var c,d,e;this.blur(a,a&&"focus"===a.type),this._scrollIntoView(b),this.active=b.first(),d=this.active.children(".ui-menu-item-wrapper"),this._addClass(d,null,"ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",d.attr("id")),e=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"),this._addClass(e,null,"ui-state-active"),a&&"keydown"===a.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),c=b.children(".ui-menu"),c.length&&a&&/^mouse/.test(a.type)&&this._startOpening(c),this.activeMenu=b.parent(),this._trigger("focus",a,{item:b})},_scrollIntoView:function(b){var c,d,e,f,g,h;this._hasScroll()&&(c=parseFloat(a.css(this.activeMenu[0],"borderTopWidth"))||0,d=parseFloat(a.css(this.activeMenu[0],"paddingTop"))||0,e=b.offset().top-this.activeMenu.offset().top-c-d,f=this.activeMenu.scrollTop(),g=this.activeMenu.height(),h=b.outerHeight(),0>e?this.activeMenu.scrollTop(f+e):e+h>g&&this.activeMenu.scrollTop(f+e-g+h))},blur:function(a,b){b||clearTimeout(this.timer),this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",a,{item:this.active}),this.active=null)},_startOpening:function(a){clearTimeout(this.timer),"true"===a.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(a)},this.delay))},_open:function(b){var c=a.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(b.parents(".ui-menu")).hide().attr("aria-hidden","true"),b.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(c)},collapseAll:function(b,c){clearTimeout(this.timer),this.timer=this._delay(function(){var d=c?this.element:a(b&&b.target).closest(this.element.find(".ui-menu"));d.length||(d=this.element),this._close(d),this.blur(b),this._removeClass(d.find(".ui-state-active"),null,"ui-state-active"),this.activeMenu=d},this.delay)},_close:function(a){a||(a=this.active?this.active.parent():this.element),a.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(b){return!a(b.target).closest(".ui-menu").length},_isDivider:function(a){return!/[^\-\u2014\u2013\s]/.test(a.text())},collapse:function(a){var b=this.active&&this.active.parent().closest(".ui-menu-item",this.element);b&&b.length&&(this._close(),this.focus(a,b))},expand:function(a){var b=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();b&&b.length&&(this._open(b.parent()),this._delay(function(){this.focus(a,b)}))},next:function(a){this._move("next","first",a)},previous:function(a){this._move("prev","last",a)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(a,b,c){var d;this.active&&(d="first"===a||"last"===a?this.active["first"===a?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[a+"All"](".ui-menu-item").eq(0)),d&&d.length&&this.active||(d=this.activeMenu.find(this.options.items)[b]()),this.focus(c,d)},nextPage:function(b){var c,d,e;return this.active?void(this.isLastItem()||(this._hasScroll()?(d=this.active.offset().top,e=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return c=a(this),0>c.offset().top-d-e}),this.focus(b,c)):this.focus(b,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))):void this.next(b)},previousPage:function(b){var c,d,e;return this.active?void(this.isFirstItem()||(this._hasScroll()?(d=this.active.offset().top,e=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return c=a(this),c.offset().top-d+e>0}),this.focus(b,c)):this.focus(b,this.activeMenu.find(this.options.items).first()))):void this.next(b)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(b){this.active=this.active||a(b.target).closest(".ui-menu-item");var c={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(b,!0),this._trigger("select",b,c)},_filterMenuItems:function(b){var c=b.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),d=RegExp("^"+c,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return d.test(a.trim(a(this).children(".ui-menu-item-wrapper").text()))})}}),a.widget("ui.autocomplete",{version:"1.12.1",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var b,c,d,e=this.element[0].nodeName.toLowerCase(),f="textarea"===e,g="input"===e;this.isMultiLine=f||!g&&this._isContentEditable(this.element),this.valueMethod=this.element[f||g?"val":"text"],this.isNewMenu=!0,this._addClass("ui-autocomplete-input"),this.element.attr("autocomplete","off"),this._on(this.element,{keydown:function(e){if(this.element.prop("readOnly"))return b=!0,d=!0,void(c=!0);b=!1,d=!1,c=!1;var f=a.ui.keyCode;switch(e.keyCode){case f.PAGE_UP:b=!0,this._move("previousPage",e);break;case f.PAGE_DOWN:b=!0,this._move("nextPage",e);break;case f.UP:b=!0,this._keyEvent("previous",e);break;case f.DOWN:b=!0,this._keyEvent("next",e);break;case f.ENTER:this.menu.active&&(b=!0,e.preventDefault(),this.menu.select(e));break;case f.TAB:this.menu.active&&this.menu.select(e);break;case f.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(e),e.preventDefault());break;default:c=!0,this._searchTimeout(e)}},keypress:function(d){if(b)return b=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&d.preventDefault());if(!c){var e=a.ui.keyCode;switch(d.keyCode){case e.PAGE_UP:this._move("previousPage",d);break;case e.PAGE_DOWN:this._move("nextPage",d);break;case e.UP:this._keyEvent("previous",d);break;case e.DOWN:this._keyEvent("next",d)}}},input:function(a){return d?(d=!1,void a.preventDefault()):void this._searchTimeout(a)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(a){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(a),void this._change(a))}}),this._initSource(),this.menu=a("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._addClass(this.menu.element,"ui-autocomplete","ui-front"),this._on(this.menu.element,{mousedown:function(b){b.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,this.element[0]!==a.ui.safeActiveElement(this.document[0])&&this.element.trigger("focus")})},menufocus:function(b,c){var d,e;return this.isNewMenu&&(this.isNewMenu=!1,b.originalEvent&&/^mouse/.test(b.originalEvent.type))?(this.menu.blur(),void this.document.one("mousemove",function(){a(b.target).trigger(b.originalEvent)})):(e=c.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",b,{item:e})&&b.originalEvent&&/^key/.test(b.originalEvent.type)&&this._value(e.value),void((d=c.item.attr("aria-label")||e.value)&&a.trim(d).length&&(this.liveRegion.children().hide(),a("<div>").text(d).appendTo(this.liveRegion))))},menuselect:function(b,c){var d=c.item.data("ui-autocomplete-item"),e=this.previous;this.element[0]!==a.ui.safeActiveElement(this.document[0])&&(this.element.trigger("focus"),this.previous=e,this._delay(function(){this.previous=e,this.selectedItem=d})),!1!==this._trigger("select",b,{item:d})&&this._value(d.value),this.term=this._value(),this.close(b),this.selectedItem=d}}),this.liveRegion=a("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(a,b){this._super(a,b),"source"===a&&this._initSource(),"appendTo"===a&&this.menu.element.appendTo(this._appendTo()),"disabled"===a&&b&&this.xhr&&this.xhr.abort()},_isEventTargetInWidget:function(b){var c=this.menu.element[0];return b.target===this.element[0]||b.target===c||a.contains(c,b.target)},_closeOnClickOutside:function(a){this._isEventTargetInWidget(a)||this.close()},_appendTo:function(){var b=this.options.appendTo;return b&&(b=b.jquery||b.nodeType?a(b):this.document.find(b).eq(0)),b&&b[0]||(b=this.element.closest(".ui-front, dialog")),b.length||(b=this.document[0].body),b},_initSource:function(){var b,c,d=this;a.isArray(this.options.source)?(b=this.options.source,this.source=function(c,d){d(a.ui.autocomplete.filter(b,c.term))}):"string"==typeof this.options.source?(c=this.options.source,this.source=function(b,e){d.xhr&&d.xhr.abort(),d.xhr=a.ajax({url:c,data:b,dataType:"json",success:function(a){e(a)},error:function(){e([])}})}):this.source=this.options.source},_searchTimeout:function(a){clearTimeout(this.searching),this.searching=this._delay(function(){var b=this.term===this._value(),c=this.menu.element.is(":visible"),d=a.altKey||a.ctrlKey||a.metaKey||a.shiftKey;(!b||b&&!c&&!d)&&(this.selectedItem=null,this.search(null,a))},this.options.delay)},search:function(a,b){return a=null!=a?a:this._value(),this.term=this._value(),a.length<this.options.minLength?this.close(b):!1!==this._trigger("search",b)?this._search(a):void 0},_search:function(a){this.pending++,this._addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:a},this._response())},_response:function(){var b=++this.requestIndex;return a.proxy(function(a){b===this.requestIndex&&this.__response(a),--this.pending||this._removeClass("ui-autocomplete-loading")},this)},__response:function(a){a&&(a=this._normalize(a)),this._trigger("response",null,{content:a}),!this.options.disabled&&a&&a.length&&!this.cancelSearch?(this._suggest(a),this._trigger("open")):this._close()},close:function(a){this.cancelSearch=!0,this._close(a)},_close:function(a){this._off(this.document,"mousedown"),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",a))},_change:function(a){this.previous!==this._value()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(b){return b.length&&b[0].label&&b[0].value?b:a.map(b,function(b){return"string"==typeof b?{label:b,value:b}:a.extend({},b,{label:b.label||b.value,value:b.value||b.label})})},_suggest:function(b){var c=this.menu.element.empty();this._renderMenu(c,b),this.isNewMenu=!0,this.menu.refresh(),c.show(),this._resizeMenu(),c.position(a.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(),this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(b,c){var d=this;a.each(c,function(a,c){d._renderItemData(b,c)})},_renderItemData:function(a,b){return this._renderItem(a,b).data("ui-autocomplete-item",b)},_renderItem:function(b,c){return a("<li>").append(a("<div>").text(c.label)).appendTo(b)},_move:function(a,b){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(a)||this.menu.isLastItem()&&/^next/.test(a)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[a](b):void this.search(null,b)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(a,b){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(a,b),b.preventDefault())},_isContentEditable:function(a){if(!a.length)return!1;var b=a.prop("contentEditable");return"inherit"===b?this._isContentEditable(a.parent()):"true"===b}}),a.extend(a.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(b,c){var d=RegExp(a.ui.autocomplete.escapeRegex(c),"i");return a.grep(b,function(a){return d.test(a.label||a.value||a)})}}),a.widget("ui.autocomplete",a.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(a){return a+(a>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(b){var c;this._superApply(arguments),this.options.disabled||this.cancelSearch||(c=b&&b.length?this.options.messages.results(b.length):this.options.messages.noResults,this.liveRegion.children().hide(),a("<div>").text(c).appendTo(this.liveRegion))}}),a.ui.autocomplete,a.widget("ui.checkboxradio",[a.ui.formResetMixin,{version:"1.12.1",options:{disabled:null,label:null,icon:!0,classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var b,c,d=this,e=this._super()||{};return this._readType(),c=this.element.labels(),this.label=a(c[c.length-1]),this.label.length||a.error("No label found for checkboxradio widget"),this.originalLabel="",this.label.contents().not(this.element[0]).each(function(){d.originalLabel+=3===this.nodeType?a(this).text():this.outerHTML}),this.originalLabel&&(e.label=this.originalLabel),b=this.element[0].disabled,null!=b&&(e.disabled=b),e},_create:function(){var a=this.element[0].checked;this._bindFormResetHandler(),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled),this._setOption("disabled",this.options.disabled),this._addClass("ui-checkboxradio","ui-helper-hidden-accessible"),this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget"),"radio"===this.type&&this._addClass(this.label,"ui-checkboxradio-radio-label"),this.options.label&&this.options.label!==this.originalLabel?this._updateLabel():this.originalLabel&&(this.options.label=this.originalLabel),this._enhance(),a&&(this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active"),this.icon&&this._addClass(this.icon,null,"ui-state-hover")),this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus")},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus")}})},_readType:function(){var b=this.element[0].nodeName.toLowerCase();this.type=this.element[0].type,"input"===b&&/radio|checkbox/.test(this.type)||a.error("Can't create checkboxradio on element.nodeName="+b+" and element.type="+this.type)},_enhance:function(){this._updateIcon(this.element[0].checked)},widget:function(){return this.label},_getRadioGroup:function(){var b,c=this.element[0].name,d="input[name='"+a.ui.escapeSelector(c)+"']";return c?(b=this.form.length?a(this.form[0].elements).filter(d):a(d).filter(function(){return 0===a(this).form().length}),b.not(this.element)):a([])},_toggleClasses:function(){var b=this.element[0].checked;this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",b),this.options.icon&&"checkbox"===this.type&&this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",b)._toggleClass(this.icon,null,"ui-icon-blank",!b),"radio"===this.type&&this._getRadioGroup().each(function(){var b=a(this).checkboxradio("instance");b&&b._removeClass(b.label,"ui-checkboxradio-checked","ui-state-active")})},_destroy:function(){this._unbindFormResetHandler(),this.icon&&(this.icon.remove(),this.iconSpace.remove())},_setOption:function(a,b){return"label"!==a||b?(this._super(a,b),"disabled"===a?(this._toggleClass(this.label,null,"ui-state-disabled",b),void(this.element[0].disabled=b)):void this.refresh()):void 0},_updateIcon:function(b){var c="ui-icon ui-icon-background ";this.options.icon?(this.icon||(this.icon=a("<span>"),this.iconSpace=a("<span> </span>"),this._addClass(this.iconSpace,"ui-checkboxradio-icon-space")),"checkbox"===this.type?(c+=b?"ui-icon-check ui-state-checked":"ui-icon-blank",this._removeClass(this.icon,null,b?"ui-icon-blank":"ui-icon-check")):c+="ui-icon-blank",this._addClass(this.icon,"ui-checkboxradio-icon",c),b||this._removeClass(this.icon,null,"ui-icon-check ui-state-checked"),this.icon.prependTo(this.label).after(this.iconSpace)):void 0!==this.icon&&(this.icon.remove(),this.iconSpace.remove(),delete this.icon)},_updateLabel:function(){var a=this.label.contents().not(this.element[0]);this.icon&&(a=a.not(this.icon[0])),this.iconSpace&&(a=a.not(this.iconSpace[0])),a.remove(),this.label.append(this.options.label)},refresh:function(){var a=this.element[0].checked,b=this.element[0].disabled;this._updateIcon(a),this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",a),null!==this.options.label&&this._updateLabel(),b!==this.options.disabled&&this._setOptions({disabled:b})}}]),a.ui.checkboxradio;var g=/ui-corner-([a-z]){2,6}/g;a.widget("ui.controlgroup",{version:"1.12.1",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:!0,items:{button:"input[type=button], input[type=submit], input[type=reset], button, a",controlgroupLabel:".ui-controlgroup-label",checkboxradio:"input[type='checkbox'], input[type='radio']",selectmenu:"select",spinner:".ui-spinner-input"}},_create:function(){this._enhance()},_enhance:function(){this.element.attr("role","toolbar"),this.refresh()},_destroy:function(){this._callChildMethod("destroy"),this.childWidgets.removeData("ui-controlgroup-data"),this.element.removeAttr("role"),this.options.items.controlgroupLabel&&this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap()},_initWidgets:function(){var b=this,c=[];a.each(this.options.items,function(d,e){var f,g={};return e?"controlgroupLabel"===d?(f=b.element.find(e),f.each(function(){var b=a(this);b.children(".ui-controlgroup-label-contents").length||b.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>")}),b._addClass(f,null,"ui-widget ui-widget-content ui-state-default"),void(c=c.concat(f.get()))):void(a.fn[d]&&(g=b["_"+d+"Options"]?b["_"+d+"Options"]("middle"):{classes:{}},b.element.find(e).each(function(){var e=a(this),f=e[d]("instance"),h=a.widget.extend({},g);if("button"!==d||!e.parent(".ui-spinner").length){f||(f=e[d]()[d]("instance")),f&&(h.classes=b._resolveClassesValues(h.classes,f)),e[d](h);var i=e[d]("widget");a.data(i[0],"ui-controlgroup-data",f||e[d]("instance")),c.push(i[0])}}))):void 0}),this.childWidgets=a(a.unique(c)),this._addClass(this.childWidgets,"ui-controlgroup-item")},_callChildMethod:function(b){this.childWidgets.each(function(){var c=a(this),d=c.data("ui-controlgroup-data");d&&d[b]&&d[b]()})},_updateCornerClass:function(a,b){var c=this._buildSimpleOptions(b,"label").classes.label;this._removeClass(a,null,"ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all"),this._addClass(a,null,c)},_buildSimpleOptions:function(a,b){var c="vertical"===this.options.direction,d={classes:{}};return d.classes[b]={middle:"",first:"ui-corner-"+(c?"top":"left"),last:"ui-corner-"+(c?"bottom":"right"),only:"ui-corner-all"}[a],d},_spinnerOptions:function(a){var b=this._buildSimpleOptions(a,"ui-spinner");return b.classes["ui-spinner-up"]="",b.classes["ui-spinner-down"]="",b},_buttonOptions:function(a){return this._buildSimpleOptions(a,"ui-button")},_checkboxradioOptions:function(a){return this._buildSimpleOptions(a,"ui-checkboxradio-label")},_selectmenuOptions:function(a){var b="vertical"===this.options.direction;return{width:!!b&&"auto",classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(b?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(b?"top":"left")},last:{"ui-selectmenu-button-open":b?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(b?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[a]}},_resolveClassesValues:function(b,c){var d={};return a.each(b,function(e){var f=c.options.classes[e]||"";f=a.trim(f.replace(g,"")),d[e]=(f+" "+b[e]).replace(/\s+/g," ")}),d},_setOption:function(a,b){return"direction"===a&&this._removeClass("ui-controlgroup-"+this.options.direction),this._super(a,b),"disabled"===a?void this._callChildMethod(b?"disable":"enable"):void this.refresh()},refresh:function(){var b,c=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction),"horizontal"===this.options.direction&&this._addClass(null,"ui-helper-clearfix"),this._initWidgets(),b=this.childWidgets,this.options.onlyVisible&&(b=b.filter(":visible")),b.length&&(a.each(["first","last"],function(a,d){var e=b[d]().data("ui-controlgroup-data");if(e&&c["_"+e.widgetName+"Options"]){var f=c["_"+e.widgetName+"Options"](1===b.length?"only":d);f.classes=c._resolveClassesValues(f.classes,e),e.element[e.widgetName](f)}else c._updateCornerClass(b[d](),d)}),this._callChildMethod("refresh"))}}),a.widget("ui.slider",a.ui.mouse,{version:"1.12.1",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content"),
this._refresh(),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var b,c,d=this.options,e=this.element.find(".ui-slider-handle"),f=[];for(c=d.values&&d.values.length||1,e.length>c&&(e.slice(c).remove(),e=e.slice(0,c)),b=e.length;c>b;b++)f.push("<span tabindex='0'></span>");this.handles=e.add(a(f.join("")).appendTo(this.element)),this._addClass(this.handles,"ui-slider-handle","ui-state-default"),this.handle=this.handles.eq(0),this.handles.each(function(b){a(this).data("ui-slider-handle-index",b).attr("tabIndex",0)})},_createRange:function(){var b=this.options;b.range?(!0===b.range&&(b.values?b.values.length&&2!==b.values.length?b.values=[b.values[0],b.values[0]]:a.isArray(b.values)&&(b.values=b.values.slice(0)):b.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})):(this.range=a("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")),("min"===b.range||"max"===b.range)&&this._addClass(this.range,"ui-slider-range-"+b.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this._mouseDestroy()},_mouseCapture:function(b){var c,d,e,f,g,h,i,j=this,k=this.options;return!k.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),c={x:b.pageX,y:b.pageY},d=this._normValueFromMouse(c),e=this._valueMax()-this._valueMin()+1,this.handles.each(function(b){var c=Math.abs(d-j.values(b));(e>c||e===c&&(b===j._lastChangedValue||j.values(b)===k.min))&&(e=c,f=a(this),g=b)}),!1!==this._start(b,g)&&(this._mouseSliding=!0,this._handleIndex=g,this._addClass(f,null,"ui-state-active"),f.trigger("focus"),h=f.offset(),i=!a(b.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=i?{left:0,top:0}:{left:b.pageX-h.left-f.width()/2,top:b.pageY-h.top-f.height()/2-(parseInt(f.css("borderTopWidth"),10)||0)-(parseInt(f.css("borderBottomWidth"),10)||0)+(parseInt(f.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(b,g,d),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(a){var b={x:a.pageX,y:a.pageY},c=this._normValueFromMouse(b);return this._slide(a,this._handleIndex,c),!1},_mouseStop:function(a){return this._removeClass(this.handles,null,"ui-state-active"),this._mouseSliding=!1,this._stop(a,this._handleIndex),this._change(a,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(a){var b,c,d,e,f;return"horizontal"===this.orientation?(b=this.elementSize.width,c=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,c=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),d=c/b,d>1&&(d=1),0>d&&(d=0),"vertical"===this.orientation&&(d=1-d),e=this._valueMax()-this._valueMin(),f=this._valueMin()+d*e,this._trimAlignValue(f)},_uiHash:function(a,b,c){var d={handle:this.handles[a],handleIndex:a,value:void 0!==b?b:this.value()};return this._hasMultipleValues()&&(d.value=void 0!==b?b:this.values(a),d.values=c||this.values()),d},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(a,b){return this._trigger("start",a,this._uiHash(b))},_slide:function(a,b,c){var d,e=this.value(),f=this.values();this._hasMultipleValues()&&(d=this.values(b?0:1),e=this.values(b),2===this.options.values.length&&!0===this.options.range&&(c=0===b?Math.min(d,c):Math.max(d,c)),f[b]=c),c!==e&&!1!==this._trigger("slide",a,this._uiHash(b,c,f))&&(this._hasMultipleValues()?this.values(b,c):this.value(c))},_stop:function(a,b){this._trigger("stop",a,this._uiHash(b))},_change:function(a,b){this._keySliding||this._mouseSliding||(this._lastChangedValue=b,this._trigger("change",a,this._uiHash(b)))},value:function(a){return arguments.length?(this.options.value=this._trimAlignValue(a),this._refreshValue(),void this._change(null,0)):this._value()},values:function(b,c){var d,e,f;if(arguments.length>1)return this.options.values[b]=this._trimAlignValue(c),this._refreshValue(),void this._change(null,b);if(!arguments.length)return this._values();if(!a.isArray(arguments[0]))return this._hasMultipleValues()?this._values(b):this.value();for(d=this.options.values,e=arguments[0],f=0;d.length>f;f+=1)d[f]=this._trimAlignValue(e[f]),this._change(null,f);this._refreshValue()},_setOption:function(b,c){var d,e=0;switch("range"===b&&!0===this.options.range&&("min"===c?(this.options.value=this._values(0),this.options.values=null):"max"===c&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),a.isArray(this.options.values)&&(e=this.options.values.length),this._super(b,c),b){case"orientation":this._detectOrientation(),this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation),this._refreshValue(),this.options.range&&this._refreshRange(c),this.handles.css("horizontal"===c?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),d=e-1;d>=0;d--)this._change(null,d);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_setOptionDisabled:function(a){this._super(a),this._toggleClass(null,"ui-state-disabled",!!a)},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a)},_values:function(a){var b,c,d;if(arguments.length)return b=this.options.values[a],b=this._trimAlignValue(b);if(this._hasMultipleValues()){for(c=this.options.values.slice(),d=0;c.length>d;d+=1)c[d]=this._trimAlignValue(c[d]);return c}return[]},_trimAlignValue:function(a){if(this._valueMin()>=a)return this._valueMin();if(a>=this._valueMax())return this._valueMax();var b=this.options.step>0?this.options.step:1,c=(a-this._valueMin())%b,d=a-c;return 2*Math.abs(c)>=b&&(d+=c>0?b:-b),parseFloat(d.toFixed(5))},_calculateNewMax:function(){var a=this.options.max,b=this._valueMin(),c=this.options.step;a=Math.round((a-b)/c)*c+b,a>this.options.max&&(a-=c),this.max=parseFloat(a.toFixed(this._precision()))},_precision:function(){var a=this._precisionOf(this.options.step);return null!==this.options.min&&(a=Math.max(a,this._precisionOf(this.options.min))),a},_precisionOf:function(a){var b=""+a,c=b.indexOf(".");return-1===c?0:b.length-c-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(a){"vertical"===a&&this.range.css({width:"",left:""}),"horizontal"===a&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var b,c,d,e,f,g=this.options.range,h=this.options,i=this,j=!this._animateOff&&h.animate,k={};this._hasMultipleValues()?this.handles.each(function(d){c=(i.values(d)-i._valueMin())/(i._valueMax()-i._valueMin())*100,k["horizontal"===i.orientation?"left":"bottom"]=c+"%",a(this).stop(1,1)[j?"animate":"css"](k,h.animate),!0===i.options.range&&("horizontal"===i.orientation?(0===d&&i.range.stop(1,1)[j?"animate":"css"]({left:c+"%"},h.animate),1===d&&i.range[j?"animate":"css"]({width:c-b+"%"},{queue:!1,duration:h.animate})):(0===d&&i.range.stop(1,1)[j?"animate":"css"]({bottom:c+"%"},h.animate),1===d&&i.range[j?"animate":"css"]({height:c-b+"%"},{queue:!1,duration:h.animate}))),b=c}):(d=this.value(),e=this._valueMin(),f=this._valueMax(),c=f!==e?(d-e)/(f-e)*100:0,k["horizontal"===this.orientation?"left":"bottom"]=c+"%",this.handle.stop(1,1)[j?"animate":"css"](k,h.animate),"min"===g&&"horizontal"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({width:c+"%"},h.animate),"max"===g&&"horizontal"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({width:100-c+"%"},h.animate),"min"===g&&"vertical"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({height:c+"%"},h.animate),"max"===g&&"vertical"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({height:100-c+"%"},h.animate))},_handleEvents:{keydown:function(b){var c,d,e,f=a(b.target).data("ui-slider-handle-index");switch(b.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(b.preventDefault(),!this._keySliding&&(this._keySliding=!0,this._addClass(a(b.target),null,"ui-state-active"),!1===this._start(b,f)))return}switch(e=this.options.step,c=d=this._hasMultipleValues()?this.values(f):this.value(),b.keyCode){case a.ui.keyCode.HOME:d=this._valueMin();break;case a.ui.keyCode.END:d=this._valueMax();break;case a.ui.keyCode.PAGE_UP:d=this._trimAlignValue(c+(this._valueMax()-this._valueMin())/this.numPages);break;case a.ui.keyCode.PAGE_DOWN:d=this._trimAlignValue(c-(this._valueMax()-this._valueMin())/this.numPages);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(c===this._valueMax())return;d=this._trimAlignValue(c+e);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(c===this._valueMin())return;d=this._trimAlignValue(c-e)}this._slide(b,f,d)},keyup:function(b){var c=a(b.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(b,c),this._change(b,c),this._removeClass(a(b.target),null,"ui-state-active"))}}})}),function(a){function b(a,b){if(!(a.originalEvent.touches.length>1)){var c=a.originalEvent.changedTouches[0],d=document.createEvent("MouseEvents");d.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(d)}}if(a.support.touch="ontouchend"in document,a.support.touch){var c,d=a.ui.mouse.prototype,e=d._mouseInit,f=d._mouseDestroy;d._touchStart=function(a){var d=this;!c&&d._mouseCapture(a.originalEvent.changedTouches[0])&&(c=!0,d._touchMoved=!1,b(a,"mouseover"),b(a,"mousemove"),b(a,"mousedown"))},d._touchMove=function(a){c&&(this._touchMoved=!0,b(a,"mousemove"))},d._touchEnd=function(a){c&&(b(a,"mouseup"),b(a,"mouseout"),c=!1)},d._mouseInit=function(){var b=this;b.element.bind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),e.call(b)},d._mouseDestroy=function(){var b=this;b.element.unbind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),f.call(b)}}}(jQuery),function(a){var b=a.ui.ddmanager.prepareOffsets;a.ui.ddmanager.prepareOffsets=function(c,d){b.apply(this,arguments);var e=a.ui.ddmanager.droppables[c.options.scope]||[];for(i=0;i<e.length;i++)if((doc=e[i].document[0])!==document){var f=a((doc.defaultView||doc.parentWindow).frameElement),g=f.offset(),h=e[i].element,j={top:f.contents().scrollTop(),left:f.contents().scrollLeft()};j.right=j.left+f.width(),j.bottom=j.top+f.height();var k=h.offset();if(k.right=k.left+h.outerWidth(),k.bottom=k.top+h.outerHeight(),j.right<k.left||j.left>k.right||j.bottom<k.top||j.top>k.bottom){e[i].proportions().height=0;continue}var l=k.top-f.contents().scrollTop();l=l<0?0:l;var m=k.left-f.contents().scrollLeft();m=m<0?0:m;var n=k.top+h.height()-f.contents().scrollTop();n=n>f.height()?f.height():n;var o=k.left+h.width()-f.contents().scrollLeft();o=o>f.width()?f.width():o,e[i].offset.top=g.top+l,e[i].offset.left=g.left+m,e[i].proportions({width:o-m,height:n-l})}},a.ui.plugin.add("draggable","iframeScroll",{drag:function(b,c,d){var e=d.options,f=!0===e.iframeFix?"iframe":e.iframeFix;d.document.find(f).each(function(){var c,f=!1,g=a(this),h=g.offset();h.width=g.width(),h.height=g.height(),h.left<b.pageX&&b.pageX<h.left+h.width&&h.top<b.pageY&&b.pageY<h.top+e.scrollSensitivity&&(c=g.contents(),f=c.scrollTop(c.scrollTop()-e.scrollSpeed)),h.left<b.pageX&&b.pageX<h.left+h.width&&h.top+h.height-e.scrollSensitivity<b.pageY&&b.pageY<h.top+h.height&&(c=g.contents(),f=c.scrollTop(c.scrollTop()+e.scrollSpeed)),h.left<b.pageX&&b.pageX<h.left+e.scrollSensitivity&&h.top<b.pageY&&b.pageY<h.top+h.height&&(c=g.contents(),f=c.scrollLeft(c.scrollLeft()-e.scrollSpeed)),h.left+h.width-e.scrollSensitivity<b.pageX&&b.pageX<h.left+h.width&&h.top<b.pageY&&b.pageY<h.top+h.height&&(c=g.contents(),f=c.scrollLeft(c.scrollLeft()+e.scrollSpeed)),!1!==f&&a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(d,b),clearTimeout(d.scrollTimer),d._mouseStarted&&(d.scrollTimer=setTimeout(function(){d._trigger("drag",b),a.ui.ddmanager&&a.ui.ddmanager.drag(d,b)},10))})},stop:function(a,b,c){clearInterval(c.scrollTimer)}})}(window.jQuery),function(a,b,c,d){function e(a,b,c){return setTimeout(j(a,c),b)}function f(a,b,c){return!!Array.isArray(a)&&(g(a,c[b],c),!0)}function g(a,b,c){var e;if(a)if(a.forEach)a.forEach(b,c);else if(a.length!==d)for(e=0;e<a.length;)b.call(c,a[e],e,a),e++;else for(e in a)a.hasOwnProperty(e)&&b.call(c,a[e],e,a)}function h(b,c,d){var e="DEPRECATED METHOD: "+c+"\n"+d+" AT \n";return function(){var c=new Error("get-stack-trace"),d=c&&c.stack?c.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",f=a.console&&(a.console.warn||a.console.log);return f&&f.call(a.console,e,d),b.apply(this,arguments)}}function i(a,b,c){var d,e=b.prototype;d=a.prototype=Object.create(e),d.constructor=a,d._super=e,c&&ka(d,c)}function j(a,b){return function(){return a.apply(b,arguments)}}function k(a,b){return typeof a==na?a.apply(b?b[0]||d:d,b):a}function l(a,b){return a===d?b:a}function m(a,b,c){g(q(b),function(b){a.addEventListener(b,c,!1)})}function n(a,b,c){g(q(b),function(b){a.removeEventListener(b,c,!1)})}function o(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function p(a,b){return a.indexOf(b)>-1}function q(a){return a.trim().split(/\s+/g)}function r(a,b,c){if(a.indexOf&&!c)return a.indexOf(b);for(var d=0;d<a.length;){if(c&&a[d][c]==b||!c&&a[d]===b)return d;d++}return-1}function s(a){return Array.prototype.slice.call(a,0)}function t(a,b,c){for(var d=[],e=[],f=0;f<a.length;){var g=b?a[f][b]:a[f];r(e,g)<0&&d.push(a[f]),e[f]=g,f++}return c&&(d=b?d.sort(function(a,c){return a[b]>c[b]}):d.sort()),d}function u(a,b){for(var c,e,f=b[0].toUpperCase()+b.slice(1),g=0;g<la.length;){if(c=la[g],(e=c?c+f:b)in a)return e;g++}return d}function v(){return ta++}function w(b){var c=b.ownerDocument||b;return c.defaultView||c.parentWindow||a}function x(a,b){var c=this;this.manager=a,this.callback=b,this.element=a.element,this.target=a.options.inputTarget,this.domHandler=function(b){k(a.options.enable,[a])&&c.handler(b)},this.init()}function y(a){var b=a.options.inputClass;return new(b||(wa?M:xa?P:va?R:L))(a,z)}function z(a,b,c){var d=c.pointers.length,e=c.changedPointers.length,f=b&Ba&&d-e==0,g=b&(Da|Ea)&&d-e==0;c.isFirst=!!f,c.isFinal=!!g,f&&(a.session={}),c.eventType=b,A(a,c),a.emit("hammer.input",c),a.recognize(c),a.session.prevInput=c}function A(a,b){var c=a.session,d=b.pointers,e=d.length;c.firstInput||(c.firstInput=D(b)),e>1&&!c.firstMultiple?c.firstMultiple=D(b):1===e&&(c.firstMultiple=!1);var f=c.firstInput,g=c.firstMultiple,h=g?g.center:f.center,i=b.center=E(d);b.timeStamp=qa(),b.deltaTime=b.timeStamp-f.timeStamp,b.angle=I(h,i),b.distance=H(h,i),B(c,b),b.offsetDirection=G(b.deltaX,b.deltaY);var j=F(b.deltaTime,b.deltaX,b.deltaY);b.overallVelocityX=j.x,b.overallVelocityY=j.y,b.overallVelocity=pa(j.x)>pa(j.y)?j.x:j.y,b.scale=g?K(g.pointers,d):1,b.rotation=g?J(g.pointers,d):0,b.maxPointers=c.prevInput?b.pointers.length>c.prevInput.maxPointers?b.pointers.length:c.prevInput.maxPointers:b.pointers.length,C(c,b);var k=a.element;o(b.srcEvent.target,k)&&(k=b.srcEvent.target),b.target=k}function B(a,b){var c=b.center,d=a.offsetDelta||{},e=a.prevDelta||{},f=a.prevInput||{};b.eventType!==Ba&&f.eventType!==Da||(e=a.prevDelta={x:f.deltaX||0,y:f.deltaY||0},d=a.offsetDelta={x:c.x,y:c.y}),b.deltaX=e.x+(c.x-d.x),b.deltaY=e.y+(c.y-d.y)}function C(a,b){var c,e,f,g,h=a.lastInterval||b,i=b.timeStamp-h.timeStamp;if(b.eventType!=Ea&&(i>Aa||h.velocity===d)){var j=b.deltaX-h.deltaX,k=b.deltaY-h.deltaY,l=F(i,j,k);e=l.x,f=l.y,c=pa(l.x)>pa(l.y)?l.x:l.y,g=G(j,k),a.lastInterval=b}else c=h.velocity,e=h.velocityX,f=h.velocityY,g=h.direction;b.velocity=c,b.velocityX=e,b.velocityY=f,b.direction=g}function D(a){for(var b=[],c=0;c<a.pointers.length;)b[c]={clientX:oa(a.pointers[c].clientX),clientY:oa(a.pointers[c].clientY)},c++;return{timeStamp:qa(),pointers:b,center:E(b),deltaX:a.deltaX,deltaY:a.deltaY}}function E(a){var b=a.length;if(1===b)return{x:oa(a[0].clientX),y:oa(a[0].clientY)};for(var c=0,d=0,e=0;b>e;)c+=a[e].clientX,d+=a[e].clientY,e++;return{x:oa(c/b),y:oa(d/b)}}function F(a,b,c){return{x:b/a||0,y:c/a||0}}function G(a,b){return a===b?Fa:pa(a)>=pa(b)?0>a?Ga:Ha:0>b?Ia:Ja}function H(a,b,c){c||(c=Na);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return Math.sqrt(d*d+e*e)}function I(a,b,c){c||(c=Na);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return 180*Math.atan2(e,d)/Math.PI}function J(a,b){return I(b[1],b[0],Oa)+I(a[1],a[0],Oa)}function K(a,b){return H(b[0],b[1],Oa)/H(a[0],a[1],Oa)}function L(){this.evEl=Qa,this.evWin=Ra,this.pressed=!1,x.apply(this,arguments)}function M(){this.evEl=Ua,this.evWin=Va,x.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function N(){this.evTarget=Xa,this.evWin=Ya,this.started=!1,x.apply(this,arguments)}function O(a,b){var c=s(a.touches),d=s(a.changedTouches);return b&(Da|Ea)&&(c=t(c.concat(d),"identifier",!0)),[c,d]}function P(){this.evTarget=$a,this.targetIds={},x.apply(this,arguments)}function Q(a,b){var c=s(a.touches),d=this.targetIds;if(b&(Ba|Ca)&&1===c.length)return d[c[0].identifier]=!0,[c,c];var e,f,g=s(a.changedTouches),h=[],i=this.target;if(f=c.filter(function(a){return o(a.target,i)}),b===Ba)for(e=0;e<f.length;)d[f[e].identifier]=!0,e++;for(e=0;e<g.length;)d[g[e].identifier]&&h.push(g[e]),b&(Da|Ea)&&delete d[g[e].identifier],e++;return h.length?[t(f.concat(h),"identifier",!0),h]:void 0}function R(){x.apply(this,arguments);var a=j(this.handler,this);this.touch=new P(this.manager,a),this.mouse=new L(this.manager,a),this.primaryTouch=null,this.lastTouches=[]}function S(a,b){a&Ba?(this.primaryTouch=b.changedPointers[0].identifier,T.call(this,b)):a&(Da|Ea)&&T.call(this,b)}function T(a){var b=a.changedPointers[0];if(b.identifier===this.primaryTouch){var c={x:b.clientX,y:b.clientY};this.lastTouches.push(c);var d=this.lastTouches,e=function(){var a=d.indexOf(c);a>-1&&d.splice(a,1)};setTimeout(e,_a)}}function U(a){for(var b=a.srcEvent.clientX,c=a.srcEvent.clientY,d=0;d<this.lastTouches.length;d++){var e=this.lastTouches[d],f=Math.abs(b-e.x),g=Math.abs(c-e.y);if(ab>=f&&ab>=g)return!0}return!1}function V(a,b){this.manager=a,this.set(b)}function W(a){if(p(a,gb))return gb;var b=p(a,hb),c=p(a,ib);return b&&c?gb:b||c?b?hb:ib:p(a,fb)?fb:eb}function X(a){this.options=ka({},this.defaults,a||{}),this.id=v(),this.manager=null,this.options.enable=l(this.options.enable,!0),this.state=kb,this.simultaneous={},this.requireFail=[]}function Y(a){return a&pb?"cancel":a&nb?"end":a&mb?"move":a&lb?"start":""}function Z(a){return a==Ja?"down":a==Ia?"up":a==Ga?"left":a==Ha?"right":""}function $(a,b){var c=b.manager;return c?c.get(a):a}function _(){X.apply(this,arguments)}function aa(){_.apply(this,arguments),this.pX=null,this.pY=null}function ba(){_.apply(this,arguments)}function ca(){X.apply(this,arguments),this._timer=null,this._input=null}function da(){_.apply(this,arguments)}function ea(){_.apply(this,arguments)}function fa(){X.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ga(a,b){return b=b||{},b.recognizers=l(b.recognizers,ga.defaults.preset),new ha(a,b)}function ha(a,b){this.options=ka({},ga.defaults,b||{}),this.options.inputTarget=this.options.inputTarget||a,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=a,this.input=y(this),this.touchAction=new V(this,this.options.touchAction),ia(this,!0),g(this.options.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]),a[3]&&b.requireFailure(a[3])},this)}function ia(a,b){var c=a.element;if(c.style){var d;g(a.options.cssProps,function(e,f){d=u(c.style,f),b?(a.oldCssProps[d]=c.style[d],c.style[d]=e):c.style[d]=a.oldCssProps[d]||""}),b||(a.oldCssProps={})}}function ja(a,c){var d=b.createEvent("Event");d.initEvent(a,!0,!0),d.gesture=c,c.target.dispatchEvent(d)}var ka,la=["","webkit","Moz","MS","ms","o"],ma=b.createElement("div"),na="function",oa=Math.round,pa=Math.abs,qa=Date.now;ka="function"!=typeof Object.assign?function(a){if(a===d||null===a)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(a),c=1;c<arguments.length;c++){var e=arguments[c];if(e!==d&&null!==e)for(var f in e)e.hasOwnProperty(f)&&(b[f]=e[f])}return b}:Object.assign;var ra=h(function(a,b,c){for(var e=Object.keys(b),f=0;f<e.length;)(!c||c&&a[e[f]]===d)&&(a[e[f]]=b[e[f]]),f++;return a},"extend","Use `assign`."),sa=h(function(a,b){return ra(a,b,!0)},"merge","Use `assign`."),ta=1,ua=/mobile|tablet|ip(ad|hone|od)|android/i,va="ontouchstart"in a,wa=u(a,"PointerEvent")!==d,xa=va&&ua.test(navigator.userAgent),ya="touch",za="mouse",Aa=25,Ba=1,Ca=2,Da=4,Ea=8,Fa=1,Ga=2,Ha=4,Ia=8,Ja=16,Ka=Ga|Ha,La=Ia|Ja,Ma=Ka|La,Na=["x","y"],Oa=["clientX","clientY"];x.prototype={handler:function(){},init:function(){this.evEl&&m(this.element,this.evEl,this.domHandler),this.evTarget&&m(this.target,this.evTarget,this.domHandler),this.evWin&&m(w(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&n(this.element,this.evEl,this.domHandler),this.evTarget&&n(this.target,this.evTarget,this.domHandler),this.evWin&&n(w(this.element),this.evWin,this.domHandler)}};var Pa={mousedown:Ba,mousemove:Ca,mouseup:Da},Qa="mousedown",Ra="mousemove mouseup";i(L,x,{handler:function(a){var b=Pa[a.type];b&Ba&&0===a.button&&(this.pressed=!0),b&Ca&&1!==a.which&&(b=Da),this.pressed&&(b&Da&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:za,srcEvent:a}))}});var Sa={pointerdown:Ba,pointermove:Ca,pointerup:Da,pointercancel:Ea,pointerout:Ea},Ta={2:ya,3:"pen",4:za,5:"kinect"},Ua="pointerdown",Va="pointermove pointerup pointercancel";a.MSPointerEvent&&!a.PointerEvent&&(Ua="MSPointerDown",Va="MSPointerMove MSPointerUp MSPointerCancel"),i(M,x,{handler:function(a){var b=this.store,c=!1,d=a.type.toLowerCase().replace("ms",""),e=Sa[d],f=Ta[a.pointerType]||a.pointerType,g=f==ya,h=r(b,a.pointerId,"pointerId");e&Ba&&(0===a.button||g)?0>h&&(b.push(a),h=b.length-1):e&(Da|Ea)&&(c=!0),0>h||(b[h]=a,this.callback(this.manager,e,{pointers:b,changedPointers:[a],pointerType:f,srcEvent:a}),c&&b.splice(h,1))}});var Wa={touchstart:Ba,touchmove:Ca,touchend:Da,touchcancel:Ea},Xa="touchstart",Ya="touchstart touchmove touchend touchcancel";i(N,x,{handler:function(a){var b=Wa[a.type];if(b===Ba&&(this.started=!0),this.started){var c=O.call(this,a,b);b&(Da|Ea)&&c[0].length-c[1].length==0&&(this.started=!1),this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:ya,srcEvent:a})}}});var Za={touchstart:Ba,touchmove:Ca,touchend:Da,touchcancel:Ea},$a="touchstart touchmove touchend touchcancel";i(P,x,{handler:function(a){var b=Za[a.type],c=Q.call(this,a,b);c&&this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:ya,srcEvent:a})}});var _a=2500,ab=25;i(R,x,{handler:function(a,b,c){var d=c.pointerType==ya,e=c.pointerType==za;if(!(e&&c.sourceCapabilities&&c.sourceCapabilities.firesTouchEvents)){if(d)S.call(this,b,c);else if(e&&U.call(this,c))return;this.callback(a,b,c)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var bb=u(ma.style,"touchAction"),cb=bb!==d,db="compute",eb="auto",fb="manipulation",gb="none",hb="pan-x",ib="pan-y",jb=function(){if(!cb)return!1;var b={},c=a.CSS&&a.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(d){b[d]=!c||a.CSS.supports("touch-action",d)}),b}();V.prototype={set:function(a){a==db&&(a=this.compute()),cb&&this.manager.element.style&&jb[a]&&(this.manager.element.style[bb]=a),this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];return g(this.manager.recognizers,function(b){k(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()))}),W(a.join(" "))},preventDefaults:function(a){var b=a.srcEvent,c=a.offsetDirection;if(this.manager.session.prevented)return void b.preventDefault();var d=this.actions,e=p(d,gb)&&!jb[gb],f=p(d,ib)&&!jb[ib],g=p(d,hb)&&!jb[hb];if(e){var h=1===a.pointers.length,i=a.distance<2,j=a.deltaTime<250;if(h&&i&&j)return}return g&&f?void 0:e||f&&c&Ka||g&&c&La?this.preventSrc(b):void 0},preventSrc:function(a){this.manager.session.prevented=!0,a.preventDefault()}};var kb=1,lb=2,mb=4,nb=8,ob=nb,pb=16;X.prototype={defaults:{},set:function(a){return ka(this.options,a),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(a){if(f(a,"recognizeWith",this))return this;var b=this.simultaneous;return a=$(a,this),b[a.id]||(b[a.id]=a,a.recognizeWith(this)),this},dropRecognizeWith:function(a){return f(a,"dropRecognizeWith",this)?this:(a=$(a,this),delete this.simultaneous[a.id],this)},requireFailure:function(a){if(f(a,"requireFailure",this))return this;var b=this.requireFail;return a=$(a,this),-1===r(b,a)&&(b.push(a),a.requireFailure(this)),this},dropRequireFailure:function(a){if(f(a,"dropRequireFailure",this))return this;a=$(a,this);var b=r(this.requireFail,a);return b>-1&&this.requireFail.splice(b,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function b(b){c.manager.emit(b,a)}var c=this,d=this.state;nb>d&&b(c.options.event+Y(d)),b(c.options.event),a.additionalEvent&&b(a.additionalEvent),d>=nb&&b(c.options.event+Y(d))},tryEmit:function(a){return this.canEmit()?this.emit(a):void(this.state=32)},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(32|kb)))return!1;a++}return!0},recognize:function(a){var b=ka({},a);return k(this.options.enable,[this,b])?(this.state&(ob|pb|32)&&(this.state=kb),this.state=this.process(b),void(this.state&(lb|mb|nb|pb)&&this.tryEmit(b))):(this.reset(),void(this.state=32))},process:function(a){},getTouchAction:function(){},reset:function(){}},i(_,X,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,c=a.eventType,d=b&(lb|mb),e=this.attrTest(a);return d&&(c&Ea||!e)?b|pb:d||e?c&Da?b|nb:b&lb?b|mb:lb:32}}),i(aa,_,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ma},getTouchAction:function(){var a=this.options.direction,b=[];return a&Ka&&b.push(ib),a&La&&b.push(hb),b},directionTest:function(a){var b=this.options,c=!0,d=a.distance,e=a.direction,f=a.deltaX,g=a.deltaY;return e&b.direction||(b.direction&Ka?(e=0===f?Fa:0>f?Ga:Ha,c=f!=this.pX,d=Math.abs(a.deltaX)):(e=0===g?Fa:0>g?Ia:Ja,c=g!=this.pY,d=Math.abs(a.deltaY))),a.direction=e,c&&d>b.threshold&&e&b.direction},attrTest:function(a){return _.prototype.attrTest.call(this,a)&&(this.state&lb||!(this.state&lb)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX,this.pY=a.deltaY;var b=Z(a.direction);b&&(a.additionalEvent=this.options.event+b),this._super.emit.call(this,a)}}),i(ba,_,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[gb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&lb)},emit:function(a){if(1!==a.scale){var b=a.scale<1?"in":"out";a.additionalEvent=this.options.event+b}this._super.emit.call(this,a)}}),i(ca,X,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[eb]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime>b.time;if(this._input=a,!d||!c||a.eventType&(Da|Ea)&&!f)this.reset();else if(a.eventType&Ba)this.reset(),this._timer=e(function(){this.state=ob,this.tryEmit()},b.time,this);else if(a.eventType&Da)return ob;return 32},reset:function(){clearTimeout(this._timer)},emit:function(a){this.state===ob&&(a&&a.eventType&Da?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=qa(),this.manager.emit(this.options.event,this._input)))}}),i(da,_,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[gb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&lb)}}),i(ea,_,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Ka|La,pointers:1},getTouchAction:function(){return aa.prototype.getTouchAction.call(this)},attrTest:function(a){var b,c=this.options.direction;return c&(Ka|La)?b=a.overallVelocity:c&Ka?b=a.overallVelocityX:c&La&&(b=a.overallVelocityY),this._super.attrTest.call(this,a)&&c&a.offsetDirection&&a.distance>this.options.threshold&&a.maxPointers==this.options.pointers&&pa(b)>this.options.velocity&&a.eventType&Da},emit:function(a){var b=Z(a.offsetDirection);b&&this.manager.emit(this.options.event+b,a),this.manager.emit(this.options.event,a)}}),i(fa,X,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[fb]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime<b.time;if(this.reset(),a.eventType&Ba&&0===this.count)return this.failTimeout();if(d&&f&&c){if(a.eventType!=Da)return this.failTimeout();var g=!this.pTime||a.timeStamp-this.pTime<b.interval,h=!this.pCenter||H(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp,this.pCenter=a.center,h&&g?this.count+=1:this.count=1,this._input=a;if(0===this.count%b.taps)return this.hasRequireFailures()?(this._timer=e(function(){this.state=ob,this.tryEmit()},b.interval,this),lb):ob}return 32},failTimeout:function(){return this._timer=e(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ob&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ga.VERSION="2.0.8",ga.defaults={domEvents:!1,touchAction:db,enable:!0,inputTarget:null,inputClass:null,preset:[[da,{enable:!1}],[ba,{enable:!1},["rotate"]],[ea,{direction:Ka}],[aa,{direction:Ka},["swipe"]],[fa],[fa,{event:"doubletap",taps:2},["tap"]],[ca]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};ha.prototype={set:function(a){return ka(this.options,a),a.touchAction&&this.touchAction.update(),a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init()),this},stop:function(a){this.session.stopped=a?2:1},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var c,d=this.recognizers,e=b.curRecognizer;(!e||e&&e.state&ob)&&(e=b.curRecognizer=null);for(var f=0;f<d.length;)c=d[f],2===b.stopped||e&&c!=e&&!c.canRecognizeWith(e)?c.reset():c.recognize(a),!e&&c.state&(lb|mb|nb)&&(e=b.curRecognizer=c),f++}},get:function(a){if(a instanceof X)return a;for(var b=this.recognizers,c=0;c<b.length;c++)if(b[c].options.event==a)return b[c];return null},add:function(a){if(f(a,"add",this))return this;var b=this.get(a.options.event);return b&&this.remove(b),this.recognizers.push(a),a.manager=this,this.touchAction.update(),a},remove:function(a){if(f(a,"remove",this))return this;if(a=this.get(a)){var b=this.recognizers,c=r(b,a)
;-1!==c&&(b.splice(c,1),this.touchAction.update())}return this},on:function(a,b){if(a!==d&&b!==d){var c=this.handlers;return g(q(a),function(a){c[a]=c[a]||[],c[a].push(b)}),this}},off:function(a,b){if(a!==d){var c=this.handlers;return g(q(a),function(a){b?c[a]&&c[a].splice(r(c[a],b),1):delete c[a]}),this}},emit:function(a,b){this.options.domEvents&&ja(a,b);var c=this.handlers[a]&&this.handlers[a].slice();if(c&&c.length){b.type=a,b.preventDefault=function(){b.srcEvent.preventDefault()};for(var d=0;d<c.length;)c[d](b),d++}},destroy:function(){this.element&&ia(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},ka(ga,{INPUT_START:Ba,INPUT_MOVE:Ca,INPUT_END:Da,INPUT_CANCEL:Ea,STATE_POSSIBLE:kb,STATE_BEGAN:lb,STATE_CHANGED:mb,STATE_ENDED:nb,STATE_RECOGNIZED:ob,STATE_CANCELLED:pb,STATE_FAILED:32,DIRECTION_NONE:Fa,DIRECTION_LEFT:Ga,DIRECTION_RIGHT:Ha,DIRECTION_UP:Ia,DIRECTION_DOWN:Ja,DIRECTION_HORIZONTAL:Ka,DIRECTION_VERTICAL:La,DIRECTION_ALL:Ma,Manager:ha,Input:x,TouchAction:V,TouchInput:P,MouseInput:L,PointerEventInput:M,TouchMouseInput:R,SingleTouchInput:N,Recognizer:X,AttrRecognizer:_,Tap:fa,Pan:aa,Swipe:ea,Pinch:ba,Rotate:da,Press:ca,on:m,off:n,each:g,merge:sa,extend:ra,assign:ka,inherit:i,bindFn:j,prefixed:u}),(void 0!==a?a:"undefined"!=typeof self?self:{}).Hammer=ga,"function"==typeof define&&define.amd?define(function(){return ga}):"undefined"!=typeof module&&module.exports?module.exports=ga:a.Hammer=ga}(window,document),void 0===jQuery){var jQuery;jQuery="function"==typeof require?$=require("jquery"):$}if(function(a){a.fn.qoobSelect=function(){a(this).each(function(){var b,c=!1,d=a(this),e=d.children("option"),f=d.find("option:selected").val()||d.find("option:first").val();void 0!==d.find("option:selected").data("icon")?b='<i class="'+d.find("option:selected").data("icon")+'"></i>':(b=d.find("option:selected").html()||d.find("option:first").html()||"",b=b.replace(/"/g,"&quot;"));var g=a('<ul class="qoob-select-dropdown"></ul>');d.wrap('<div class="qoob-select"></div>'),e.length&&e.each(function(){void 0!==a(this).data("title")?g.append(a('<li data-value="'+a(this).val()+'" data-title="'+a(this).data("title")+'"><span>'+a(this).html()+"</span></li>")):void 0!==a(this).data("icon")?g.append(a('<li data-value="'+a(this).val()+'"><i class="'+a(this).data("icon")+'"></i></li>')):g.append(a('<li data-value="'+a(this).val()+'"><span>'+a(this).html()+"</span></li>"))});var h=a("<div />",{class:"qoob-selected-value","data-value":f,tabindex:0}).append(b);d.before(h),h.after(g),g.find("li").each(function(b){a(this).click(function(c){if(!a(this).hasClass("disabled")){g.find("li").removeClass("active"),a(this).toggleClass("active");var e=a(this).data("title")||a(this).html();h.html(e),d.find("option").eq(b).prop("selected",!0),f=a(this).data("value"),g.trigger("close"),d.trigger("change")}c.stopPropagation()})}),h.on("click",function(b){if(g.hasClass("active"))return void g.trigger("close");if(!g.is(":visible")){g.trigger("open");var c=g.find("li").filter(function(){return a(this).data("value").toLowerCase()===f.toLowerCase()});a(c).addClass("selected"),a(c).prependTo(g)}b.stopPropagation()}),g.on({open:function(){a(this).addClass("active"),a(this).slideDown({queue:!1,duration:300,easing:"easeOutCubic"}).animate({opacity:1},{queue:!1,duration:300,easing:"easeOutSine"})},close:function(){a(this).removeClass("active"),g.find(".selected").removeClass("selected"),a(this).fadeOut(225)}}),h.on("blur",function(){g.trigger("close")}),g.hover(function(){c=!0},function(){c=!1}),a(window).on({click:function(){c||g.trigger("close")}})})}}(jQuery),void 0===jQuery){var jQuery;jQuery="function"==typeof require?$=require("jquery"):$}!function(a){a(document).on("click",".qoob-dropdown-toggle",function(b){b.stopPropagation();var c=a(this).parent(".qoob-dropdown"),d=c.find(".qoob-dropdown-content");d.on({show:function(){a(this).slideDown({queue:!1,duration:300,easing:"easeOutCubic"}).css("overflow","visible","important").animate({opacity:1},{queue:!1,duration:300,easing:"easeOutSine"}),c.addClass("active")},hide:function(){a(this).fadeOut(225),c.removeClass("active")}}),d.on("click","a",function(a){d.trigger("hide")}),d.is(":visible")?d.trigger("hide"):d.trigger("show"),c.mouseleave(function(){d.trigger("hide")})})}(jQuery),function(a){var b=/iPhone/i,c=/iPod/i,d=/iPad/i,e=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,f=/Android/i,g=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,h=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,i=/Windows Phone/i,j=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,k=/BlackBerry/i,l=/BB10/i,m=/Opera Mini/i,n=/(CriOS|Chrome)(?=.*\bMobile\b)/i,o=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,p=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),q=function(a,b){return a.test(b)},r=function(a){var r=a||navigator.userAgent,s=r.split("[FBAN");if(void 0!==s[1]&&(r=s[0]),s=r.split("Twitter"),void 0!==s[1]&&(r=s[0]),this.apple={phone:q(b,r),ipod:q(c,r),tablet:!q(b,r)&&q(d,r),device:q(b,r)||q(c,r)||q(d,r)},this.amazon={phone:q(g,r),tablet:!q(g,r)&&q(h,r),device:q(g,r)||q(h,r)},this.android={phone:q(g,r)||q(e,r),tablet:!q(g,r)&&!q(e,r)&&(q(h,r)||q(f,r)),device:q(g,r)||q(h,r)||q(e,r)||q(f,r)},this.windows={phone:q(i,r),tablet:q(j,r),device:q(i,r)||q(j,r)},this.other={blackberry:q(k,r),blackberry10:q(l,r),opera:q(m,r),firefox:q(o,r),chrome:q(n,r),device:q(k,r)||q(l,r)||q(m,r)||q(o,r)||q(n,r)},this.seven_inch=q(p,r),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window)return this},s=function(){var a=new r;return a.Class=r,a};"undefined"!=typeof module&&module.exports&&"undefined"==typeof window?module.exports=r:"undefined"!=typeof module&&module.exports&&"undefined"!=typeof window?module.exports=s():"function"==typeof define&&define.amd?define("isMobile",[],a.isMobile=s()):a.isMobile=s()}(this),function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.html2canvas=a()}}(function(){var a;return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(b,c,d){(function(b){!function(e){function f(a){throw new RangeError(I[a])}function g(a,b){for(var c=a.length,d=[];c--;)d[c]=b(a[c]);return d}function h(a,b){var c=a.split("@"),d="";return c.length>1&&(d=c[0]+"@",a=c[1]),a=a.replace(H,"."),d+g(a.split("."),b).join(".")}function i(a){for(var b,c,d=[],e=0,f=a.length;e<f;)b=a.charCodeAt(e++),b>=55296&&b<=56319&&e<f?(c=a.charCodeAt(e++),56320==(64512&c)?d.push(((1023&b)<<10)+(1023&c)+65536):(d.push(b),e--)):d.push(b);return d}function j(a){return g(a,function(a){var b="";return a>65535&&(a-=65536,b+=L(a>>>10&1023|55296),a=56320|1023&a),b+=L(a)}).join("")}function k(a){return a-48<10?a-22:a-65<26?a-65:a-97<26?a-97:x}function l(a,b){return a+22+75*(a<26)-((0!=b)<<5)}function m(a,b,c){var d=0;for(a=c?K(a/B):a>>1,a+=K(a/b);a>J*z>>1;d+=x)a=K(a/J);return K(d+(J+1)*a/(a+A))}function n(a){var b,c,d,e,g,h,i,l,n,o,p=[],q=a.length,r=0,s=D,t=C;for(c=a.lastIndexOf(E),c<0&&(c=0),d=0;d<c;++d)a.charCodeAt(d)>=128&&f("not-basic"),p.push(a.charCodeAt(d));for(e=c>0?c+1:0;e<q;){for(g=r,h=1,i=x;e>=q&&f("invalid-input"),l=k(a.charCodeAt(e++)),(l>=x||l>K((w-r)/h))&&f("overflow"),r+=l*h,n=i<=t?y:i>=t+z?z:i-t,!(l<n);i+=x)o=x-n,h>K(w/o)&&f("overflow"),h*=o;b=p.length+1,t=m(r-g,b,0==g),K(r/b)>w-s&&f("overflow"),s+=K(r/b),r%=b,p.splice(r++,0,s)}return j(p)}function o(a){var b,c,d,e,g,h,j,k,n,o,p,q,r,s,t,u=[];for(a=i(a),q=a.length,b=D,c=0,g=C,h=0;h<q;++h)(p=a[h])<128&&u.push(L(p));for(d=e=u.length,e&&u.push(E);d<q;){for(j=w,h=0;h<q;++h)(p=a[h])>=b&&p<j&&(j=p);for(r=d+1,j-b>K((w-c)/r)&&f("overflow"),c+=(j-b)*r,b=j,h=0;h<q;++h)if(p=a[h],p<b&&++c>w&&f("overflow"),p==b){for(k=c,n=x;o=n<=g?y:n>=g+z?z:n-g,!(k<o);n+=x)t=k-o,s=x-o,u.push(L(l(o+t%s,0))),k=K(t/s);u.push(L(l(k,0))),g=m(c,r,d==e),c=0,++d}++c,++b}return u.join("")}function p(a){return h(a,function(a){return F.test(a)?n(a.slice(4).toLowerCase()):a})}function q(a){return h(a,function(a){return G.test(a)?"xn--"+o(a):a})}var r="object"==typeof d&&d&&!d.nodeType&&d,s="object"==typeof c&&c&&!c.nodeType&&c,t="object"==typeof b&&b;t.global!==t&&t.window!==t&&t.self!==t||(e=t);var u,v,w=2147483647,x=36,y=1,z=26,A=38,B=700,C=72,D=128,E="-",F=/^xn--/,G=/[^\x20-\x7E]/,H=/[\x2E\u3002\uFF0E\uFF61]/g,I={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},J=x-y,K=Math.floor,L=String.fromCharCode;if(u={version:"1.4.1",ucs2:{decode:i,encode:j},decode:n,encode:o,toASCII:q,toUnicode:p},"function"==typeof a&&"object"==typeof a.amd&&a.amd)a("punycode",function(){return u});else if(r&&s)if(c.exports==r)s.exports=u;else for(v in u)u.hasOwnProperty(v)&&(r[v]=u[v]);else e.punycode=u}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(a,b,c){function d(a,b,c){!a.defaultView||b===a.defaultView.pageXOffset&&c===a.defaultView.pageYOffset||a.defaultView.scrollTo(b,c)}function e(a,b){try{b&&(b.width=a.width,b.height=a.height,b.getContext("2d").putImageData(a.getContext("2d").getImageData(0,0,a.width,a.height),0,0))}catch(b){h("Unable to copy canvas content from",a,b)}}function f(a,b){for(var c=3===a.nodeType?document.createTextNode(a.nodeValue):a.cloneNode(!1),d=a.firstChild;d;)!0!==b&&1===d.nodeType&&"SCRIPT"===d.nodeName||c.appendChild(f(d,b)),d=d.nextSibling;return 1===a.nodeType&&(c._scrollTop=a.scrollTop,c._scrollLeft=a.scrollLeft,"CANVAS"===a.nodeName?e(a,c):"TEXTAREA"!==a.nodeName&&"SELECT"!==a.nodeName||(c.value=a.value)),c}function g(a){if(1===a.nodeType){a.scrollTop=a._scrollTop,a.scrollLeft=a._scrollLeft;for(var b=a.firstChild;b;)g(b),b=b.nextSibling}}var h=a("./log");b.exports=function(a,b,c,e,h,i,j){var k=f(a.documentElement,h.javascriptEnabled),l=b.createElement("iframe");return l.className="html2canvas-container",l.style.visibility="hidden",l.style.position="fixed",l.style.left="-10000px",l.style.top="0px",l.style.border="0",l.width=c,l.height=e,l.scrolling="no",b.body.appendChild(l),new Promise(function(b){var c=l.contentWindow.document;l.contentWindow.onload=l.onload=function(){var a=setInterval(function(){c.body.childNodes.length>0&&(g(c.documentElement),clearInterval(a),"view"===h.type&&(l.contentWindow.scrollTo(i,j),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||l.contentWindow.scrollY===j&&l.contentWindow.scrollX===i||(c.documentElement.style.top=-j+"px",c.documentElement.style.left=-i+"px",c.documentElement.style.position="absolute")),b(l))},50)},c.open(),c.write("<!DOCTYPE html><html></html>"),d(a,i,j),c.replaceChild(c.adoptNode(k),c.documentElement),c.close()})}},{"./log":13}],3:[function(a,b,c){function d(a){this.r=0,this.g=0,this.b=0,this.a=null,this.fromArray(a)||this.namedColor(a)||this.rgb(a)||this.rgba(a)||this.hex6(a)||this.hex3(a)}d.prototype.darken=function(a){var b=1-a;return new d([Math.round(this.r*b),Math.round(this.g*b),Math.round(this.b*b),this.a])},d.prototype.isTransparent=function(){return 0===this.a},d.prototype.isBlack=function(){return 0===this.r&&0===this.g&&0===this.b},d.prototype.fromArray=function(a){return Array.isArray(a)&&(this.r=Math.min(a[0],255),this.g=Math.min(a[1],255),this.b=Math.min(a[2],255),a.length>3&&(this.a=a[3])),Array.isArray(a)};var e=/^#([a-f0-9]{3})$/i;d.prototype.hex3=function(a){var b=null;return null!==(b=a.match(e))&&(this.r=parseInt(b[1][0]+b[1][0],16),this.g=parseInt(b[1][1]+b[1][1],16),this.b=parseInt(b[1][2]+b[1][2],16)),null!==b};var f=/^#([a-f0-9]{6})$/i;d.prototype.hex6=function(a){var b=null;return null!==(b=a.match(f))&&(this.r=parseInt(b[1].substring(0,2),16),this.g=parseInt(b[1].substring(2,4),16),this.b=parseInt(b[1].substring(4,6),16)),null!==b};var g=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/;d.prototype.rgb=function(a){var b=null;return null!==(b=a.match(g))&&(this.r=Number(b[1]),this.g=Number(b[2]),this.b=Number(b[3])),null!==b};var h=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/;d.prototype.rgba=function(a){var b=null;return null!==(b=a.match(h))&&(this.r=Number(b[1]),this.g=Number(b[2]),this.b=Number(b[3]),this.a=Number(b[4])),null!==b},d.prototype.toString=function(){return null!==this.a&&1!==this.a?"rgba("+[this.r,this.g,this.b,this.a].join(",")+")":"rgb("+[this.r,this.g,this.b].join(",")+")"},d.prototype.namedColor=function(a){a=a.toLowerCase();var b=i[a];if(b)this.r=b[0],this.g=b[1],this.b=b[2];else if("transparent"===a)return this.r=this.g=this.b=this.a=0,!0;return!!b},d.prototype.isColor=!0;var i={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};b.exports=d},{}],4:[function(b,c,d){function e(a,b){var c=v++;if(b=b||{},b.logging&&(p.options.logging=!0,p.options.start=Date.now()),b.async=void 0===b.async||b.async,b.allowTaint=void 0!==b.allowTaint&&b.allowTaint,b.removeContainer=void 0===b.removeContainer||b.removeContainer,b.javascriptEnabled=void 0!==b.javascriptEnabled&&b.javascriptEnabled,b.imageTimeout=void 0===b.imageTimeout?1e4:b.imageTimeout,b.renderer="function"==typeof b.renderer?b.renderer:l,b.strict=!!b.strict,"string"==typeof a){if("string"!=typeof b.proxy)return Promise.reject("Proxy must be used when rendering url");var d=null!=b.width?b.width:window.innerWidth,e=null!=b.height?b.height:window.innerHeight;return s(j(a),b.proxy,document,d,e,b).then(function(a){return g(a.contentWindow.document.documentElement,a,b,d,e)})}var h=(void 0===a?[document.documentElement]:a.length?a:[a])[0];return h.setAttribute(u+c,c),f(h.ownerDocument,b,h.ownerDocument.defaultView.innerWidth,h.ownerDocument.defaultView.innerHeight,c).then(function(a){return"function"==typeof b.onrendered&&(p("options.onrendered is deprecated, html2canvas returns a Promise containing the canvas"),b.onrendered(a)),a})}function f(a,b,c,d,e){return r(a,a,c,d,b,a.defaultView.pageXOffset,a.defaultView.pageYOffset).then(function(f){p("Document cloned");var h=u+e,i="["+h+"='"+e+"']";a.querySelector(i).removeAttribute(h);var j=f.contentWindow,k=j.document.querySelector(i);return("function"==typeof b.onclone?Promise.resolve(b.onclone(j.document)):Promise.resolve(!0)).then(function(){return g(k,f,b,c,d)})})}function g(a,b,c,d,e){var f=b.contentWindow,g=new k(f.document),j=new m(c,g),l=t(a),o="view"===c.type?d:l.right+1,q="view"===c.type?e:l.bottom+1,r=new c.renderer(o,q,j,c,document);return new n(a,r,g,j,c).ready.then(function(){p("Finished rendering");var d;if("view"===c.type)d=i(r.canvas,{width:r.canvas.width,height:r.canvas.height,top:0,left:0,x:0,y:0});else if(a===f.document.body||a===f.document.documentElement||null!=c.canvas)d=r.canvas;else if(c.scale){var e={width:null!=c.width?c.width:l.width,height:null!=c.height?c.height:l.height,top:l.top,left:l.left,x:0,y:0},g={};for(var j in e)e.hasOwnProperty(j)&&(g[j]=e[j]*c.scale);d=i(r.canvas,g),d.style.width=e.width+"px",d.style.height=e.height+"px"}else d=i(r.canvas,{width:null!=c.width?c.width:l.width,height:null!=c.height?c.height:l.height,top:l.top,left:l.left,x:0,y:0});return h(b,c),d})}function h(a,b){b.removeContainer&&(a.parentNode.removeChild(a),p("Cleaned up container"))}function i(a,b){var c=document.createElement("canvas"),d=Math.min(a.width-1,Math.max(0,b.left)),e=Math.min(a.width,Math.max(1,b.left+b.width)),f=Math.min(a.height-1,Math.max(0,b.top)),g=Math.min(a.height,Math.max(1,b.top+b.height));c.width=b.width,c.height=b.height;var h=e-d,i=g-f;return p("Cropping canvas at:","left:",b.left,"top:",b.top,"width:",h,"height:",i),p("Resulting crop with width",b.width,"and height",b.height,"with x",d,"and y",f),c.getContext("2d").drawImage(a,d,f,h,i,b.x,b.y,h,i),c}function j(a){var b=document.createElement("a");return b.href=a,b.href=b.href,b}var k=b("./support"),l=b("./renderers/canvas"),m=b("./imageloader"),n=b("./nodeparser"),o=b("./nodecontainer"),p=b("./log"),q=b("./utils"),r=b("./clone"),s=b("./proxy").loadUrlDocument,t=q.getBounds,u="data-html2canvas-node",v=0;e.CanvasRenderer=l,e.NodeContainer=o,e.log=p,e.utils=q;var w="undefined"==typeof document||"function"!=typeof Object.create||"function"!=typeof document.createElement("canvas").getContext?function(){return Promise.reject("No canvas support")}:e;c.exports=w,"function"==typeof a&&a.amd&&a("html2canvas",[],function(){return w})},{"./clone":2,"./imageloader":11,"./log":13,"./nodecontainer":14,"./nodeparser":15,"./proxy":16,"./renderers/canvas":20,"./support":22,"./utils":26}],5:[function(a,b,c){function d(a){if(this.src=a,e("DummyImageContainer for",a),!this.promise||!this.image){e("Initiating DummyImageContainer"),d.prototype.image=new Image;var b=this.image;d.prototype.promise=new Promise(function(a,c){b.onload=a,b.onerror=c,b.src=f(),!0===b.complete&&a(b)})}}var e=a("./log"),f=a("./utils").smallImage;b.exports=d},{"./log":13,"./utils":26}],6:[function(a,b,c){function d(a,b){var c,d,f=document.createElement("div"),g=document.createElement("img"),h=document.createElement("span"),i="Hidden Text";f.style.visibility="hidden",f.style.fontFamily=a,f.style.fontSize=b,f.style.margin=0,f.style.padding=0,document.body.appendChild(f),g.src=e(),g.width=1,g.height=1,g.style.margin=0,g.style.padding=0,g.style.verticalAlign="baseline",h.style.fontFamily=a,h.style.fontSize=b,h.style.margin=0,h.style.padding=0,h.appendChild(document.createTextNode(i)),f.appendChild(h),f.appendChild(g),c=g.offsetTop-h.offsetTop+1,f.removeChild(h),f.appendChild(document.createTextNode(i)),f.style.lineHeight="normal",g.style.verticalAlign="super",d=g.offsetTop-f.offsetTop+1,document.body.removeChild(f),this.baseline=c,this.lineWidth=1,this.middle=d}var e=a("./utils").smallImage;b.exports=d},{"./utils":26}],7:[function(a,b,c){function d(){this.data={}}var e=a("./font");d.prototype.getMetrics=function(a,b){return void 0===this.data[a+"-"+b]&&(this.data[a+"-"+b]=new e(a,b)),this.data[a+"-"+b]},b.exports=d},{"./font":6}],8:[function(a,b,c){function d(b,c,d){this.image=null,this.src=b;var e=this,g=f(b);this.promise=(c?new Promise(function(a){"about:blank"===b.contentWindow.document.URL||null==b.contentWindow.document.documentElement?b.contentWindow.onload=b.onload=function(){a(b)}:a(b)}):this.proxyLoad(d.proxy,g,d)).then(function(b){return a("./core")(b.contentWindow.document.documentElement,{type:"view",width:b.width,height:b.height,proxy:d.proxy,javascriptEnabled:d.javascriptEnabled,removeContainer:d.removeContainer,allowTaint:d.allowTaint,imageTimeout:d.imageTimeout/2})}).then(function(a){return e.image=a})}var e=a("./utils"),f=e.getBounds,g=a("./proxy").loadUrlDocument;d.prototype.proxyLoad=function(a,b,c){var d=this.src;return g(d.src,a,d.ownerDocument,b.width,b.height,c)},b.exports=d},{"./core":4,"./proxy":16,"./utils":26}],9:[function(a,b,c){function d(a){this.src=a.value,this.colorStops=[],this.type=null,this.x0=.5,this.y0=.5,this.x1=.5,this.y1=.5,this.promise=Promise.resolve(!0)}d.TYPES={LINEAR:1,RADIAL:2},d.REGEXP_COLORSTOP=/^\s*(rgba?\(\s*\d{1,3},\s*\d{1,3},\s*\d{1,3}(?:,\s*[0-9\.]+)?\s*\)|[a-z]{3,20}|#[a-f0-9]{3,6})(?:\s+(\d{1,3}(?:\.\d+)?)(%|px)?)?(?:\s|$)/i,b.exports=d},{}],10:[function(a,b,c){function d(a,b){this.src=a,this.image=new Image;var c=this;this.tainted=null,this.promise=new Promise(function(d,e){c.image.onload=d,c.image.onerror=e,b&&(c.image.crossOrigin="anonymous"),c.image.src=a,!0===c.image.complete&&d(c.image)})}b.exports=d},{}],11:[function(a,b,c){function d(a,b){this.link=null,this.options=a,this.support=b,this.origin=this.getOrigin(window.location.href)}var e=a("./log"),f=a("./imagecontainer"),g=a("./dummyimagecontainer"),h=a("./proxyimagecontainer"),i=a("./framecontainer"),j=a("./svgcontainer"),k=a("./svgnodecontainer"),l=a("./lineargradientcontainer"),m=a("./webkitgradientcontainer"),n=a("./utils").bind;d.prototype.findImages=function(a){var b=[];return a.reduce(function(a,b){switch(b.node.nodeName){case"IMG":return a.concat([{args:[b.node.src],method:"url"}]);case"svg":case"IFRAME":return a.concat([{args:[b.node],method:b.node.nodeName}])}return a},[]).forEach(this.addImage(b,this.loadImage),this),b},d.prototype.findBackgroundImage=function(a,b){return b.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(a,this.loadImage),this),a},d.prototype.addImage=function(a,b){return function(c){c.args.forEach(function(d){this.imageExists(a,d)||(a.splice(0,0,b.call(this,c)),e("Added image #"+a.length,"string"==typeof d?d.substring(0,100):d))},this)}},d.prototype.hasImageBackground=function(a){return"none"!==a.method},d.prototype.loadImage=function(a){if("url"===a.method){var b=a.args[0];return!this.isSVG(b)||this.support.svg||this.options.allowTaint?b.match(/data:image\/.*;base64,/i)?new f(b.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),!1):this.isSameOrigin(b)||!0===this.options.allowTaint||this.isSVG(b)?new f(b,!1):this.support.cors&&!this.options.allowTaint&&this.options.useCORS?new f(b,!0):this.options.proxy?new h(b,this.options.proxy):new g(b):new j(b)}return"linear-gradient"===a.method?new l(a):"gradient"===a.method?new m(a):"svg"===a.method?new k(a.args[0],this.support.svg):"IFRAME"===a.method?new i(a.args[0],this.isSameOrigin(a.args[0].src),this.options):new g(a)},d.prototype.isSVG=function(a){return"svg"===a.substring(a.length-3).toLowerCase()||j.prototype.isInline(a)},d.prototype.imageExists=function(a,b){return a.some(function(a){return a.src===b})},d.prototype.isSameOrigin=function(a){return this.getOrigin(a)===this.origin},d.prototype.getOrigin=function(a){var b=this.link||(this.link=document.createElement("a"));return b.href=a,b.href=b.href,b.protocol+b.hostname+b.port},d.prototype.getPromise=function(a){return this.timeout(a,this.options.imageTimeout).catch(function(){return new g(a.src).promise.then(function(b){a.image=b})})},d.prototype.get=function(a){var b=null;return this.images.some(function(c){return(b=c).src===a})?b:null},d.prototype.fetch=function(a){return this.images=a.reduce(n(this.findBackgroundImage,this),this.findImages(a)),this.images.forEach(function(a,b){a.promise.then(function(){e("Succesfully loaded image #"+(b+1),a)},function(c){e("Failed loading image #"+(b+1),a,c)})}),this.ready=Promise.all(this.images.map(this.getPromise,this)),e("Finished searching images"),this},d.prototype.timeout=function(a,b){var c,d=Promise.race([a.promise,new Promise(function(d,f){c=setTimeout(function(){e("Timed out loading image",a),f(a)},b)})]).then(function(a){return clearTimeout(c),a});return d.catch(function(){clearTimeout(c)}),d},b.exports=d},{"./dummyimagecontainer":5,"./framecontainer":8,"./imagecontainer":10,"./lineargradientcontainer":12,"./log":13,"./proxyimagecontainer":17,"./svgcontainer":23,"./svgnodecontainer":24,"./utils":26,"./webkitgradientcontainer":27}],12:[function(a,b,c){function d(a){e.apply(this,arguments),this.type=e.TYPES.LINEAR;var b=d.REGEXP_DIRECTION.test(a.args[0])||!e.REGEXP_COLORSTOP.test(a.args[0]);b?a.args[0].split(/\s+/).reverse().forEach(function(a,b){switch(a){case"left":this.x0=0,this.x1=1;break;case"top":this.y0=0,this.y1=1;break;case"right":this.x0=1,this.x1=0;break;case"bottom":this.y0=1,this.y1=0;break;case"to":var c=this.y0,d=this.x0;this.y0=this.y1,this.x0=this.x1,this.x1=d,this.y1=c;break;case"center":break;default:var e=.01*parseFloat(a,10);if(isNaN(e))break;0===b?(this.y0=e,this.y1=1-this.y0):(this.x0=e,this.x1=1-this.x0)}},this):(this.y0=0,this.y1=1),this.colorStops=a.args.slice(b?1:0).map(function(a){var b=a.match(e.REGEXP_COLORSTOP),c=+b[2],d=0===c?"%":b[3];return{color:new f(b[1]),stop:"%"===d?c/100:null}}),null===this.colorStops[0].stop&&(this.colorStops[0].stop=0),null===this.colorStops[this.colorStops.length-1].stop&&(this.colorStops[this.colorStops.length-1].stop=1),this.colorStops.forEach(function(a,b){null===a.stop&&this.colorStops.slice(b).some(function(c,d){return null!==c.stop&&(a.stop=(c.stop-this.colorStops[b-1].stop)/(d+1)+this.colorStops[b-1].stop,!0)},this)},this)}var e=a("./gradientcontainer"),f=a("./color");d.prototype=Object.create(e.prototype),d.REGEXP_DIRECTION=/^\s*(?:to|left|right|top|bottom|center|\d{1,3}(?:\.\d+)?%?)(?:\s|$)/i,b.exports=d},{"./color":3,"./gradientcontainer":9}],13:[function(a,b,c){var d=function(){d.options.logging&&window.console&&window.console.log&&Function.prototype.bind.call(window.console.log,window.console).apply(window.console,[Date.now()-d.options.start+"ms","html2canvas:"].concat([].slice.call(arguments,0)))};d.options={logging:!1},b.exports=d},{}],14:[function(a,b,c){function d(a,b){this.node=a,this.parent=b,this.stack=null,this.bounds=null,this.borders=null,this.clip=[],this.backgroundClip=[],this.offsetBounds=null,this.visible=null,this.computedStyles=null,this.colors={},this.styles={},this.backgroundImages=null,this.transformData=null,this.transformMatrix=null,this.isPseudoElement=!1,this.opacity=null}function e(a){var b=a.options[a.selectedIndex||0];return b?b.text||"":""}function f(a){if(a&&"matrix"===a[1])return a[2].split(",").map(function(a){return parseFloat(a.trim())});if(a&&"matrix3d"===a[1]){var b=a[2].split(",").map(function(a){return parseFloat(a.trim())});return[b[0],b[1],b[4],b[5],b[12],b[13]]}}function g(a){var b=a[0],c=a[2],d=a[4],e=a[1],f=a[3],g=a[5],h=b*f-c*e;return[f,-e,-c,b,c*g-d*f,d*e-b*g].map(function(a){return a/h})}function h(a){return-1!==a.toString().indexOf("%")}function i(a){return a.replace("px","")}function j(a){return parseFloat(a)}var k=a("./color"),l=a("./utils"),m=l.getBounds,n=l.parseBackgrounds,o=l.offsetBounds;d.prototype.cloneTo=function(a){a.visible=this.visible,a.borders=this.borders,a.bounds=this.bounds,a.clip=this.clip,a.backgroundClip=this.backgroundClip,a.computedStyles=this.computedStyles,a.styles=this.styles,a.backgroundImages=this.backgroundImages,a.opacity=this.opacity},d.prototype.getOpacity=function(){return null===this.opacity?this.opacity=this.cssFloat("opacity"):this.opacity},d.prototype.assignStack=function(a){this.stack=a,a.children.push(this)},d.prototype.isElementVisible=function(){return this.node.nodeType===Node.TEXT_NODE?this.parent.visible:"none"!==this.css("display")&&"hidden"!==this.css("visibility")&&!this.node.hasAttribute("data-html2canvas-ignore")&&("INPUT"!==this.node.nodeName||"hidden"!==this.node.getAttribute("type"))},d.prototype.css=function(a){return this.computedStyles||(this.computedStyles=this.isPseudoElement?this.parent.computedStyle(this.before?":before":":after"):this.computedStyle(null)),this.styles[a]||(this.styles[a]=this.computedStyles[a])},d.prototype.prefixedCss=function(a){var b=["webkit","moz","ms","o"],c=this.css(a);return void 0===c&&b.some(function(b){return void 0!==(c=this.css(b+a.substr(0,1).toUpperCase()+a.substr(1)))},this),void 0===c?null:c},d.prototype.computedStyle=function(a){return this.node.ownerDocument.defaultView.getComputedStyle(this.node,a)},d.prototype.cssInt=function(a){var b=parseInt(this.css(a),10);return isNaN(b)?0:b},d.prototype.color=function(a){return this.colors[a]||(this.colors[a]=new k(this.css(a)))},d.prototype.cssFloat=function(a){var b=parseFloat(this.css(a));return isNaN(b)?0:b},d.prototype.fontWeight=function(){var a=this.css("fontWeight");switch(parseInt(a,10)){case 401:a="bold";break;case 400:a="normal"}return a},d.prototype.parseClip=function(){var a=this.css("clip").match(this.CLIP);return a?{top:parseInt(a[1],10),right:parseInt(a[2],10),bottom:parseInt(a[3],10),left:parseInt(a[4],10)}:null},d.prototype.parseBackgroundImages=function(){return this.backgroundImages||(this.backgroundImages=n(this.css("backgroundImage")))},d.prototype.cssList=function(a,b){var c=(this.css(a)||"").split(",");return c=c[b||0]||c[0]||"auto",c=c.trim().split(" "),1===c.length&&(c=[c[0],h(c[0])?"auto":c[0]]),c},d.prototype.parseBackgroundSize=function(a,b,c){var d,e,f=this.cssList("backgroundSize",c);if(h(f[0]))d=a.width*parseFloat(f[0])/100;else{if(/contain|cover/.test(f[0])){var g=a.width/a.height,i=b.width/b.height;return g<i^"contain"===f[0]?{width:a.height*i,height:a.height}:{width:a.width,height:a.width/i}}
d=parseInt(f[0],10)}return e="auto"===f[0]&&"auto"===f[1]?b.height:"auto"===f[1]?d/b.width*b.height:h(f[1])?a.height*parseFloat(f[1])/100:parseInt(f[1],10),"auto"===f[0]&&(d=e/b.height*b.width),{width:d,height:e}},d.prototype.parseBackgroundPosition=function(a,b,c,d){var e,f,g=this.cssList("backgroundPosition",c);return e=h(g[0])?(a.width-(d||b).width)*(parseFloat(g[0])/100):parseInt(g[0],10),f="auto"===g[1]?e/b.width*b.height:h(g[1])?(a.height-(d||b).height)*parseFloat(g[1])/100:parseInt(g[1],10),"auto"===g[0]&&(e=f/b.height*b.width),{left:e,top:f}},d.prototype.parseBackgroundRepeat=function(a){return this.cssList("backgroundRepeat",a)[0]},d.prototype.parseTextShadows=function(){var a=this.css("textShadow"),b=[];if(a&&"none"!==a)for(var c=a.match(this.TEXT_SHADOW_PROPERTY),d=0;c&&d<c.length;d++){var e=c[d].match(this.TEXT_SHADOW_VALUES);b.push({color:new k(e[0]),offsetX:e[1]?parseFloat(e[1].replace("px","")):0,offsetY:e[2]?parseFloat(e[2].replace("px","")):0,blur:e[3]?e[3].replace("px",""):0})}return b},d.prototype.parseTransform=function(){if(!this.transformData)if(this.hasTransform()){var a=this.parseBounds(),b=this.prefixedCss("transformOrigin").split(" ").map(i).map(j);b[0]+=a.left,b[1]+=a.top,this.transformData={origin:b,matrix:this.parseTransformMatrix()}}else this.transformData={origin:[0,0],matrix:[1,0,0,1,0,0]};return this.transformData},d.prototype.parseTransformMatrix=function(){if(!this.transformMatrix){var a=this.prefixedCss("transform"),b=a?f(a.match(this.MATRIX_PROPERTY)):null;this.transformMatrix=b||[1,0,0,1,0,0]}return this.transformMatrix},d.prototype.inverseTransform=function(){var a=this.parseTransform();return{origin:a.origin,matrix:g(a.matrix)}},d.prototype.parseBounds=function(){return this.bounds||(this.bounds=this.hasTransform()?o(this.node):m(this.node))},d.prototype.hasTransform=function(){return"1,0,0,1,0,0"!==this.parseTransformMatrix().join(",")||this.parent&&this.parent.hasTransform()},d.prototype.getValue=function(){var a=this.node.value||"";return"SELECT"===this.node.tagName?a=e(this.node):"password"===this.node.type&&(a=Array(a.length+1).join("")),0===a.length?this.node.placeholder||"":a},d.prototype.MATRIX_PROPERTY=/(matrix|matrix3d)\((.+)\)/,d.prototype.TEXT_SHADOW_PROPERTY=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g,d.prototype.TEXT_SHADOW_VALUES=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g,d.prototype.CLIP=/^rect\((\d+)px,? (\d+)px,? (\d+)px,? (\d+)px\)$/,b.exports=d},{"./color":3,"./utils":26}],15:[function(a,b,c){function d(a,b,c,d,e){P("Starting NodeParser"),this.renderer=b,this.options=e,this.range=null,this.support=c,this.renderQueue=[],this.stack=new W(!0,1,a.ownerDocument,null);var f=new R(a,null);if(e.background&&b.rectangle(0,0,b.width,b.height,new V(e.background)),a===a.ownerDocument.documentElement){var g=new R(f.color("backgroundColor").isTransparent()?a.ownerDocument.body:a.ownerDocument.documentElement,null);b.rectangle(0,0,b.width,b.height,g.color("backgroundColor"))}f.visibile=f.isElementVisible(),this.createPseudoHideStyles(a.ownerDocument),this.disableAnimations(a.ownerDocument),this.nodes=K([f].concat(this.getChildren(f)).filter(function(a){return a.visible=a.isElementVisible()}).map(this.getPseudoElements,this)),this.fontMetrics=new U,P("Fetched nodes, total:",this.nodes.length),P("Calculate overflow clips"),this.calculateOverflowClips(),P("Start fetching images"),this.images=d.fetch(this.nodes.filter(C)),this.ready=this.images.ready.then(Y(function(){return P("Images loaded, starting parsing"),P("Creating stacking contexts"),this.createStackingContexts(),P("Sorting stacking contexts"),this.sortStackingContexts(this.stack),this.parse(this.stack),P("Render queue created with "+this.renderQueue.length+" items"),new Promise(Y(function(a){e.async?"function"==typeof e.async?e.async.call(this,this.renderQueue,a):this.renderQueue.length>0?(this.renderIndex=0,this.asyncRenderer(this.renderQueue,a)):a():(this.renderQueue.forEach(this.paint,this),a())},this))},this))}function e(a){return a.parent&&a.parent.clip.length}function f(a){return a.replace(/(\-[a-z])/g,function(a){return a.toUpperCase().replace("-","")})}function g(){}function h(a,b,c,d){var e={top:b.top+a[0].width/2,right:b.right-a[1].width/2,bottom:b.bottom-a[2].width/2,left:b.left+a[3].width/2};return a.map(function(f,g){if(f.width>0){var h=b.left,i=b.top,j=b.width,k=b.height-a[2].width;switch(g){case 0:k=a[0].width,f.args=l({c1:[h,i],c2:[h+j,i],c3:[h+j-a[1].width,i+k],c4:[h+a[3].width,i+k]},d[0],d[1],c.topLeftOuter,c.topLeftInner,c.topRightOuter,c.topRightInner),f.pathArgs=m({c1:[e.left,e.top],c2:[e.right,e.top]},d[0],d[1],c.topLeft,c.topRight);break;case 1:h=b.left+b.width-a[1].width,j=a[1].width,f.args=l({c1:[h+j,i],c2:[h+j,i+k+a[2].width],c3:[h,i+k],c4:[h,i+a[0].width]},d[1],d[2],c.topRightOuter,c.topRightInner,c.bottomRightOuter,c.bottomRightInner),f.pathArgs=m({c1:[e.right,e.top],c2:[e.right,e.bottom]},d[1],d[2],c.topRight,c.bottomRight);break;case 2:i=i+b.height-a[2].width,k=a[2].width,f.args=l({c1:[h+j,i+k],c2:[h,i+k],c3:[h+a[3].width,i],c4:[h+j-a[3].width,i]},d[2],d[3],c.bottomRightOuter,c.bottomRightInner,c.bottomLeftOuter,c.bottomLeftInner),f.pathArgs=m({c1:[e.right,e.bottom],c2:[e.left,e.bottom]},d[2],d[3],c.bottomRight,c.bottomLeft);break;case 3:j=a[3].width,f.args=l({c1:[h,i+k+a[2].width],c2:[h,i],c3:[h+j,i+a[0].width],c4:[h+j,i+k]},d[3],d[0],c.bottomLeftOuter,c.bottomLeftInner,c.topLeftOuter,c.topLeftInner),f.pathArgs=m({c1:[e.left,e.bottom],c2:[e.left,e.top]},d[3],d[0],c.bottomLeft,c.topLeft)}}return f})}function i(a,b,c,d){var e=(Math.sqrt(2)-1)/3*4,f=c*e,g=d*e,h=a+c,i=b+d;return{topLeft:k({x:a,y:i},{x:a,y:i-g},{x:h-f,y:b},{x:h,y:b}),topRight:k({x:a,y:b},{x:a+f,y:b},{x:h,y:i-g},{x:h,y:i}),bottomRight:k({x:h,y:b},{x:h,y:b+g},{x:a+f,y:i},{x:a,y:i}),bottomLeft:k({x:h,y:i},{x:h-f,y:i},{x:a,y:b+g},{x:a,y:b})}}function j(a,b,c){var d=a.left,e=a.top,f=a.width,g=a.height,h=b[0][0]<f/2?b[0][0]:f/2,j=b[0][1]<g/2?b[0][1]:g/2,k=b[1][0]<f/2?b[1][0]:f/2,l=b[1][1]<g/2?b[1][1]:g/2,m=b[2][0]<f/2?b[2][0]:f/2,n=b[2][1]<g/2?b[2][1]:g/2,o=b[3][0]<f/2?b[3][0]:f/2,p=b[3][1]<g/2?b[3][1]:g/2,q=f-k,r=g-n,s=f-m,t=g-p;return{topLeft:i(d+c[3].width/2,e+c[0].width/2,Math.max(0,h-c[3].width/2),Math.max(0,j-c[0].width/2)).topLeft.subdivide(.5),topRight:i(d+Math.min(q,f+c[3].width/2),e+c[0].width/2,q>f+c[3].width/2?0:k-c[3].width/2,l-c[0].width/2).topRight.subdivide(.5),bottomRight:i(d+Math.min(s,f-c[3].width/2),e+Math.min(r,g+c[0].width/2),Math.max(0,m-c[1].width/2),n-c[2].width/2).bottomRight.subdivide(.5),bottomLeft:i(d+c[3].width/2,e+t,Math.max(0,o-c[3].width/2),p-c[2].width/2).bottomLeft.subdivide(.5),topLeftOuter:i(d,e,h,j).topLeft.subdivide(.5),topLeftInner:i(d+c[3].width,e+c[0].width,Math.max(0,h-c[3].width),Math.max(0,j-c[0].width)).topLeft.subdivide(.5),topRightOuter:i(d+q,e,k,l).topRight.subdivide(.5),topRightInner:i(d+Math.min(q,f+c[3].width),e+c[0].width,q>f+c[3].width?0:k-c[3].width,l-c[0].width).topRight.subdivide(.5),bottomRightOuter:i(d+s,e+r,m,n).bottomRight.subdivide(.5),bottomRightInner:i(d+Math.min(s,f-c[3].width),e+Math.min(r,g+c[0].width),Math.max(0,m-c[1].width),n-c[2].width).bottomRight.subdivide(.5),bottomLeftOuter:i(d,e+t,o,p).bottomLeft.subdivide(.5),bottomLeftInner:i(d+c[3].width,e+t,Math.max(0,o-c[3].width),p-c[2].width).bottomLeft.subdivide(.5)}}function k(a,b,c,d){var e=function(a,b,c){return{x:a.x+(b.x-a.x)*c,y:a.y+(b.y-a.y)*c}};return{start:a,startControl:b,endControl:c,end:d,subdivide:function(f){var g=e(a,b,f),h=e(b,c,f),i=e(c,d,f),j=e(g,h,f),l=e(h,i,f),m=e(j,l,f);return[k(a,g,j,m),k(m,l,i,d)]},curveTo:function(a){a.push(["bezierCurve",b.x,b.y,c.x,c.y,d.x,d.y])},curveToReversed:function(d){d.push(["bezierCurve",c.x,c.y,b.x,b.y,a.x,a.y])}}}function l(a,b,c,d,e,f,g){var h=[];return b[0]>0||b[1]>0?(h.push(["line",d[1].start.x,d[1].start.y]),d[1].curveTo(h)):h.push(["line",a.c1[0],a.c1[1]]),c[0]>0||c[1]>0?(h.push(["line",f[0].start.x,f[0].start.y]),f[0].curveTo(h),h.push(["line",g[0].end.x,g[0].end.y]),g[0].curveToReversed(h)):(h.push(["line",a.c2[0],a.c2[1]]),h.push(["line",a.c3[0],a.c3[1]])),b[0]>0||b[1]>0?(h.push(["line",e[1].end.x,e[1].end.y]),e[1].curveToReversed(h)):h.push(["line",a.c4[0],a.c4[1]]),h}function m(a,b,c,d,e){var f=[];return b[0]>0||b[1]>0?(f.push(["line",d[1].start.x,d[1].start.y]),d[1].curveTo(f)):f.push(["line",a.c1[0],a.c1[1]]),c[0]>0||c[1]>0?(f.push(["line",e[0].start.x,e[0].start.y]),e[0].curveTo(f)):f.push(["line",a.c2[0],a.c2[1]]),f}function n(a,b,c,d,e,f,g){b[0]>0||b[1]>0?(a.push(["line",d[0].start.x,d[0].start.y]),d[0].curveTo(a),d[1].curveTo(a)):a.push(["line",f,g]),(c[0]>0||c[1]>0)&&a.push(["line",e[0].start.x,e[0].start.y])}function o(a){return a.cssInt("zIndex")<0}function p(a){return a.cssInt("zIndex")>0}function q(a){return 0===a.cssInt("zIndex")}function r(a){return-1!==["inline","inline-block","inline-table"].indexOf(a.css("display"))}function s(a){return a instanceof W}function t(a){return a.node.data.trim().length>0}function u(a){return/^(normal|none|0px)$/.test(a.parent.css("letterSpacing"))}function v(a){return["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(b){var c=a.css("border"+b+"Radius"),d=c.split(" ");return d.length<=1&&(d[1]=d[0]),d.map(H)})}function w(a){return a.nodeType===Node.TEXT_NODE||a.nodeType===Node.ELEMENT_NODE}function x(a){return"auto"!==(-1!==["absolute","relative","fixed"].indexOf(a.css("position"))?a.css("zIndex"):"auto")}function y(a){return"static"!==a.css("position")}function z(a){return"none"!==a.css("float")}function A(a){return-1!==["inline-block","inline-table"].indexOf(a.css("display"))}function B(a){var b=this;return function(){return!a.apply(b,arguments)}}function C(a){return a.node.nodeType===Node.ELEMENT_NODE}function D(a){return!0===a.isPseudoElement}function E(a){return a.node.nodeType===Node.TEXT_NODE}function F(a){return function(b,c){return b.cssInt("zIndex")+a.indexOf(b)/a.length-(c.cssInt("zIndex")+a.indexOf(c)/a.length)}}function G(a){return a.getOpacity()<1}function H(a){return parseInt(a,10)}function I(a){return a.width}function J(a){return a.node.nodeType!==Node.ELEMENT_NODE||-1===["SCRIPT","HEAD","TITLE","OBJECT","BR","OPTION"].indexOf(a.node.nodeName)}function K(a){return[].concat.apply([],a)}function L(a){var b=a.substr(0,1);return b===a.substr(a.length-1)&&b.match(/'|"/)?a.substr(1,a.length-2):a}function M(a){for(var b,c=[],d=0,e=!1;a.length;)N(a[d])===e?(b=a.splice(0,d),b.length&&c.push(Q.ucs2.encode(b)),e=!e,d=0):d++,d>=a.length&&(b=a.splice(0,d),b.length&&c.push(Q.ucs2.encode(b)));return c}function N(a){return-1!==[32,13,10,9,45].indexOf(a)}function O(a){return/[^\u0000-\u00ff]/.test(a)}var P=a("./log"),Q=a("punycode"),R=a("./nodecontainer"),S=a("./textcontainer"),T=a("./pseudoelementcontainer"),U=a("./fontmetrics"),V=a("./color"),W=a("./stackingcontext"),X=a("./utils"),Y=X.bind,Z=X.getBounds,$=X.parseBackgrounds,_=X.offsetBounds;d.prototype.calculateOverflowClips=function(){this.nodes.forEach(function(a){if(C(a)){D(a)&&a.appendToDOM(),a.borders=this.parseBorders(a);var b="hidden"===a.css("overflow")?[a.borders.clip]:[],c=a.parseClip();c&&-1!==["absolute","fixed"].indexOf(a.css("position"))&&b.push([["rect",a.bounds.left+c.left,a.bounds.top+c.top,c.right-c.left,c.bottom-c.top]]),a.clip=e(a)?a.parent.clip.concat(b):b,a.backgroundClip="hidden"!==a.css("overflow")?a.clip.concat([a.borders.clip]):a.clip,D(a)&&a.cleanDOM()}else E(a)&&(a.clip=e(a)?a.parent.clip:[]);D(a)||(a.bounds=null)},this)},d.prototype.asyncRenderer=function(a,b,c){c=c||Date.now(),this.paint(a[this.renderIndex++]),a.length===this.renderIndex?b():c+20>Date.now()?this.asyncRenderer(a,b,c):setTimeout(Y(function(){this.asyncRenderer(a,b)},this),0)},d.prototype.createPseudoHideStyles=function(a){this.createStyles(a,"."+T.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+':before { content: "" !important; display: none !important; }.'+T.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER+':after { content: "" !important; display: none !important; }')},d.prototype.disableAnimations=function(a){this.createStyles(a,"* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; -webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}")},d.prototype.createStyles=function(a,b){var c=a.createElement("style");c.innerHTML=b,a.body.appendChild(c)},d.prototype.getPseudoElements=function(a){var b=[[a]];if(a.node.nodeType===Node.ELEMENT_NODE){var c=this.getPseudoElement(a,":before"),d=this.getPseudoElement(a,":after");c&&b.push(c),d&&b.push(d)}return K(b)},d.prototype.getPseudoElement=function(a,b){var c=a.computedStyle(b);if(!c||!c.content||"none"===c.content||"-moz-alt-content"===c.content||"none"===c.display)return null;for(var d=L(c.content),e="url"===d.substr(0,3),g=document.createElement(e?"img":"html2canvaspseudoelement"),h=new T(g,a,b),i=c.length-1;i>=0;i--){var j=f(c.item(i));g.style[j]=c[j]}if(g.className=T.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+" "+T.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER,e)return g.src=$(d)[0].args[0],[h];var k=document.createTextNode(d);return g.appendChild(k),[h,new S(k,h)]},d.prototype.getChildren=function(a){return K([].filter.call(a.node.childNodes,w).map(function(b){var c=[b.nodeType===Node.TEXT_NODE?new S(b,a):new R(b,a)].filter(J);return b.nodeType===Node.ELEMENT_NODE&&c.length&&"TEXTAREA"!==b.tagName?c[0].isElementVisible()?c.concat(this.getChildren(c[0])):[]:c},this))},d.prototype.newStackingContext=function(a,b){var c=new W(b,a.getOpacity(),a.node,a.parent);a.cloneTo(c),(b?c.getParentStack(this):c.parent.stack).contexts.push(c),a.stack=c},d.prototype.createStackingContexts=function(){this.nodes.forEach(function(a){C(a)&&(this.isRootElement(a)||G(a)||x(a)||this.isBodyWithTransparentRoot(a)||a.hasTransform())?this.newStackingContext(a,!0):C(a)&&(y(a)&&q(a)||A(a)||z(a))?this.newStackingContext(a,!1):a.assignStack(a.parent.stack)},this)},d.prototype.isBodyWithTransparentRoot=function(a){return"BODY"===a.node.nodeName&&a.parent.color("backgroundColor").isTransparent()},d.prototype.isRootElement=function(a){return null===a.parent},d.prototype.sortStackingContexts=function(a){a.contexts.sort(F(a.contexts.slice(0))),a.contexts.forEach(this.sortStackingContexts,this)},d.prototype.parseTextBounds=function(a){return function(b,c,d){if("none"!==a.parent.css("textDecoration").substr(0,4)||0!==b.trim().length){if(this.support.rangeBounds&&!a.parent.hasTransform()){var e=d.slice(0,c).join("").length;return this.getRangeBounds(a.node,e,b.length)}if(a.node&&"string"==typeof a.node.data){var f=a.node.splitText(b.length),g=this.getWrapperBounds(a.node,a.parent.hasTransform());return a.node=f,g}}else this.support.rangeBounds&&!a.parent.hasTransform()||(a.node=a.node.splitText(b.length));return{}}},d.prototype.getWrapperBounds=function(a,b){var c=a.ownerDocument.createElement("html2canvaswrapper"),d=a.parentNode,e=a.cloneNode(!0);c.appendChild(a.cloneNode(!0)),d.replaceChild(c,a);var f=b?_(c):Z(c);return d.replaceChild(e,c),f},d.prototype.getRangeBounds=function(a,b,c){var d=this.range||(this.range=a.ownerDocument.createRange());return d.setStart(a,b),d.setEnd(a,b+c),d.getBoundingClientRect()},d.prototype.parse=function(a){var b=a.contexts.filter(o),c=a.children.filter(C),d=c.filter(B(z)),e=d.filter(B(y)).filter(B(r)),f=c.filter(B(y)).filter(z),h=d.filter(B(y)).filter(r),i=a.contexts.concat(d.filter(y)).filter(q),j=a.children.filter(E).filter(t),k=a.contexts.filter(p);b.concat(e).concat(f).concat(h).concat(i).concat(j).concat(k).forEach(function(a){this.renderQueue.push(a),s(a)&&(this.parse(a),this.renderQueue.push(new g))},this)},d.prototype.paint=function(a){try{a instanceof g?this.renderer.ctx.restore():E(a)?(D(a.parent)&&a.parent.appendToDOM(),this.paintText(a),D(a.parent)&&a.parent.cleanDOM()):this.paintNode(a)}catch(a){if(P(a),this.options.strict)throw a}},d.prototype.paintNode=function(a){s(a)&&(this.renderer.setOpacity(a.opacity),this.renderer.ctx.save(),a.hasTransform()&&this.renderer.setTransform(a.parseTransform())),"INPUT"===a.node.nodeName&&"checkbox"===a.node.type?this.paintCheckbox(a):"INPUT"===a.node.nodeName&&"radio"===a.node.type?this.paintRadio(a):this.paintElement(a)},d.prototype.paintElement=function(a){var b=a.parseBounds();this.renderer.clip(a.backgroundClip,function(){this.renderer.renderBackground(a,b,a.borders.borders.map(I))},this,a),this.renderer.mask(a.backgroundClip,function(){this.renderer.renderShadows(a,a.borders.clip)},this,a),this.renderer.clip(a.clip,function(){this.renderer.renderBorders(a.borders.borders)},this,a),this.renderer.clip(a.backgroundClip,function(){switch(a.node.nodeName){case"svg":case"IFRAME":var c=this.images.get(a.node);c?this.renderer.renderImage(a,b,a.borders,c):P("Error loading <"+a.node.nodeName+">",a.node);break;case"IMG":var d=this.images.get(a.node.src);d?this.renderer.renderImage(a,b,a.borders,d):P("Error loading <img>",a.node.src);break;case"CANVAS":this.renderer.renderImage(a,b,a.borders,{image:a.node});break;case"SELECT":case"INPUT":case"TEXTAREA":this.paintFormValue(a)}},this,a)},d.prototype.paintCheckbox=function(a){var b=a.parseBounds(),c=Math.min(b.width,b.height),d={width:c-1,height:c-1,top:b.top,left:b.left},e=[3,3],f=[e,e,e,e],g=[1,1,1,1].map(function(a){return{color:new V("#A5A5A5"),width:a}}),i=j(d,f,g);this.renderer.clip(a.backgroundClip,function(){this.renderer.rectangle(d.left+1,d.top+1,d.width-2,d.height-2,new V("#DEDEDE")),this.renderer.renderBorders(h(g,d,i,f)),a.node.checked&&(this.renderer.font(new V("#424242"),"normal","normal","bold",c-3+"px","arial"),this.renderer.text("",d.left+c/6,d.top+c-1))},this,a)},d.prototype.paintRadio=function(a){var b=a.parseBounds(),c=Math.min(b.width,b.height)-2;this.renderer.clip(a.backgroundClip,function(){this.renderer.circleStroke(b.left+1,b.top+1,c,new V("#DEDEDE"),1,new V("#A5A5A5")),a.node.checked&&this.renderer.circle(Math.ceil(b.left+c/4)+1,Math.ceil(b.top+c/4)+1,Math.floor(c/2),new V("#424242"))},this,a)},d.prototype.paintFormValue=function(a){var b=a.getValue();if(b.length>0){var c=a.node.ownerDocument,d=c.createElement("html2canvaswrapper");["lineHeight","textAlign","fontFamily","fontWeight","fontSize","color","paddingLeft","paddingTop","paddingRight","paddingBottom","width","height","borderLeftStyle","borderTopStyle","borderLeftWidth","borderTopWidth","boxSizing","whiteSpace","wordWrap"].forEach(function(b){try{d.style[b]=a.css(b)}catch(a){P("html2canvas: Parse: Exception caught in renderFormValue: "+a.message)}});var e=a.parseBounds();d.style.position="fixed",d.style.left=e.left+"px",d.style.top=e.top+"px",d.textContent=b,c.body.appendChild(d),this.paintText(new S(d.firstChild,a)),c.body.removeChild(d)}},d.prototype.paintText=function(a){a.applyTextTransform();var b=Q.ucs2.decode(a.node.data),c=(!this.options.letterRendering||u(a))&&!O(a.node.data),d=c?M(b):b.map(function(a){return Q.ucs2.encode([a])});c||(a.parent.node.style.fontVariantLigatures="none");var e=a.parent.fontWeight(),f=a.parent.css("fontSize"),g=a.parent.css("fontFamily"),h=a.parent.parseTextShadows();this.renderer.font(a.parent.color("color"),a.parent.css("fontStyle"),a.parent.css("fontVariant"),e,f,g),h.length?this.renderer.fontShadow(h[0].color,h[0].offsetX,h[0].offsetY,h[0].blur):this.renderer.clearShadow(),this.renderer.clip(a.parent.clip,function(){d.map(this.parseTextBounds(a),this).forEach(function(b,c){b&&(this.renderer.text(d[c],b.left,b.bottom),this.renderTextDecoration(a.parent,b,this.fontMetrics.getMetrics(g,f)))},this)},this,a.parent)},d.prototype.renderTextDecoration=function(a,b,c){switch(a.css("textDecoration").split(" ")[0]){case"underline":this.renderer.rectangle(b.left,Math.round(b.top+c.baseline+c.lineWidth),b.width,1,a.color("color"));break;case"overline":this.renderer.rectangle(b.left,Math.round(b.top),b.width,1,a.color("color"));break;case"line-through":this.renderer.rectangle(b.left,Math.ceil(b.top+c.middle+c.lineWidth),b.width,1,a.color("color"))}};var aa={inset:[["darken",.6],["darken",.1],["darken",.1],["darken",.6]]};d.prototype.parseBorders=function(a){var b=a.parseBounds(),c=v(a),d=["Top","Right","Bottom","Left"].map(function(b,c){var d=a.css("border"+b+"Style"),e=a.color("border"+b+"Color");"inset"===d&&e.isBlack()&&(e=new V([255,255,255,e.a]));var f=aa[d]?aa[d][c]:null;return{width:a.cssInt("border"+b+"Width"),color:f?e[f[0]](f[1]):e,style:d,pathArgs:null,args:null}}),e=j(b,c,d);return{clip:this.parseBackgroundClip(a,e,d,c,b),borders:h(d,b,e,c)}},d.prototype.parseBackgroundClip=function(a,b,c,d,e){var f=a.css("backgroundClip"),g=[];switch(f){case"content-box":case"padding-box":n(g,d[0],d[1],b.topLeftInner,b.topRightInner,e.left+c[3].width,e.top+c[0].width),n(g,d[1],d[2],b.topRightInner,b.bottomRightInner,e.left+e.width-c[1].width,e.top+c[0].width),n(g,d[2],d[3],b.bottomRightInner,b.bottomLeftInner,e.left+e.width-c[1].width,e.top+e.height-c[2].width),n(g,d[3],d[0],b.bottomLeftInner,b.topLeftInner,e.left+c[3].width,e.top+e.height-c[2].width);break;default:n(g,d[0],d[1],b.topLeftOuter,b.topRightOuter,e.left,e.top),n(g,d[1],d[2],b.topRightOuter,b.bottomRightOuter,e.left+e.width,e.top),n(g,d[2],d[3],b.bottomRightOuter,b.bottomLeftOuter,e.left+e.width,e.top+e.height),n(g,d[3],d[0],b.bottomLeftOuter,b.topLeftOuter,e.left,e.top+e.height)}return g},b.exports=d},{"./color":3,"./fontmetrics":7,"./log":13,"./nodecontainer":14,"./pseudoelementcontainer":18,"./stackingcontext":21,"./textcontainer":25,"./utils":26,punycode:1}],16:[function(a,b,c){function d(a,b,c){var d="withCredentials"in new XMLHttpRequest;if(!b)return Promise.reject("No proxy configured");var e=g(d),i=h(b,a,e);return d?k(i):f(c,i,e).then(function(a){return o(a.content)})}function e(a,b,c){var d="crossOrigin"in new Image,e=g(d),i=h(b,a,e);return d?Promise.resolve(i):f(c,i,e).then(function(a){return"data:"+a.type+";base64,"+a.content})}function f(a,b,c){return new Promise(function(d,e){var f=a.createElement("script"),g=function(){delete window.html2canvas.proxy[c],a.body.removeChild(f)};window.html2canvas.proxy[c]=function(a){g(),d(a)},f.src=b,f.onerror=function(a){g(),e(a)},a.body.appendChild(f)})}function g(a){return a?"":"html2canvas_"+Date.now()+"_"+ ++p+"_"+Math.round(1e5*Math.random())}function h(a,b,c){return a+"?url="+encodeURIComponent(b)+(c.length?"&callback=html2canvas.proxy."+c:"")}function i(a){return function(b){var c,d=new DOMParser;try{c=d.parseFromString(b,"text/html")}catch(a){m("DOMParser not supported, falling back to createHTMLDocument"),c=document.implementation.createHTMLDocument("");try{c.open(),c.write(b),c.close()}catch(a){m("createHTMLDocument write not supported, falling back to document.body.innerHTML"),c.body.innerHTML=b}}var e=c.querySelector("base");if(!e||!e.href.host){var f=c.createElement("base");f.href=a,c.head.insertBefore(f,c.head.firstChild)}return c}}function j(a,b,c,e,f,g){return new d(a,b,window.document).then(i(a)).then(function(a){return n(a,c,e,f,g,0,0)})}var k=a("./xhr"),l=a("./utils"),m=a("./log"),n=a("./clone"),o=l.decode64,p=0;c.Proxy=d,c.ProxyURL=e,c.loadUrlDocument=j},{"./clone":2,"./log":13,"./utils":26,"./xhr":28}],17:[function(a,b,c){function d(a,b){var c=document.createElement("a");c.href=a,a=c.href,this.src=a,this.image=new Image;var d=this;this.promise=new Promise(function(c,f){d.image.crossOrigin="Anonymous",d.image.onload=c,d.image.onerror=f,new e(a,b,document).then(function(a){d.image.src=a}).catch(f)})}var e=a("./proxy").ProxyURL;b.exports=d},{"./proxy":16}],18:[function(a,b,c){function d(a,b,c){e.call(this,a,b),this.isPseudoElement=!0,this.before=":before"===c}var e=a("./nodecontainer");d.prototype.cloneTo=function(a){d.prototype.cloneTo.call(this,a),a.isPseudoElement=!0,a.before=this.before},d.prototype=Object.create(e.prototype),d.prototype.appendToDOM=function(){this.before?this.parent.node.insertBefore(this.node,this.parent.node.firstChild):this.parent.node.appendChild(this.node),this.parent.node.className+=" "+this.getHideClass()},d.prototype.cleanDOM=function(){this.node.parentNode.removeChild(this.node),this.parent.node.className=this.parent.node.className.replace(this.getHideClass(),"")},d.prototype.getHideClass=function(){return this["PSEUDO_HIDE_ELEMENT_CLASS_"+(this.before?"BEFORE":"AFTER")]},d.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE="___html2canvas___pseudoelement_before",d.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER="___html2canvas___pseudoelement_after",b.exports=d},{"./nodecontainer":14}],19:[function(a,b,c){function d(a,b,c,d,e){this.width=a,this.height=b,this.images=c,this.options=d,this.document=e}var e=a("./log");d.prototype.renderImage=function(a,b,c,d){var e=a.cssInt("paddingLeft"),f=a.cssInt("paddingTop"),g=a.cssInt("paddingRight"),h=a.cssInt("paddingBottom"),i=c.borders,j=b.width-(i[1].width+i[3].width+e+g),k=b.height-(i[0].width+i[2].width+f+h);this.drawImage(d,0,0,d.image.width||j,d.image.height||k,b.left+e+i[3].width,b.top+f+i[0].width,j,k)},d.prototype.renderBackground=function(a,b,c){b.height>0&&b.width>0&&(this.renderBackgroundColor(a,b),this.renderBackgroundImage(a,b,c))},d.prototype.renderBackgroundColor=function(a,b){var c=a.color("backgroundColor");c.isTransparent()||this.rectangle(b.left,b.top,b.width,b.height,c)},d.prototype.renderShadows=function(a,b){var c=a.css("boxShadow");if("none"!==c){var d=c.split(/,(?![^(]*\))/);this.shadow(b,d)}},d.prototype.renderBorders=function(a){a.forEach(this.renderBorder,this)},d.prototype.renderBorder=function(a){if(!a.color.isTransparent()&&null!==a.args)if("dashed"===a.style||"dotted"===a.style){var b="dashed"===a.style?3:a.width;this.ctx.setLineDash([b]),this.path(a.pathArgs),this.ctx.strokeStyle=a.color,this.ctx.lineWidth=a.width,this.ctx.stroke()}else this.drawShape(a.args,a.color)},d.prototype.renderBackgroundImage=function(a,b,c){a.parseBackgroundImages().reverse().forEach(function(d,f,g){switch(d.method){case"url":var h=this.images.get(d.args[0]);h?this.renderBackgroundRepeating(a,b,h,g.length-(f+1),c):e("Error loading background-image",d.args[0]);break;case"linear-gradient":case"gradient":var i=this.images.get(d.value);i?this.renderBackgroundGradient(i,b,c):e("Error loading background-image",d.args[0]);break;case"none":break;default:e("Unknown background-image type",d.args[0])}},this)},d.prototype.renderBackgroundRepeating=function(a,b,c,d,e){var f=a.parseBackgroundSize(b,c.image,d),g=a.parseBackgroundPosition(b,c.image,d,f);switch(a.parseBackgroundRepeat(d)){case"repeat-x":case"repeat no-repeat":this.backgroundRepeatShape(c,g,f,b,b.left+e[3],b.top+g.top+e[0],99999,f.height,e);break;case"repeat-y":case"no-repeat repeat":this.backgroundRepeatShape(c,g,f,b,b.left+g.left+e[3],b.top+e[0],f.width,99999,e);break;case"no-repeat":this.backgroundRepeatShape(c,g,f,b,b.left+g.left+e[3],b.top+g.top+e[0],f.width,f.height,e);break;default:this.renderBackgroundRepeat(c,g,f,{top:b.top,left:b.left},e[3],e[0])}},b.exports=d},{"./log":13}],20:[function(a,b,c){function d(a,b){f.apply(this,arguments),this.canvas=this.options.canvas||this.document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.options.canvas||(this.options.dpi&&(this.options.scale=this.options.dpi/96),this.options.scale?(this.canvas.style.width=a+"px",this.canvas.style.height=b+"px",this.canvas.width=Math.floor(a*this.options.scale),this.canvas.height=Math.floor(b*this.options.scale),this.ctx.scale(this.options.scale,this.options.scale)):(this.canvas.width=a,this.canvas.height=b)),this.taintCtx=this.document.createElement("canvas").getContext("2d"),this.ctx.textBaseline="bottom",this.variables={},h("Initialized CanvasRenderer with size",a,"x",b)}function e(a){return a.length>0}var f=a("../renderer"),g=a("../lineargradientcontainer"),h=a("../log");d.prototype=Object.create(f.prototype),d.prototype.setFillStyle=function(a){return this.ctx.fillStyle="object"==typeof a&&a.isColor?a.toString():a,this.ctx},d.prototype.rectangle=function(a,b,c,d,e){this.setFillStyle(e).fillRect(a,b,c,d)},d.prototype.circle=function(a,b,c,d){this.setFillStyle(d),this.ctx.beginPath(),this.ctx.arc(a+c/2,b+c/2,c/2,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()},d.prototype.circleStroke=function(a,b,c,d,e,f){this.circle(a,b,c,d),this.ctx.strokeStyle=f.toString(),this.ctx.stroke()},d.prototype.shadow=function(a,b){var c=function(a){var b={color:/^(#|rgb|hsl|(?!(inset|initial|inherit))\D+)/i,inset:/^inset/i,px:/px$/i},c=["x","y","blur","spread"],d=a.split(/ (?![^(]*\))/),e={};for(var f in b)e[f]=d.filter(b[f].test.bind(b[f])),e[f]=0===e[f].length?null:1===e[f].length?e[f][0]:e[f];for(var g=0;g<e.px.length;g++)e[c[g]]=parseInt(e.px[g]);return e},d=function(a){var b=c(a);b.inset||(e.shadowOffsetX=b.x,e.shadowOffsetY=b.y,e.shadowColor=b.color,e.shadowBlur=b.blur,e.fill())},e=this.setFillStyle("white");e.save(),this.shape(a),b.forEach(d,this),e.restore()},d.prototype.drawShape=function(a,b){this.shape(a),this.setFillStyle(b).fill()},d.prototype.taints=function(a){if(null===a.tainted){this.taintCtx.drawImage(a.image,0,0);try{this.taintCtx.getImageData(0,0,1,1),a.tainted=!1}catch(b){this.taintCtx=document.createElement("canvas").getContext("2d"),a.tainted=!0}}return a.tainted},d.prototype.drawImage=function(a,b,c,d,e,f,g,h,i){this.taints(a)&&!this.options.allowTaint||this.ctx.drawImage(a.image,b,c,d,e,f,g,h,i)},d.prototype.clip=function(a,b,c,d){this.ctx.save(),d&&d.hasTransform()?(this.setTransform(d.inverseTransform()),a.filter(e).forEach(function(a){this.shape(a).clip()},this),this.setTransform(d.parseTransform())):a.filter(e).forEach(function(a){this.shape(a).clip()},this),b.call(c),this.ctx.restore()},d.prototype.mask=function(a,b,c,d){var e=a[a.length-1];if(e&&e.length){var f=["rect",this.canvas.width,0,-this.canvas.width,this.canvas.height],g=[f].concat(e).concat([e[0]]);a=a.slice(0,-1).concat([g])}this.clip(a,b,c,d)},d.prototype.shape=function(a){return this.ctx.beginPath(),a.forEach(function(a,b){"rect"===a[0]?this.ctx.rect.apply(this.ctx,a.slice(1)):this.ctx[0===b?"moveTo":a[0]+"To"].apply(this.ctx,a.slice(1))},this),this.ctx.closePath(),this.ctx},d.prototype.path=function(a){return this.ctx.beginPath(),a.forEach(function(a,b){"rect"===a[0]?this.ctx.rect.apply(this.ctx,a.slice(1)):this.ctx[0===b?"moveTo":a[0]+"To"].apply(this.ctx,a.slice(1))},this),this.ctx},d.prototype.font=function(a,b,c,d,e,f){c=/^(normal|small-caps)$/i.test(c)?c:"",this.setFillStyle(a).font=[b,c,d,e,f].join(" ").split(",")[0]},d.prototype.fontShadow=function(a,b,c,d){this.setVariable("shadowColor",a.toString()).setVariable("shadowOffsetY",b).setVariable("shadowOffsetX",c).setVariable("shadowBlur",d)},d.prototype.clearShadow=function(){this.setVariable("shadowColor","rgba(0,0,0,0)")},d.prototype.setOpacity=function(a){this.ctx.globalAlpha=a},d.prototype.setTransform=function(a){this.ctx.translate(a.origin[0],a.origin[1]),this.ctx.transform.apply(this.ctx,a.matrix),this.ctx.translate(-a.origin[0],-a.origin[1])},d.prototype.setVariable=function(a,b){return this.variables[a]!==b&&(this.variables[a]=this.ctx[a]=b),this},d.prototype.text=function(a,b,c){this.ctx.fillText(a,b,c)},d.prototype.backgroundRepeatShape=function(a,b,c,d,e,f,g,h,i){var j=[["line",Math.round(e),Math.round(f)],["line",Math.round(e+g),Math.round(f)],["line",Math.round(e+g),Math.round(h+f)],["line",Math.round(e),Math.round(h+f)]];this.clip([j],function(){this.renderBackgroundRepeat(a,b,c,d,i[3],i[0])},this)},d.prototype.renderBackgroundRepeat=function(a,b,c,d,e,f){var g=Math.round(d.left+b.left+e),h=Math.round(d.top+b.top+f);this.setFillStyle(this.ctx.createPattern(this.resizeImage(a,c),"repeat")),this.ctx.translate(g,h),this.ctx.fill(),this.ctx.translate(-g,-h)},d.prototype.renderBackgroundGradient=function(a,b){if(a instanceof g){var c=this.ctx.createLinearGradient(b.left+b.width*a.x0,b.top+b.height*a.y0,b.left+b.width*a.x1,b.top+b.height*a.y1);a.colorStops.forEach(function(a){c.addColorStop(a.stop,a.color.toString())}),this.rectangle(b.left,b.top,b.width,b.height,c)}},d.prototype.resizeImage=function(a,b){var c=a.image
;if(c.width===b.width&&c.height===b.height)return c;var d,e=document.createElement("canvas");return e.width=b.width,e.height=b.height,d=e.getContext("2d"),d.drawImage(c,0,0,c.width,c.height,0,0,b.width,b.height),e},b.exports=d},{"../lineargradientcontainer":12,"../log":13,"../renderer":19}],21:[function(a,b,c){function d(a,b,c,d){e.call(this,c,d),this.ownStacking=a,this.contexts=[],this.children=[],this.opacity=(this.parent?this.parent.stack.opacity:1)*b}var e=a("./nodecontainer");d.prototype=Object.create(e.prototype),d.prototype.getParentStack=function(a){var b=this.parent?this.parent.stack:null;return b?b.ownStacking?b:b.getParentStack(a):a.stack},b.exports=d},{"./nodecontainer":14}],22:[function(a,b,c){function d(a){this.rangeBounds=this.testRangeBounds(a),this.cors=this.testCORS(),this.svg=this.testSVG()}d.prototype.testRangeBounds=function(a){var b,c,d,e,f=!1;return a.createRange&&(b=a.createRange(),b.getBoundingClientRect&&(c=a.createElement("boundtest"),c.style.height="123px",c.style.display="block",a.body.appendChild(c),b.selectNode(c),d=b.getBoundingClientRect(),e=d.height,123===e&&(f=!0),a.body.removeChild(c))),f},d.prototype.testCORS=function(){return void 0!==(new Image).crossOrigin},d.prototype.testSVG=function(){var a=new Image,b=document.createElement("canvas"),c=b.getContext("2d");a.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{c.drawImage(a,0,0),b.toDataURL()}catch(a){return!1}return!0},b.exports=d},{}],23:[function(a,b,c){function d(a){this.src=a,this.image=null;var b=this;this.promise=this.hasFabric().then(function(){return b.isInline(a)?Promise.resolve(b.inlineFormatting(a)):e(a)}).then(function(a){return new Promise(function(c){window.html2canvas.svg.fabric.loadSVGFromString(a,b.createCanvas.call(b,c))})})}var e=a("./xhr"),f=a("./utils").decode64;d.prototype.hasFabric=function(){return window.html2canvas.svg&&window.html2canvas.svg.fabric?Promise.resolve():Promise.reject(new Error("html2canvas.svg.js is not loaded, cannot render svg"))},d.prototype.inlineFormatting=function(a){return/^data:image\/svg\+xml;base64,/.test(a)?this.decode64(this.removeContentType(a)):this.removeContentType(a)},d.prototype.removeContentType=function(a){return a.replace(/^data:image\/svg\+xml(;base64)?,/,"")},d.prototype.isInline=function(a){return/^data:image\/svg\+xml/i.test(a)},d.prototype.createCanvas=function(a){var b=this;return function(c,d){var e=new window.html2canvas.svg.fabric.StaticCanvas("c");b.image=e.lowerCanvasEl,e.setWidth(d.width).setHeight(d.height).add(window.html2canvas.svg.fabric.util.groupSVGElements(c,d)).renderAll(),a(e.lowerCanvasEl)}},d.prototype.decode64=function(a){return"function"==typeof window.atob?window.atob(a):f(a)},b.exports=d},{"./utils":26,"./xhr":28}],24:[function(a,b,c){function d(a,b){this.src=a,this.image=null;var c=this;this.promise=b?new Promise(function(b,d){c.image=new Image,c.image.onload=b,c.image.onerror=d,c.image.src="data:image/svg+xml,"+(new XMLSerializer).serializeToString(a),!0===c.image.complete&&b(c.image)}):this.hasFabric().then(function(){return new Promise(function(b){window.html2canvas.svg.fabric.parseSVGDocument(a,c.createCanvas.call(c,b))})})}var e=a("./svgcontainer");d.prototype=Object.create(e.prototype),b.exports=d},{"./svgcontainer":23}],25:[function(a,b,c){function d(a,b){f.call(this,a,b)}function e(a,b,c){if(a.length>0)return b+c.toUpperCase()}var f=a("./nodecontainer");d.prototype=Object.create(f.prototype),d.prototype.applyTextTransform=function(){this.node.data=this.transform(this.parent.css("textTransform"))},d.prototype.transform=function(a){var b=this.node.data;switch(a){case"lowercase":return b.toLowerCase();case"capitalize":return b.replace(/(^|\s|:|-|\(|\))([a-z])/g,e);case"uppercase":return b.toUpperCase();default:return b}},b.exports=d},{"./nodecontainer":14}],26:[function(a,b,c){c.smallImage=function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},c.bind=function(a,b){return function(){return a.apply(b,arguments)}},c.decode64=function(a){var b,c,d,e,f,g,h,i,j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",k=a.length,l="";for(b=0;b<k;b+=4)c=j.indexOf(a[b]),d=j.indexOf(a[b+1]),e=j.indexOf(a[b+2]),f=j.indexOf(a[b+3]),g=c<<2|d>>4,h=(15&d)<<4|e>>2,i=(3&e)<<6|f,l+=64===e?String.fromCharCode(g):64===f||-1===f?String.fromCharCode(g,h):String.fromCharCode(g,h,i);return l},c.getBounds=function(a){if(a.getBoundingClientRect){var b=a.getBoundingClientRect(),c=null==a.offsetWidth?b.width:a.offsetWidth;return{top:b.top,bottom:b.bottom||b.top+b.height,right:b.left+c,left:b.left,width:c,height:null==a.offsetHeight?b.height:a.offsetHeight}}return{}},c.offsetBounds=function(a){var b=a.offsetParent?c.offsetBounds(a.offsetParent):{top:0,left:0};return{top:a.offsetTop+b.top,bottom:a.offsetTop+a.offsetHeight+b.top,right:a.offsetLeft+b.left+a.offsetWidth,left:a.offsetLeft+b.left,width:a.offsetWidth,height:a.offsetHeight}},c.parseBackgrounds=function(a){var b,c,d,e,f,g,h,i=[],j=0,k=0,l=function(){b&&('"'===c.substr(0,1)&&(c=c.substr(1,c.length-2)),c&&h.push(c),"-"===b.substr(0,1)&&(e=b.indexOf("-",1)+1)>0&&(d=b.substr(0,e),b=b.substr(e)),i.push({prefix:d,method:b.toLowerCase(),value:f,args:h,image:null})),h=[],b=d=c=f=""};return h=[],b=d=c=f="",a.split("").forEach(function(a){if(!(0===j&&" \r\n\t".indexOf(a)>-1)){switch(a){case'"':g?g===a&&(g=null):g=a;break;case"(":if(g)break;if(0===j)return j=1,void(f+=a);k++;break;case")":if(g)break;if(1===j){if(0===k)return j=0,f+=a,void l();k--}break;case",":if(g)break;if(0===j)return void l();if(1===j&&0===k&&!b.match(/^url$/i))return h.push(c),c="",void(f+=a)}f+=a,0===j?b+=a:c+=a}}),l(),i}},{}],27:[function(a,b,c){function d(a){e.apply(this,arguments),this.type="linear"===a.args[0]?e.TYPES.LINEAR:e.TYPES.RADIAL}var e=a("./gradientcontainer");d.prototype=Object.create(e.prototype),b.exports=d},{"./gradientcontainer":9}],28:[function(a,b,c){function d(a){return new Promise(function(b,c){var d=new XMLHttpRequest;d.open("GET",a),d.onload=function(){200===d.status?b(d.responseText):c(new Error(d.statusText))},d.onerror=function(){c(new Error("Network Error"))},d.send()})}b.exports=d},{}]},{},[4])(4)}),function(a){"function"==typeof define&&define.amd?define(["jquery"],function(b){return a(b)}):"object"==typeof module&&"object"==typeof module.exports?exports=a(require("jquery")):a(jQuery)}(function(a){function b(a){var b=7.5625,c=2.75;return a<1/c?b*a*a:a<2/c?b*(a-=1.5/c)*a+.75:a<2.5/c?b*(a-=2.25/c)*a+.9375:b*(a-=2.625/c)*a+.984375}a.easing.jswing=a.easing.swing;var c=Math.pow,d=Math.sqrt,e=Math.sin,f=Math.cos,g=Math.PI,h=1.70158,i=1.525*h,j=2*g/3,k=2*g/4.5;a.extend(a.easing,{def:"easeOutQuad",swing:function(b){return a.easing[a.easing.def](b)},easeInQuad:function(a){return a*a},easeOutQuad:function(a){return 1-(1-a)*(1-a)},easeInOutQuad:function(a){return a<.5?2*a*a:1-c(-2*a+2,2)/2},easeInCubic:function(a){return a*a*a},easeOutCubic:function(a){return 1-c(1-a,3)},easeInOutCubic:function(a){return a<.5?4*a*a*a:1-c(-2*a+2,3)/2},easeInQuart:function(a){return a*a*a*a},easeOutQuart:function(a){return 1-c(1-a,4)},easeInOutQuart:function(a){return a<.5?8*a*a*a*a:1-c(-2*a+2,4)/2},easeInQuint:function(a){return a*a*a*a*a},easeOutQuint:function(a){return 1-c(1-a,5)},easeInOutQuint:function(a){return a<.5?16*a*a*a*a*a:1-c(-2*a+2,5)/2},easeInSine:function(a){return 1-f(a*g/2)},easeOutSine:function(a){return e(a*g/2)},easeInOutSine:function(a){return-(f(g*a)-1)/2},easeInExpo:function(a){return 0===a?0:c(2,10*a-10)},easeOutExpo:function(a){return 1===a?1:1-c(2,-10*a)},easeInOutExpo:function(a){return 0===a?0:1===a?1:a<.5?c(2,20*a-10)/2:(2-c(2,-20*a+10))/2},easeInCirc:function(a){return 1-d(1-c(a,2))},easeOutCirc:function(a){return d(1-c(a-1,2))},easeInOutCirc:function(a){return a<.5?(1-d(1-c(2*a,2)))/2:(d(1-c(-2*a+2,2))+1)/2},easeInElastic:function(a){return 0===a?0:1===a?1:-c(2,10*a-10)*e((10*a-10.75)*j)},easeOutElastic:function(a){return 0===a?0:1===a?1:c(2,-10*a)*e((10*a-.75)*j)+1},easeInOutElastic:function(a){return 0===a?0:1===a?1:a<.5?-c(2,20*a-10)*e((20*a-11.125)*k)/2:c(2,-20*a+10)*e((20*a-11.125)*k)/2+1},easeInBack:function(a){return(h+1)*a*a*a-h*a*a},easeOutBack:function(a){return 1+(h+1)*c(a-1,3)+h*c(a-1,2)},easeInOutBack:function(a){return a<.5?c(2*a,2)*(7.189819*a-i)/2:(c(2*a-2,2)*((i+1)*(2*a-2)+i)+2)/2},easeInBounce:function(a){return 1-b(1-a)},easeOutBounce:b,easeInOutBounce:function(a){return a<.5?(1-b(1-2*a))/2:(1+b(2*a-1))/2}})});var QoobController=Backbone.Router.extend({routes:{index:"index","":"index","groups/:group":"showGroup","edit/:blockId":"startEditBlock","save-template":"showSavePageTemplate"},index:function(){this.layout.menu.showIndex(),this.layout.stopEditBlock()},showGroup:function(a){this.layout.menu.showGroup(a)},setLayout:function(a){this.layout=a},setPageModel:function(a){this.pageModel=a},setStorage:function(a){this.storage=a},setPreviewMode:function(){this.layout.setPreviewMode()},setEditMode:function(){this.layout.setEditMode()},setDeviceMode:function(a){this.layout.setDeviceMode(a)},setAutoSave:function(a){this.autosave=a;var b=this;if(this.autosave)var c=setInterval(function(){b.autosave?b.save():clearInterval(c)},6e4)},save:function(a){var b=this;this.layout.toolbar.showSaveLoader();var c=JSON.parse(JSON.stringify(this.pageModel.toJSON()));c.version=window.QoobVersion;for(var d="",e=this.pageModel.get("blocks").models,f=0;f<e.length;f++){var g=e[f];d+=this.layout.viewPort.getBlockView(g.id).innerBlock.renderedTemplate}this.storage.save(c,d,function(c,d){b.layout.toolbar.hideSaveLoader(),"function"==typeof a&&a(c,d)})},exit:function(){var a=this;this.autosave?this.save(function(){a.storage.driver.exit(a.storage.pageId)}):this.storage.driver.exit(this.storage.pageId)},showSavePageTemplate:function(){this.layout.menu.rotateForward("save-template"),this.layout.menu.hideNotice(),this.layout.stopEditBlock()},addNewBlock:function(a,b,c){var d=this.storage.getBlockConfig(a,b);this.addBlock(QoobUtils.getDefaultSettings(d,d.name),c)},addBlock:function(a,b,c){c=void 0===c||c;var d=QoobUtils.createModel(a);if(this.pageModel.addBlock(d,b),this.layout.menu.addSettings(d),this.layout.viewPort.addBlock(d,b),c){var e,f=this,g=this.pageModel.get("blocks").indexOf(d),h=this.pageModel.get("blocks").at(g+1);e=0===g?"top":this.pageModel.get("blocks").length>1&&void 0===h&&"bottom",setTimeout(function(){f.scrollTo(d.id,e)},700)}},startEditBlock:function(a){this.pageModel.get("blocks").get(a)?(this.layout.startEditBlock(a),this.scrollTo(a)):this.navigate("index",{trigger:!0,replace:!0})},stopEditBlock:function(){this.layout.stopEditBlock(),this.navigate("index",{trigger:!0})},load:function(a){if(0===a.length)this.layout.viewPort.trigger("blocks_loaded");else for(var b=0;b<a.length;b++)this.addBlock(a[b],null,!1)},setInnerSettingsView:function(a){var b=a.$el.data("side-id");this.layout.menu.settingsViewStorage[b]&&this.deleteInnerSettingsView(b),this.layout.menu.addView(a),this.layout.menu.rotateForward(b,function(){a.$el.trigger("shown")}),this.layout.menu.settingsViewStorage[b]=a},deleteInnerSettingsView:function(a){this.layout.menu.delView(a)},deleteBlock:function(a){this.pageModel.deleteBlock(a),this.layout.viewPort.delBlockView(a),this.layout.menu.deleteSettings(a),this.triggerIframe()},moveDownBlock:function(a){this.pageModel.moveDown(a)},moveUpBlock:function(a){this.pageModel.moveUp(a)},triggerIframe:function(){this.layout.viewPort.triggerIframe()},changeLib:function(a){this.storage.currentLib=a,this.layout.menu.hideLibsExcept(a)},scrollTo:function(a,b){this.layout.viewPort.scrollTo(a,b)},current:function(){var a,b=this,c=Backbone.history.fragment,d=_.pairs(b.routes),e=null,f=null;return a=_.find(d,function(a){return e=_.isRegExp(a[0])?a[0]:b._routeToRegExp(a[0]),e.test(c)}),a&&(f=b._extractParameters(e,c),e=a[1]),{route:e,fragment:c,params:f}},createPageTemplate:function(a,b){var c=JSON.parse(JSON.stringify(this.pageModel.toJSON())),d=_.extend(a,c);if(c.blocks.length>0&&""!==a.title)this.storage.createPageTemplate(d,function(a){b(a,status)});else{var e={};""===a.title&&(e.title=!0),0===c.blocks.length&&(e.blocks=!0),b(e)}},removeTemplateBlock:function(a){this.storage.removePageTemplate(a)},changeDefaultPage:function(a){this.layout.viewPort.changeDefaultPage(a)},removePageData:function(){var a=this;_.each(_.clone(this.pageModel.get("blocks").models),function(b){a.deleteBlock(b)})},showImportExportWindow:function(){this.layout.ImportExport.showImportExportWindow()},removeEmptyDraggableElement:function(){this.layout.viewPort.removeEmptyDraggableElement()},showSwipeMenu:function(){this.layout.menu.showSwipeMenu()},hideSwipeMenu:function(){this.layout.menu.hideSwipeMenu()}}),BlockModel=Backbone.Model.extend({toJSON:function(){for(var a=Backbone.Model.prototype.toJSON.apply(this,arguments),b=0;b<a.length;b++)a[b]instanceof Backbone.Collection&&(a[b]=JSON.parse(JSON.stringify(a[b])));return a}}),PageModel=Backbone.Model.extend({initialize:function(){this.set("blocks",new Backbone.Collection)},addBlock:function(a,b){if(b=b||null){var c=this.get("blocks").get(b),d=this.get("blocks").indexOf(c);this.get("blocks").add(a,{at:d})}else this.get("blocks").add(a,{at:this.get("blocks").length+1})},deleteBlock:function(a){this.get("blocks").remove(a)},moveUp:function(a){var b=this.get("blocks").indexOf(a);b>0&&(this.swap(b,b-1),this.trigger("block_moveup",a.id))},moveDown:function(a){var b=this.get("blocks").indexOf(a);b<this.get("blocks").models.length&&(this.swap(b,b+1),this.trigger("block_movedown",a.id))},swap:function(a,b){this.get("blocks").models[a]=this.get("blocks").models.splice(b,1,this.get("blocks").models[a])[0]}}),QoobBlockView=Backbone.View.extend({tagName:"div",className:"content-block-inner",renderedTemplate:null,initialize:function(a){this.storage=a.storage,this.controller=a.controller,this.listenTo(this.model,"change",this.render)},render:function(){var a=this;return this.storage.getBlockTemplate(this.model.get("lib"),this.model.get("block"),function(b,c){if("blockNotFound"==b)a.renderedTemplate='<div class="empty-block"><div class="empty-block-text">The block '+a.model.get("block")+" is not found in the library "+a.model.get("lib")+"</div></div>";else{var d=a.storage.getBlockConfig(a.model.get("lib"),a.model.get("block")),e=d.blockTemplateAdapter||a.storage.getDefaultTemplateAdapter(),f=QoobExtensions.templating[e];a.renderedTemplate=f(c)(JSON.parse(JSON.stringify(a.model)))}a.controller.layout.viewPort.getWindowIframe().jQuery(a.el).html(a.renderedTemplate),"blockNotFound"==b&&(a.renderedTemplate=""),a.trigger("loaded"),a.controller.triggerIframe()}),a},dispose:function(){this.remove(),this.off(),this.model.off(null,null,this)}}),QoobBlockWrapperView=Backbone.View.extend({tagName:"div",events:{"click .qoob-overlay":"clickStartEditBlock"},attributes:function(){return{id:"outer-block-"+this.model.id}},initialize:function(a){this.storage=a.storage,this.controller=a.controller,this.innerBlock=new QoobBlockView({model:this.model,storage:this.storage,controller:this.controller})},render:function(){var a=this;return this.innerBlock.once("loaded",function(){var b=_.template(a.storage.getSkinTemplate("block-droppable-preview"))({blockId:a.model.id,text:this.storage.__("text_droppable_zone","Drop here to creative new block")}),c=_.template(a.storage.getSkinTemplate("block-overlay-preview"))({blockId:a.model.id});a.controller.layout.viewPort.getWindowIframe().jQuery(a.el).html([b,c,a.innerBlock.el]),a.$el.addClass("content-show content-block-outer"),a.droppable(),a.trigger("loaded"),a.controller.layout.viewPort.getWindowIframe().focus()}),a.$el.html(_.template(this.storage.getSkinTemplate("block-pleasewait-preview"))({text:this.storage.__("block_pleasewait_preview","Please wait")})),this.innerBlock.render(),this},clickStartEditBlock:function(){this.controller.layout.menu.getSettingsView(this.model.id)&&this.controller.navigate("edit/"+this.model.id,{trigger:!0}),isMobile.phone&&this.controller.showSwipeMenu()},droppable:function(){var a=this;this.$el.find("#droppable-"+a.model.id).droppable({activeClass:"ui-droppable-active",hoverClass:"ui-droppable-hover",tolerance:"pointer",drop:function(b,c){var d=jQuery(this),e=c.draggable.attr("id").replace("preview-block-",""),f=d.attr("id").replace("droppable-",""),g=c.draggable.data("lib");a.controller.addNewBlock(g,e,f)}})},dispose:function(){var a=this;this.$el.addClass("content-hide").one("animationend AnimationEnd",function(){a.$el.remove(),a.off(),a.model.off(null,null,a)})}}),QoobEditModeButtonView=Backbone.View.extend({tagName:"button",className:"edit-mode-button",events:{click:"clickEditMode"},initialize:function(a){this.storage=a.storage,this.controller=a.controller},clickEditMode:function(){this.controller.setEditMode()},setPreviewMode:function(){this.$el.fadeIn(300)},setEditMode:function(){this.$el.fadeOut(300)},show:function(){this.$el.show()},hide:function(){this.$el.hide()},isVisible:function(){return this.$el.is(":visible")}}),QoobFieldView=Backbone.View.extend({className:"settings-item",initialize:function(a){this.model=a.model,this.storage=a.storage,this.settings=a.settings,this.defaults=a.defaults,this.controller=a.controller},getValue:function(){if(void 0===this.model.get(this.settings.name)){var a=_.isArray(this.defaults)?QoobUtils.createCollection(this.defaults):this.defaults;this.model.set(this.settings.name,a)}return this.model.get(this.settings.name)}}),QoobFieldsView=Backbone.View.extend({tagName:"div",className:"settings-block-items",initialize:function(a){this.model=a.model,this.storage=a.storage,this.settings=a.settings,this.defaults=a.defaults,this.controller=a.controller,this.parentId=a.parentId,this.fields=[]},render:function(){for(var a=[],b=0;b<this.settings.length;b++){if(!Fields[this.settings[b].type])throw new Error("Field "+this.settings[b].type+" not found!");var c=new Fields[this.settings[b].type]({model:this.model,storage:this.storage,settings:this.settings[b],defaults:this.defaults[this.settings[b].name],controller:this.controller,parentId:this.parentId});this.fields.push(c),a.push(c.render().el)}return this.$el.html(a),this}}),QoobLayout=Backbone.View.extend({tagName:"div",id:"qoob",initialize:function(a){this.storage=a.storage,this.controller=a.controller,this.sidebar=new QoobSidebarView({model:this.model,storage:this.storage,controller:this.controller}),this.menu=new QoobMenuView({model:this.model,storage:this.storage,controller:this.controller}),this.toolbar=new QoobToolbarView({model:this.model,storage:this.storage,controller:this.controller}),this.editModeButton=new QoobEditModeButtonView({model:this.model,storage:this.storage,controller:this.controller}),this.viewPort=new QoobViewportView({model:this.model,storage:this.storage,controller:this.controller}),this.ImportExport=new QoobImportExportView({storage:this.storage,controller:this.controller})},render:function(){return this.sidebar.$el.html([this.toolbar.render().el,this.menu.render().el]),this.$el.html([this.sidebar.render().el,this.viewPort.render().el,this.ImportExport.render().el,this.editModeButton.render().el]),this},resize:function(){this.sidebar.resize(),this.viewPort.resize()},setPreviewMode:function(){this.editModeButton.setPreviewMode(),this.sidebar.setPreviewMode(),this.viewPort.setPreviewMode(),this.resize()},setEditMode:function(){this.editModeButton.setEditMode(),this.menu.setEditMode(),this.viewPort.setEditMode(),this.resize()},setDeviceMode:function(a){this.viewPort.setDeviceMode(a)},startEditBlock:function(a){this.menu.startEditBlock(a),this.viewPort.startEditBlock(a)},stopEditBlock:function(){this.viewPort.stopEditBlock()}}),QoobSidebarView=Backbone.View.extend({attributes:function(){return{id:"qoob-sidebar"}},initialize:function(a){this.storage=a.storage,this.controller=a.controller},render:function(){return this},setPreviewMode:function(){this.$el.addClass("hide-sidebar")},resize:function(){this.$el.css("height",jQuery(window).height())}}),QoobMenuView=Backbone.View.extend({id:"qoob-menu",menuViews:[],settingsViewStorage:[],groupActiveClass:"group-list__link-active",initialize:function(a){this.controller=a.controller,this.storage=a.storage},addSettings:function(a){var b=this.storage.getBlockConfig(a.get("lib"),a.get("block"));b&&this.addView(new QoobMenuSettingsView({model:a,config:b,storage:this.storage,controller:this.controller}),"left")},render:function(){this.$el.html(_.template(this.storage.getSkinTemplate("qoob-menu-preview"))());var a=this.storage.getGroups();this.addView(new QoobMenuGroupsView({storage:this.storage,groups:a,controller:this.controller}));for(var b=0;b<a.length;b++)this.addView(new QoobMenuBlocksPreviewView({id:a[b].id,storage:this.storage,controller:this.controller,group:a[b]}),"right");return this.addView(new QoobMenuSavePageTemplateView({id:"save-template",storage:this.storage,controller:this.controller}),"left"),this.draggable(),this},draggable:function(){var a,b,c=this,d=!1;this.$el.find(".preview-block").data("blockPreventDefault",!0),this.$el.find(".preview-block").draggable({appendTo:"body",helper:"clone",distance:10,iframeFix:!0,iframeScroll:!0,scrollSensitivity:100,scrollSpeed:15,containment:"document",opacity:.5,start:function(){if(!d)return c.controller.removeEmptyDraggableElement(),!1;isMobile.phone&&c.controller.hideSwipeMenu()},stop:function(){c.controller.removeEmptyDraggableElement()}}),this.$el.find(".preview-block").each(function(){jQuery(this).on("mousedown",function(){0===event.buttons||(d=!0)}),jQuery(this).on("touchstart",function(c){var e;$this=jQuery(this),a=jQuery.position.scrollbarWidth(),b=$this.parent(".preview-blocks"),e=setTimeout(function(){b.get(0).scrollHeight>b.get(0).clientHeight&&b.css("padding-right",a).addClass("disable-scroll"),d=!0;var e=jQuery.Event("mousemove"),f=c.originalEvent.touches[0]||c.originalEvent.changedTouches[0];e.pageX=f.pageX+10,e.pageY=f.pageY,$this.trigger(e)},500),$this.one("touchend",function(){d=!1,b.get(0).scrollHeight>b.get(0).clientHeight&&b.removeAttr("style").removeClass("disable-scroll"),clearTimeout(e)}),$this.one("touchmove",function(){clearTimeout(e)})})})},setEditMode:function(){this.$el.fadeIn(300)},showGroup:function(a){this.hideSide("left"),this.showSide("right",a)},showIndex:function(){this.hideSide("left"),this.hideSide("right")},startEditBlock:function(a){this.hideSide("right"),this.showSide("left",a)},addView:function(a,b){this.menuViews.push(a),"left"===b||"right"===b?this.$el.find(".qoob-menu-"+b+"-side").append(a.render().el):this.$el.find(".qoob-menu-center").append(a.render().el)},getSettingsView:function(a){for(var b=0;b<this.menuViews.length;b++)if(this.menuViews[b].model&&this.menuViews[b].model.id==a)return this.menuViews[b]},showSide:function(a,b){var a=this.$el.find(".qoob-menu-"+a+"-side");this.$el.find("[data-group-id]").removeClass(this.groupActiveClass),this.$el.find("[data-group-id="+b+"]").length&&this.$el.find("[data-group-id="+b+"]").addClass(this.groupActiveClass),a.hasClass("show-side")||a.addClass("show-side"),a.find("[data-side-id]").removeClass("side-item-show"),a.find('[data-side-id="'+b+'"]').addClass("side-item-show")},hideSide:function(a){var a=this.$el.find(".qoob-menu-"+a+"-side");a.find("[data-side-id]").hasClass("side-item-show")&&this.$el.find("[data-group-id]").removeClass(this.groupActiveClass),a.hasClass("show-side")&&a.removeClass("show-side")},onEditStart:function(a){this.rotate("settings-block-"+a)},onEditStop:function(){this.rotate("catalog-groups")},onEditMode:function(){this.$el.fadeIn(300)},delView:function(a){this.settingsViewStorage&&this.settingsViewStorage[a]&&(this.settingsViewStorage[a].dispose(),delete this.settingsViewStorage[a])},deleteSettings:function(a){this.controller.stopEditBlock(),this.getSettingsView(a.id).dispose()},hideLibsExcept:function(a){var b=this,c=this.$el.find("ul.catalog-list li"),d=this.$el.find(".preview-block");c.hide(),d.hide(),"all"!==a&&(c=c.filter(function(d){return b.$(c[d]).hasClass(a)}),d=d.filter(function(c){return b.$(d[c]).hasClass(a)})),c.show(),d.show()},hideNotice:function(){var a=_.findWhere(this.menuViews,{id:"save-template"}),b=a.$el;b.find(".save-template-settings").hasClass("show-notice")&&(b.find(".remove").trigger("click"),b.find(".input-text").val(""),b.find(".save-template-settings").removeClass("show-notice")),b.find(".error-block").is(":visible")&&b.find(".error-block").hide(),b.find(".input-text").hasClass("error")&&b.find(".input-text").removeClass("error")},showSwipeMenu:function(){jQuery("#qoob").removeClass("close-panel")},hideSwipeMenu:function(){jQuery("#qoob").hasClass("close-panel")||jQuery("#qoob").addClass("close-panel")}}),QoobToolbarView=Backbone.View.extend({tagName:"div",customMenu:null,events:{"click .view-preview":"clickPreviewMode","change .lib-select":"changeLib","change .preview-modes":"changeDeviceMode","click .save":"clickSave","click .autosave-checkbox":"clickAutosave","click [data-id]":"clickAction"},attributes:function(){return{id:"qoob-toolbar"}},initialize:function(a){this.storage=a.storage,this.controller=a.controller},clickAction:function(a){a.preventDefault();var b=jQuery(a.currentTarget).data("id");if("function"==typeof this.storage.driver.mainMenu){var c=this.customMenu.find(function(a){return a.id===b});c.action&&c.action(this)}},render:function(){var a=this,b={libs:this.storage.librariesData,curLib:this.storage.currentLib,allThemes:this.storage.__("all_libs","All Libs"),save:this.storage.__("save","Save"),close:this.storage.__("close","close"),more:this.storage.__("more","More"),desktop:this.storage.__("desktop","Desktop"),tablet:this.storage.__("tablet","Tablet"),phone:this.storage.__("phone","Phone"),save_template:this.storage.__("save_template","Save as template"),autosave:this.storage.__("autosave","Autosave"),customMenu:null};if("function"==typeof this.storage.driver.mainMenu){var c=[{id:"import-export",label:"Import/export",action:function(){a.controller.showImportExportWindow()},icon:""},{id:"empty-page",label:"Empty page",action:function(){a.controller.removePageData()},icon:""}];b.customMenu=this.customMenu=this.storage.driver.mainMenu(c)}return this.$el.html(_.template(this.storage.getSkinTemplate("qoob-toolbar-preview"))(b)),this.$el.find(".qoob-select-item").qoobSelect(),this},showSaveLoader:function(){this.$el.find(".save span.text").hide(),this.$el.find(".save .clock").css("display","block")},hideSaveLoader:function(){this.$el.find(".save .clock").css("display",""),this.$el.find(".save span.text").show()},clickPreviewMode:function(){this.controller.setPreviewMode()},changeDeviceMode:function(a){this.controller.setDeviceMode(a.target.value)},clickExit:function(){this.controller.exit()},clickSave:function(){this.controller.save()},clickAutosave:function(a){this.controller.setAutoSave(a.target.checked)},changeLib:function(a){this.controller.changeLib(a.target.value)}}),QoobViewportView=Backbone.View.extend({id:"qoob-viewport",deviceMode:"pc",previewMode:!1,blocksCounter:0,blockViews:[],initialize:function(a){this.controller=a.controller,this.storage=a.storage,this.model.on("block_moveup",this.moveUpBlockView.bind(this)),this.model.on("block_movedown",this.moveDownBlockView.bind(this))},render:function(){var a=this.storage.driver.getIframePageUrl();return this.$el.html(_.template(this.storage.getSkinTemplate("qoob-viewport-preview"))({url:a,text_droppable_zone:this.storage.__("text_droppable_zone","Drop here to creative new block")})),this.$el.find("#qoob-iframe").on("libraries_loaded",this.iframeLoaded.bind(this)),this},iframeLoaded:function(){this.trigger("iframe_loaded"),this.triggerIframe(),this.defaultDroppable()},defaultDroppable:function(){var a=this;this.$el.find("#droppable-default").droppable({tolerance:"pointer",drop:function(b,c){var d=c.draggable.attr("id").replace("preview-block-",""),e=c.draggable.data("lib");a.controller.addNewBlock(e,d)}})},startEditBlock:function(a){var b=this.getWindowIframe();b.jQuery(".qoob-overlay").removeClass("active").addClass("no-active"),b.jQuery("#outer-block-"+a).find(".qoob-overlay").removeClass("no-active").addClass("active")},stopEditBlock:function(){this.getWindowIframe().jQuery(".qoob-overlay").removeClass("active").removeClass("no-active")},setPreviewMode:function(){this.previewMode=!0,this.getIframeContents().find("#qoob-blocks").addClass("preview")},setEditMode:function(){this.previewMode=!1,this.getIframeContents().find("#qoob-blocks").removeClass("preview")},setDeviceMode:function(a){var b=this;this.deviceMode=a;var c={pc:{width:"100%"},tablet:{width:"768px"},phone:{width:"375px"}};this.getIframe().stop().animate(c[a],500,function(){var a=b.controller.current();"startEditBlock"==a.route&&b.controller.scrollTo(a.params[0])})},resize:function(){var a={width:this.previewMode?0:264};this.$el.stop().animate({width:jQuery(window).width()-a.width}),this.getIframe().height(jQuery(window).height()),"pc"==this.deviceMode&&this.getIframe().width("100%")},scrollTo:function(a,b){var c,d=this.getWindowIframe();if("top"===b)c=0;else if("bottom"===b)c=d.document.body.scrollHeight;else{var e=this.getBlockView(a).$el,f=this.getIframe().height();c=e.offset().top-(f-e.outerHeight(!0))/2}this.getWindowIframe().jQuery("html, body").animate({scrollTop:c},1e3)},getBlockView:function(a){for(var b=0;b<this.blockViews.length;b++)if(this.blockViews[b].model.id==a)return this.blockViews[b]},delBlockView:function(a){for(var b=0;b<this.blockViews.length;b++)this.blockViews[b].model.id==a.id&&(this.blockViews[b].dispose(),this.blockViews.splice(b,1));0==this.blockViews.length&&this.controller.changeDefaultPage("show")},addBlock:function(a,b){var c=this,d=this.getWindowIframe(),e=new QoobBlockWrapperView({model:a,storage:this.storage,controller:this.controller});e.setElement(c.controller.layout.viewPort.getWindowIframe().jQuery('<div id="outer-block-'+a.id+'">')),this.blockViews.push(e),this.blocksCounter++,e.once("loaded",function(){c.trigger("block_loaded"),0===--c.blocksCounter&&c.trigger("blocks_loaded")}),b>0?d.jQuery("#outer-block-"+b).before(e.render().el):d.jQuery("#qoob-blocks").append(e.render().el),this.blockViews.length>0&&1==this.blockViews.length&&this.controller.changeDefaultPage("hide"),this.$el.find("#qoob-iframe").next("div").length>0&&this.$el.find("#qoob-iframe").nextAll("div").remove(),this.controller.removeEmptyDraggableElement(),this.triggerIframe()},removeEmptyDraggableElement:function(){this.getIframe().next("div").length>0&&this.getIframe().nextAll("div").remove()},triggerIframe:function(){var a=this.getWindowIframe();a.jQuery("#qoob-blocks").trigger("change"),a.jQuery('a, .btn, input[type="submit"]').attr("onclick","return false;")},getIframe:function(){return this.$el.find("#qoob-iframe")},getIframeContents:function(){return this.getIframe().contents()},getWindowIframe:function(){return window.frames["qoob-iframe"]},moveUpBlockView:function(a){var b=this.getBlockView(a);b.$el.after(b.$el.prev()),this.scrollTo(a)},moveDownBlockView:function(a){var b=this.getBlockView(a);b.$el.before(b.$el.next()),this.scrollTo(a)},createBlankPage:function(){var a=this.getWindowIframe(),b=new QoobPageTemplatesView({storage:this.storage,controller:this.controller});a.jQuery("#qoob-blocks").append(b.render().el),this.storage.loadPageTemplates(function(a,c){c&&c.length>0&&b.render()})},changeDefaultPage:function(a){var b=this.getWindowIframe().jQuery("#qoob-blocks");"hide"===a?(b.find(".qoob-templates").hide(),this.$el.find("#droppable-default").hide()):"show"===a&&(b.find(".qoob-templates").show(),this.$el.find("#droppable-default").show())}}),QoobMenuBlocksPreviewView=Backbone.View.extend({className:"preview-block-wrap",events:{"click .preview-block":"clickPreviewBlock"},attributes:function(){return{"data-side-id":this.id}},clickPreviewBlock:function(a){var b=a.currentTarget.id.replace("preview-block-",""),c=this.$(a.currentTarget).data("lib");this.controller.addNewBlock(c,b),isMobile.phone&&this.controller.hideSwipeMenu()},initialize:function(a){
this.controller=a.controller,this.storage=a.storage,this.group=a.group},render:function(){var a={group:this.group,items:this.storage.getBlocksByGroup(this.group.id)};return this.$el.html(_.template(this.storage.getSkinTemplate("menu-blocks-preview"))(a)),this}}),QoobMenuGroupsView=Backbone.View.extend({attributes:function(){return{"data-side-id":"catalog-groups"}},events:{"click .group-list__link-active":"clickLinkGroupActive"},initialize:function(a){this.storage=a.storage,this.groups=a.groups,this.controller=a.controller},clickLinkGroupActive:function(a){a.preventDefault(),$(a.currentTarget).removeClass("group-list__link-active"),this.controller.navigate("index",{trigger:!0,replace:!0})},render:function(){var a={groups_arr:this.groups};return this.$el.html(_.template(this.storage.getSkinTemplate("menu-groups-preview"))(a)),this}}),QoobMenuSavePageTemplateView=Backbone.View.extend({events:{"click .create-template":"clickCreateTemplate"},settingsModel:null,config:[{name:"title",label:"Title",type:"text",placeholder:"Enter name template"}],defaults:{title:"",image:""},attributes:function(){return{"data-side-id":"save-template",class:"save-template settings"}},initialize:function(a){this.controller=a.controller,this.storage=a.storage},clickCreateTemplate:function(a){a.preventDefault();var b=this,c=this.$(a.currentTarget),d=_.sortBy(this.storage.pageTemplatesCollection.models,function(a){return a.id}),e=d.length?d[d.length-1].id+1:1,f={id:e,title:this.settingsModel.get("title"),image:null};c.addClass("active"),this.controller.layout.viewPort.getIframeContents().scrollTop(0),html2canvas(this.controller.layout.viewPort.getIframeContents().find("body"),{scale:2}).then(function(a){var d=document.createElement("canvas");d.setAttribute("width",254),d.setAttribute("height",272),d.getContext("2d").drawImage(a,0,0,a.width,a.height,0,0,254,272);var e=d.toDataURL();f.image=e,b.controller.createPageTemplate(f,function(a){c.removeClass("active"),null===a?(b.$el.find(".save-template-settings").addClass("show-notice"),b.$el.find(".save-template-settings .error-block").hide(),b.settingsModel.set("image",""),b.settingsModel.set("title",""),b.$el.find(".input-text").removeClass("error")):(a.title&&b.$el.find(".input-text").addClass("error"),a.blocks&&b.$el.find(".save-template-settings .error-block").show())})})},render:function(){var a=QoobUtils.createModel(this.config),b={back:this.storage.__("back","Back"),save_template:this.storage.__("save_template","Save template"),save_loading:this.storage.__("save_process","Save..."),save_notice_title:this.storage.__("save_notice_title","Your template has been saved successfully!"),save_notice_text:this.storage.__("save_notice_text","You can use a ready-made template to create a new page."),you_cant_save_empty_template:this.storage.__("you_cant_save_empty_template","You can't save empty template")};return this.settingsView=new QoobFieldsView({model:a,settings:this.config,defaults:this.defaults,storage:this.storage,controller:this.controller,parentId:this.id}),this.settingsModel=this.settingsView.model,this.$el.html(_.template(this.storage.getSkinTemplate("menu-more-preview"))(b)).find(".settings-blocks-full").prepend(this.settingsView.render().el),this}}),QoobMenuSettingsView=Backbone.View.extend({tagName:"div",className:"settings",config:null,events:{"click .back":"clickBack","click .delete-block":"clickDelete","click .movedown":"clickMoveDown","click .moveup":"clickMoveUp"},attributes:function(){return{"data-side-id":this.model.id,id:"settings-block-"+this.model.id}},initialize:function(a){this.model=a.model,this.config=a.config,this.storage=a.storage,this.controller=a.controller},render:function(){return this.settingsBlock=new QoobFieldsView({model:this.model,storage:this.storage,settings:this.config.settings,defaults:this.config.defaults,controller:this.controller}),this.$el.html(_.template(this.storage.getSkinTemplate("menu-settings-preview"))({config:this.config,back:this.storage.__("back","Back"),move:this.storage.__("move","Move")})).find(".settings-blocks").prepend(this.settingsBlock.render().el),this.afterRender(),this},afterRender:function(){var a=this,b=0,c=this.settingsBlock.fields;this.$el.on("drag dragstart dragend dragover dragenter dragleave drop",function(a){a.preventDefault(),a.stopPropagation()}).on("dragenter",function(){if(1===++b){for(var d=0;d<c.length;d++)c[d].$el.trigger("global_drag_start");a.$el.addClass("overlay")}}).on("dragleave",function(){if(0===--b){for(var d=0;d<c.length;d++)c[d].$el.trigger("global_drag_stop");a.$el.removeClass("overlay")}}).on("drop",function(){for(var d=0;d<c.length;d++)c[d].$el.trigger("global_drag_stop");a.$el.removeClass("overlay"),b=0})},clickBack:function(a){a.preventDefault(),this.controller.stopEditBlock()},clickDelete:function(){if(!confirm(this.storage.__("confirm_delete_block","Are you sure you want to delete the block?")))return!1;this.controller.deleteBlock(this.model)},clickMoveDown:function(){this.controller.moveDownBlock(this.model)},clickMoveUp:function(){this.controller.moveUpBlock(this.model)},dispose:function(){this.$el.remove(),this.off(),this.model.off(null,null,this)}}),QoobImportExportView=Backbone.View.extend({tagName:"div",id:"qoob-import-export",events:{"click .save-changes":"clickSaveChanges"},initialize:function(a){this.controller=a.controller,this.storage=a.storage},clickSaveChanges:function(a){a.preventDefault(),this.controller.pageModel.get("blocks").models.length>0&&this.controller.removePageData();var b=JSON.parse(this.$el.find(".qoob-import-export-textarea").val());this.controller.load(b.blocks)},showImportExportWindow:function(){var a=this;this.render(),this.$el.find("#qoob-import-export-window").modal("show"),this.controller.layout.viewPort.once("blocks_loaded",function(){a.$el.find("#qoob-import-export-window").modal("hide")})},render:function(){var a=JSON.parse(JSON.stringify(this.controller.pageModel.toJSON()));return a.version=window.QoobVersion,this.$el.html(_.template(this.storage.getSkinTemplate("block-import-export-preview"))({page_data_text:this.storage.__("page_data","Page data"),cancel:this.storage.__("cancel","Cancel"),save_changes:this.storage.__("save_changes","Save changes"),page_data:JSON.stringify(a)})),this}}),QoobPageTemplatesView=Backbone.View.extend({tagName:"div",className:"qoob-templates",events:{"click .template .image-bg, .template .title":"clickChoiceTemplateBlock","click .remove":"clickRemoveTemplateBlock"},initialize:function(a){this.storage=a.storage,this.controller=a.controller,this.listenTo(this.storage.pageTemplatesCollection,"add remove",this.render)},clickChoiceTemplateBlock:function(a){var b=this,c=jQuery(a.currentTarget).parents("[data-id]").data("id");this.storage.pageTemplatesCollection.each(function(a){parseInt(a.id)===c&&b.controller.load(a.get("blocks"))})},clickRemoveTemplateBlock:function(a){a.preventDefault();var b=jQuery(a.currentTarget).data("id");this.controller.removeTemplateBlock(b)},render:function(){return this.$el.html(_.template(this.storage.getSkinTemplate("block-default-templates"))({templates:this.storage.pageTemplatesCollection.toJSON(),block_default_templates_text:this.storage.__("block_default_templates_text","Or you can choose one of templates"),text_default_blank:this.storage.__("block_default_blank","This is blank page, you can click on block preview to add block"),template:this.storage.__("template","Template")})),this}}),Fields=Fields||{};Fields.accordion_item_expand=Backbone.View.extend({className:"field-accordion__settings",events:{"click .cross-delete":"deleteModel"},parentId:null,initialize:function(a){QoobFieldView.prototype.initialize.call(this,a),this.$el.attr("data-model-id",this.model.id),this.tpl=_.template(this.storage.getSkinTemplate("field-accordion-item-expand-preview")),this.parentId=a.parentId||this.model.owner_id},render:function(){var a=[],b=new QoobFieldsView({model:this.model,settings:this.settings,defaults:this.defaults,storage:this.storage,controller:this.controller,parentId:this.parentId}),c={image:b.model.get("image"),title:b.model.get("title")};return this.listenTo(this.model,"change",function(){this.$el.find(".title-item").first().html(this.model.get("title")),this.$el.find(".preview-image img").first().prop("src",this.model.get("image"))}),a.push(this.tpl(c)),a.push(b.render().$el.append('<div class="cross-delete expand"></div>')),(void 0===this.settings.show||this.settings.show(this.model))&&this.$el.html(a),this},deleteModel:function(){this.model.stopListening(),this.model.trigger("destroy",this.model,this.model.collection),this.remove(),this.model.trigger("remove_item")}});var AccordionFlipView=QoobFieldView.extend({className:"settings menu-block accordion-item",parentId:null,attributes:function(){return{id:"settings-block-"+this.model.id,"data-side-id":this.model.id}},events:{"click .backward-accordion":"backward","click .delete-item-accordion":"deleteInnerSettings"},initialize:function(a){QoobFieldView.prototype.initialize.call(this,a),this.tpl=_.template(this.storage.getSkinTemplate("field-accordion-item-flip-view-preview")),this.parentId=a.parentId},render:function(){var a=new QoobFieldsView({model:this.model,settings:this.settings,defaults:this.defaults,storage:this.storage,controller:this.controller,parentId:this.model.id});return this.$el.html(this.tpl({id:"settings-block-"+this.parentId,currentId:"settings-block-"+this.model.id,back:this.storage.__("back","Back")})),this.$el.find(".settings-blocks").prepend(a.render().$el),this},deleteInnerSettings:function(){var a=this.$el.prop("id");this.backward(),this.model.trigger("delete_model",this),this.controller.deleteInnerSettingsView(a)},dispose:function(){this.$el.remove(),this.off(),this.model.off(null,null,this)},backward:function(a){a&&a.preventDefault(),this.controller.layout.menu.rotateBackward(this.parentId)}}),Fields=Fields||{};Fields.accordion_item_flip=QoobFieldView.extend({className:"settings-item settings-accordion",events:{"click .title_accordion.inner-settings-flip":"showSettings"},initialize:function(a){QoobFieldView.prototype.initialize.call(this,a),this.$el.attr("data-model-id",this.model.id),this.tpl=_.template(this.storage.getSkinTemplate("field-accordion-item-flip-preview")),this.parentId=a.parentId||this.model.owner_id,this.model.on("delete_model",this.deleteModel.bind(this))},showSettings:function(){var a=new AccordionFlipView({model:this.model,settings:this.settings,defaults:this.defaults,storage:this.storage,controller:this.controller,parentId:this.parentId});this.controller.setInnerSettingsView(a)},render:function(){var a=[],b=new QoobFieldsView({model:this.model,settings:this.settings,defaults:this.defaults,storage:this.storage,controller:this.controller}),c={image:b.model.get("image"),title:b.model.get("title")};return this.listenTo(b.model,"change",function(){this.$el.find("h3 span.text").html(this.model.get("title")),this.$el.find("h3 span.preview_img img").prop("src",this.model.get("image"))}),a.push(this.tpl(c)),(void 0===this.settings.show||this.settings.show(this.model))&&this.$el.html(a),this},deleteModel:function(){this.model.stopListening(),this.model.trigger("destroy",this.model,this.model.collection),this.remove(),this.model.trigger("remove_item")}});var Fields=Fields||{};Fields.accordion=QoobFieldView.extend({className:"field-accordion field-group",uniqueId:null,classNameItem:"",accordionMenuViews:[],parentId:null,events:{"drop .accordion":"changePosition"},initialize:function(a){QoobFieldView.prototype.initialize.call(this,a),this.tpl=_.template(this.storage.getSkinTemplate("field-accordion-preview")),this.parentId=a.parentId||this.model.id},remove:function(){this.$el.find("#"+this.uniqueId).next(".add-item").off("click",this.addNewItem),Backbone.View.prototype.remove.apply(this,arguments)},removeItem:function(){this.getValue().trigger("change"),this.changePosition()},changePosition:function(a,b){var c=this,d=this.getValue();this.$el.find("#"+this.getUniqueId()).children(".field-accordion__settings").each(function(a,b){var e=c.$(b).data("model-id"),f=d.get(e);f&&f.set("order",c.$(b).index()-1)})},getUniqueId:function(){return this.uniqueId=this.uniqueId||_.uniqueId("accordion-")},addNewItem:function(a){a.preventDefault();for(var b,c=this.getValue(),d=this.settings.settings,e=this.defaults[0],f=[],g=[],h=0;h<d.length;h++)f.push({name:d[h].name,default:e[d[h].name]});for(var h=0;h<f.length;h++)g[f[h].name]=f[h].default;b=QoobUtils.createModel(g),b.owner_id=this.model.id,c.add(b),c.listenTo(b,"change",function(){this.trigger("change",this)}),b.on("remove_item",this.removeItem.bind(this));var i=new Fields[this.classNameItem]({model:b,settings:d,storage:this.storage,defaults:e,controller:this.controller,parentId:this.parentId});i.model.set("order",c.models?c.models.length-1:0),this.accordionMenuViews.push(i),this.$el.find("#"+this.getUniqueId()).append(i.render().el),this.$el.find("#"+this.getUniqueId()).accordion("refresh"),c.trigger("change")},render:function(){var a=this.getValue(),b=this.settings.settings,c=[];if(a.models=_.sortBy(a.models,function(a){return a.get("order")}),this.classNameItem=void 0===this.settings.viewType||"expand"===this.settings.viewType?"accordion_item_expand":"accordion_item_flip",a.length&&a.length>0)for(var d=0;d<a.models.length;d++){var e=new Fields[this.classNameItem]({model:a.models[d],settings:b,defaults:this.defaults[d]||this.defaults[0],storage:this.storage,controller:this.controller,parentId:this.parentId});this.accordionMenuViews.push(e),c.push(e.render().el),a.models[d].on("remove_item",this.removeItem.bind(this))}var f={label:this.settings.label,uniqueId:this.getUniqueId(),settings:b,add_component:this.storage.__("add_component","Add component"),drag_to_delete:this.storage.__("drag_to_delete","Drag to delete")};return(void 0===this.settings.show||this.settings.show(this.model))&&(this.$el.html(this.tpl(f)).find("#"+this.getUniqueId()).append(c),this.sortableInit()),this.$el.find("#"+this.uniqueId).next(".add-block").on("click",this.addNewItem.bind(this)),this},sortableInit:function(){var a=this,b=this.getUniqueId();this.$el.find("#"+b).accordion({header:"> div > h3.inner-settings-expand",animate:500,collapsible:!0,active:!1,heightStyle:"content"}).sortable({items:".field-accordion__settings",revert:!1,axis:"y",helper:"clone",handle:".draggable",connectWith:"#drop-"+b,scope:"accordion",start:function(){a.controller.layout.viewPort.getIframeContents().find(".droppable").css("visibility","hidden"),jQuery(this).addClass("is-droppable")},stop:function(b,c){jQuery(this).removeClass("is-droppable"),c.item.trigger("drop",c.item.index()),c.item.children("h3").triggerHandler("focusout"),a.$(this).accordion("refresh"),a.controller.layout.viewPort.getIframeContents().find(".droppable").removeAttr("style")}}),this.$el.find("#drop-"+b).droppable({scope:"accordion",hoverClass:"ui-state-hover",drop:function(b,c){var d=c.draggable.data("model-id");a.getAccordionMenuViews(d).deleteModel()}})},getAccordionMenuViews:function(a){for(var b=0;b<this.accordionMenuViews.length;b++)if(this.accordionMenuViews[b].model&&this.accordionMenuViews[b].model.id==a)return this.accordionMenuViews[b]}});var Fields=Fields||{};Fields.checkbox_switch=QoobFieldView.extend({className:"field-checkbox-switch field-group",events:{"change input":"changeSwitch"},changeSwitch:function(a){var b=jQuery(a.target);this.model.set(b.attr("name"),0==b[0].checked?0:1)},getBool:function(a){if(void 0==a)return!1;var b=+a;return isNaN(b)?!!String(a).toLowerCase().replace(!1,""):!!b},checked:function(){return this.model.get(this.settings.name)?this.getBool(this.model.get(this.settings.name)):this.getBool(this.settings.default)},getUniqueId:function(){return this.uniqueId=this.uniqueId||_.uniqueId("checkbox-switch-")},render:function(){var a={label:this.settings.label,name:this.settings.name,uniqueId:this.getUniqueId(),checked:this.checked()?"checked":""};return this.$el.html(_.template(this.storage.getSkinTemplate("field-checkbox-switch-preview"))(a)),this}});var Fields=Fields||{};Fields.checkbox=QoobFieldView.extend({className:"field-checkbox field-group",events:{"change input":"changeInput"},changeInput:function(a){var b=jQuery(a.target);this.model.set(b.attr("name"),0==b[0].checked?0:1)},getBool:function(a){if(void 0==a)return!1;var b=+a;return isNaN(b)?!!String(a).toLowerCase().replace(!1,""):!!b},checked:function(){return this.model.get(this.settings.name)?this.getBool(this.model.get(this.settings.name)):this.getBool(this.settings.default)},render:function(){var a={label:this.settings.label,name:this.settings.name,checked:this.checked()?"checked":""};return this.$el.html(_.template(this.storage.getSkinTemplate("field-checkbox-preview"))(a)),this}});var Fields=Fields||{};Fields.colorpicker=QoobFieldView.extend({className:"field-color-picker field-group",events:{"click .theme-colors":"changeColor","keyup input":"changeInput"},changeColor:function(a){var b=jQuery(a.currentTarget),c=b.closest(".field-color-picker").find(".colorpicker-input"),d=b.data("color");c.val(d),c.css("color",this.inputColor(d)),c.css({backgroundColor:d}),this.model.set(c.prop("name"),d)},hexToRgb:function(a){var b=parseInt(a.replace(/#/,""),16);return"rgb("+(b>>16&255)+","+(b>>8&255)+","+(255&b)+")"},inputColor:function(a){var b=this.hexToRgb(a),c=b.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),d=c[1],e=c[2],f=c[3];return"rgb("+Math.floor(1*(255-d))+","+Math.floor(1*(255-e))+","+Math.floor(1*(255-f))+")"},changeInput:function(a){var b=jQuery(a.target),c=b.val();7===c.length&&(jQuery(a.target).css("color",this.inputColor(c)),jQuery(a.target).css({backgroundColor:b.val()})),this.model.set(b.attr("name"),b.val())},render:function(){if(void 0!==this.getValue())var a=this.inputColor(this.getValue());var b={label:this.settings.label,name:this.settings.name,value:this.getValue(),arr_colors:jQuery.inArray(this.getValue(),this.settings.colors),colors:this.settings.colors,inputColor:a};return this.$el.html(_.template(this.storage.getSkinTemplate("field-colorpicker-preview"))(b)),this}});var Fields=Fields||{};Fields.icon=QoobFieldView.extend({events:{"click .media-center":"clickMediaCenter","click .remove":"clickRemoveIcon","click .reset":"clickResetIconToDefault"},initialize:function(a){QoobFieldView.prototype.initialize.call(this,a),this.parentId=a.parentId,this.options=a;var b=this.storage.getAssets();this.icons=[];for(var c=0,d=b.length;c<d;c++)for(var e=0,f=b[c].length;e<f;e++)"icon"===b[c][e].type&&this.icons.push({classes:b[c][e].classes,tags:b[c][e].tags});this.tpl=_.template(this.storage.getSkinTemplate("field-icon-preview"))},clickRemoveIcon:function(a){a.preventDefault(),this.$el.find(".edit-icon").addClass("empty"),this.changeIcon("")},clickResetIconToDefault:function(a){a.preventDefault(),this.changeIcon(this.options.defaults),this.$el.find(".edit-icon").hasClass("empty")&&this.$el.find(".edit-icon").removeClass("empty")},changeIcon:function(a){var b=this.findByClasses(a);this.$el.find(".preview-icon span").attr({class:a,"data-icon-tags":b?b.tags:""}),this.$el.find('input[type="hidden"]').val(a),this.model.set(this.$el.find('input[type="hidden"]').attr("name"),a)},clickMediaCenter:function(){window.selectFieldIcon=function(a){""===a?this.$el.find(".edit-icon").addClass("empty"):this.$el.find(".edit-icon").removeClass("empty"),this.changeIcon(a)}.bind(this);var a=this.findByClasses(this.$el.find('input[type="hidden"]').val()),b=new IconCenterView({model:this.model,controller:this.controller,parentId:this.parentId,storage:this.storage,icon:a?{classes:a.classes,tags:a.tags}:"",icons:this.icons,no_icon:this.storage.__("no_icon","No icon")});return this.controller.setInnerSettingsView(b),!1},render:function(){var a={label:this.settings.label,name:this.settings.name,icon:this.findByClasses(this.getValue())||this.getValue(),media_center:this.storage.__("media_center","Media Center"),no_icon:this.storage.__("no_icon","No icon"),reset_to_default:this.storage.__("reset_to_default","Reset to default")};return(void 0===this.settings.show||this.settings.show(this.model))&&this.$el.html(this.tpl(a)),this},findByClasses:function(a){return _.findWhere(this.icons,{classes:a})}});var Fields=Fields||{};Fields.image=QoobFieldView.extend({customItems:null,counterDropZone:0,events:{"click .media-center":"clickMediaCenter","change .image-url":"changeInputUrlImage","click .remove":"clickRemoveImage","drop .drop-zone":"dropImage","dragenter .drop-zone":"dragOnDropZone","dragleave .drop-zone":"dragLeaveDropZone",global_drag_start:"showDropZone",global_drag_stop:"hideDropZone","click [data-id]":"clickAction"},initialize:function(a){QoobFieldView.prototype.initialize.call(this,a),this.options=a,this.parentId=a.parentId,this.tags=a.settings.tags||null,this.tpl=_.template(this.storage.getSkinTemplate("field-image-preview"))},clickAction:function(a){a.preventDefault();var b=jQuery(a.currentTarget).data("id");if("function"==typeof this.storage.driver.fieldImageActions){var c=this.customItems.find(function(a){return a.id===b});c.action&&c.action(this)}},changeImage:function(a){this.$el.find(".preview-image").attr("src",a),this.model.set(this.$el.find(".image-url").attr("name"),a),this.$el.find(".image-url").val(a)},clickRemoveImage:function(a){a.preventDefault(),this.$el.find(".edit-image").addClass("empty"),this.changeImage("")},showDropZone:function(){this.$el.find(".drop-zone").show()},hideDropZone:function(){this.$el.find(".drop-zone").hide()},dropImage:function(a){var b=this,c=a.originalEvent.dataTransfer.files;c[0].name.match(/.(jpg|jpeg|png|gif)$/i)?this.storage.driver.uploadImage(c,function(a,c){""!==c&&(b.changeImage(c),b.$el.find(".edit-image").hasClass("empty")&&b.$el.find(".edit-image").removeClass("empty"))}):console.error("file format is not appropriate"),this.counterDropZone=0},dragOnDropZone:function(){this.counterDropZone++,this.$el.find(".drop-zone").addClass("hover")},dragLeaveDropZone:function(){0===--this.counterDropZone&&this.$el.find(".drop-zone").removeClass("hover")},changeInputUrlImage:function(a){var b=jQuery(a.target).val();b.match(/.(jpg|jpeg|png|gif)$/i)?this.changeImage(b):this.changeImage("")},clickMediaCenter:function(){window.selectFieldImage=function(a){this.$el.find(".edit-image").removeClass("empty"),a||this.$el.find(".edit-image").addClass("empty"),this.changeImage(a)}.bind(this);var a=new ImageCenterView({model:this.model,controller:this.controller,parentId:this.parentId,storage:this.storage,curSrc:this.$el.find(".preview-image").attr("src"),assets:this.storage.getAssets(),tags:this.tags?this.tags.join(", "):"",hideDeleteButton:this.settings.hideDeleteButton});return this.controller.setInnerSettingsView(a),!1},render:function(){var a={hideDeleteButton:this.settings.hideDeleteButton,label:this.settings.label,name:this.settings.name,value:this.getValue(),media_center:this.storage.__("media_center","Media Center"),drop_here:this.storage.__("drop_here","Drop here"),no_image:this.storage.__("no_image","No image"),you_can_drop_it_here:this.storage.__("you_can_drop_it_here","You can drop it here")};if("function"==typeof this.storage.driver.mainMenu){var b=[];a.customItems=this.customItems=this.storage.driver.fieldImageActions(b)}return(void 0===this.settings.show||this.settings.show(this.model))&&this.$el.html(this.tpl(a)),this}});var Fields=Fields||{};Fields.select=QoobFieldView.extend({events:{"change select":"changeSelect","change input":"changeInput","click .theme-colors":"changeColor"},changeInput:function(a){var b=jQuery(a.target);this.model.set(b.attr("name"),b.parent().find(".active").attr("id"))},changeSelect:function(a){var b=jQuery(a.target);this.model.set(b.attr("name"),b.val())},changeColor:function(a){var b=jQuery(a.currentTarget);this.$el.find(".other-color").removeClass("active"),b.addClass("active"),this.$el.find("input").trigger("change")},render:function(){var a={label:this.settings.label,name:this.settings.name,current:this.model.get(this.settings.name)||this.settings.default,options:this.settings.options,visible_color:this.settings.visible_color};return this.$el.html(_.template(this.storage.getSkinTemplate("field-select-preview"))(a)),this}});var Fields=Fields||{};Fields.radio=QoobFieldView.extend({className:"field-radio field-group",events:{"change .radio__input":"changeInput"},changeInput:function(a){var b=jQuery(a.target);this.model.set(b.attr("name"),b.attr("id"))},render:function(){var a={label:this.settings.label,name:this.settings.name,current:this.model.get(this.settings.name)||this.settings.default,options:this.settings.options};return this.$el.html(_.template(this.storage.getSkinTemplate("field-radio-preview"))(a)),this}});var Fields=Fields||{};Fields.slider=QoobFieldView.extend({className:"field-slider field-group",events:{"change input":"changeInput"},changeInput:function(a){var b=jQuery(a.target);this.model.set(b.attr("name"),b.val())},render:function(){var a={sliderId:_.uniqueId("slider"),sizeId:_.uniqueId("size"),label:this.settings.label,name:this.settings.name,min:this.settings.min,max:this.settings.max,value:this.getValue()};return this.$el.html(_.template(this.storage.getSkinTemplate("field-slider-preview"))(a)),this}});var Fields=Fields||{};Fields.text_autocomplete=QoobFieldView.extend({uniqueId:null,className:"field-input-autocomplete field-group",events:{"keyup input":"changeInput"},changeInput:function(a){var b=jQuery(a.target);this.model.set(b.attr("name"),b.val())},getUniqueId:function(){return this.uniqueId=this.uniqueId||_.uniqueId("text-")},render:function(){var a={label:this.settings.label,name:this.settings.name,value:this.getValue(),placeholder:this.settings.placeholder,uniqueId:this.getUniqueId()};return this.$el.html(_.template(this.storage.getSkinTemplate("field-text-autocomplete-preview"))(a)),this}});var Fields=Fields||{};Fields.text=QoobFieldView.extend({className:"field-text field-group",events:{"keyup input":"changeInput"},changeInput:function(a){var b=jQuery(a.target);this.model.set(b.attr("name"),b.val())},render:function(){var a={label:this.settings.label,name:this.settings.name,value:this.getValue(),placeholder:this.settings.placeholder};return this.$el.html(_.template(this.storage.getSkinTemplate("field-text-preview"))(a)),this}});var Fields=Fields||{};Fields.textarea=QoobFieldView.extend({className:"field-textarea field-group",events:{change:"changeTextarea"},changeTextarea:function(a,b){this.model.set(this.settings.name,b.root.innerHTML)},render:function(){var a={label:this.settings.label,name:this.settings.name,value:this.getValue(),textareaId:_.uniqueId("textarea")};return this.$el.html(_.template(this.storage.getSkinTemplate("field-textarea-preview"))(a)),this}});var Fields=Fields||{};Fields.video=QoobFieldView.extend({customItems:null,counterDropZone:0,events:{"click .media-center":"clickMediaCenter","click .remove":"clickRemoveVideo","drop .drop-zone":"dropVideo","dragenter .drop-zone":"dragOnDropZone","dragleave .drop-zone":"dragLeaveDropZone",global_drag_start:"showDropZone",global_drag_stop:"hideDropZone","click [data-id]":"clickAction"},initialize:function(a){QoobFieldView.prototype.initialize.call(this,a),this.options=a,this.parentId=a.parentId,this.tags=a.settings.tags||null,this.tpl=_.template(this.storage.getSkinTemplate("field-video-preview"))},clickAction:function(a){a.preventDefault();var b=jQuery(a.currentTarget).data("id");if("function"==typeof this.storage.driver.fieldVideoActions){var c=this.customItems.find(function(a){return a.id===b});c.action&&c.action(this)}},changeVideo:function(a){""!==a?(this.$el.find(".video-container img").attr("src",a.preview),this.model.set(this.$el.find("input.url").attr("name"),a),this.$el.find("input.url").val(a.url),this.$el.find("input.preview").val(a.preview)):(this.$el.find(".video-container img").attr("src",""),this.model.set(this.$el.find("input.url").attr("name"),""),this.$el.find("input.url").val(""),this.$el.find("input.preview").val(""))},clickRemoveVideo:function(a){a.preventDefault(),this.$el.find(".edit-video").addClass("empty"),this.changeVideo("")},showDropZone:function(){this.$el.find(".drop-zone").show()},hideDropZone:function(){this.$el.find(".drop-zone").hide()},dropVideo:function(a){var b=a.originalEvent.dataTransfer.files;this.$el.find('input[type="file"]').prop("files",b),this.counterDropZone=0},dragOnDropZone:function(){this.counterDropZone++,this.$el.find(".drop-zone").addClass("hover")},dragLeaveDropZone:function(){0===--this.counterDropZone&&this.$el.find(".drop-zone").removeClass("hover")},clickMediaCenter:function(){window.selectFieldVideo=function(a){this.$el.find(".edit-video").removeClass("empty"),a||this.$el.find(".edit-video").addClass("empty"),this.changeVideo(a)}.bind(this);var a=new VideoCenterView({model:this.model,controller:this.controller,parentId:this.parentId,storage:this.storage,src:this.getValue(),assets:this.storage.getAssets(),tags:this.tags?this.tags.join(", "):"",hideDeleteButton:this.settings.hideDeleteButton});return this.controller.setInnerSettingsView(a),!1},render:function(){var a={label:this.settings.label,name:this.settings.name,src:this.getValue(),hideDeleteButton:this.settings.hideDeleteButton,media_center:this.storage.__("media_center","Media Center"),drop_here:this.storage.__("drop_here","Drop here"),no_video:this.storage.__("no_video","No video"),no_poster:this.storage.__("no_poster","No poster"),you_can_drop_it_here:this.storage.__("you_can_drop_it_here","You can drop it here"),formats:this.storage.__("formats","mp4, ogv, webm")};if("function"==typeof this.storage.driver.mainMenu){var b=[];a.customItems=this.customItems=this.storage.driver.fieldVideoActions(b)}return(void 0===this.settings.show||this.settings.show(this.model))&&this.$el.html(this.tpl(a)),this}});var IconCenterView=Backbone.View.extend({className:"settings menu-block",offset:0,limit:12,dataSearchIcons:null,events:{keydown:"keyAction","click .backward-icon":"backward","click #inner-settings-icon .ajax-icon":"selectIcon","keyup #inner-settings-icon .icon-search":"searchFilter","click .remove":"clickRemoveIcon","click .search-button":"clickSearchButton",shown:"afterRender"},attributes:function(){return{id:"settings-block-media","data-side-id":"settings-block-media"}},initialize:function(a){this.storage=a.storage,this.controller=a.controller,this.tpl=_.template(this.storage.getSkinTemplate("field-icon-setting-preview")),this.backId=void 0===a.parentId?this.model.id:a.parentId,this.icons=a.icons,this.icon=a.icon,this.tags=a.icon.tags||""},render:function(){return this.$el.html(this.tpl({back:this.storage.__("back","Back"),search:this.storage.__("search","Search"),no_icon:this.storage.__("no_icon","No icon"),icon:this.icon})),this},afterRender:function(){var a=this;this.tags&&this.$el.find(".icon-search").val(this.tags),this.loadMore(),this.$el.find(".filtered-icons").on("scroll",function(){a.checkLoadMore()&&a.loadMore()})},checkLoadMore:function(){var a=this.$el.find(".filtered-icons");return this.$el.find(".inview-icons").offset().top<a.offset().top+a.height()},keyAction:function(a){if(13==a.keyCode)return this.$el.find(".search-button").click(),this.$el.find(".icon-search").autocomplete("close"),!1},clickSearchButton:function(){var a=this.$el.find(".icon-search").val().split(",");this.$el.find(".filtered-icons").find(".ajax-icon").remove(),this.tags=a,this.offset=0,this.loadMore()},loadMore:function(){var a=this.$el.find(".filtered-icons"),b=this.getIcons(this.tags,this.offset);b&&(this.offset=this.offset+this.limit,a.find(".inview-icons").before(b),this.checkLoadMore()&&this.loadMore())},getIcons:function(a,b){var c=a,d=[];if(_.isString(c)?c=c.split(","):_.isArray(c)&&(c=c.join("").split(",")),c.length<=1&&""===c[0]||!c)for(var e=this.icons.slice(b,b+this.limit),f=0;f<e.length;f++)d.push('<div class="ajax-icon"><span  data-icon-tags="'+e[f].tags+'" class="'+e[f].classes+'"></span> </div>');else{this.dataSearchIcons=[];for(var g=0;g<this.icons.length;g++)for(var h=0;h<c.length;h++){
var i=new RegExp(c[h].replace(/ /g," *"));""!==c[h]&&this.icons[g].tags.match(i)&&this.dataSearchIcons.push(this.icons[g])}for(var j=this.dataSearchIcons.slice(b,b+this.limit),k=0;k<j.length;k++)d.push('<div class="ajax-icon"><span  data-icon-tags="'+j[k].tags+'" class="'+j[k].classes+'"></span> </div>')}return d.join("")},backward:function(a){a.preventDefault(),this.controller.layout.menu.rotateBackward(this.backId)},selectIcon:function(a){if(!a.currentTarget.classList.contains("chosen")){var b=this.$(a.currentTarget).find("span");this.$el.find(".ajax-icon").removeClass("chosen"),a.currentTarget.classList.add("chosen"),this.$el.find(".selected-icon").hasClass("empty")&&this.$el.find(".selected-icon").removeClass("empty"),this.$el.find(".preview-icon span").attr({class:b.attr("class"),"data-icon-tags":b.attr("data-icon-tags")}),window.selectFieldIcon(b.attr("class"))}},clickRemoveIcon:function(a){a.preventDefault(),window.selectFieldIcon(""),this.$el.find(".selected-icon").addClass("empty"),this.$el.find(".ajax-icon").removeClass("chosen")},searchFilter:function(){for(var a=this,b=[],c=this.icons,d=0;d<c.length;d++)_.isUndefined(c[d].tags)||b.push(c[d].tags);var e=_.union(_.flatten(b));this.$el.find(".icon-search").autocomplete({source:e,select:function(){a.$el.find(".search-button").trigger("click")}}).data("ui-autocomplete")._renderItem=function(a,b){return a.addClass("settings-autocomplete media-autocomplete"),jQuery("<li>").attr("data-value",b.value).append(b.label).appendTo(a)}},dispose:function(){this.$el.remove(),this.off()}}),ImageCenterView=Backbone.View.extend({className:"settings menu-block",dataImages:null,dataSearchImages:null,offset:0,limit:12,events:{keydown:"keyAction","click .backward-image":"backward","click #inner-settings-image .ajax-image":"selectImage","keyup #inner-settings-image .img-search":"searchFilter","click .remove":"deleteImage","click .search-button":"clickSearchButton",shown:"afterRender"},attributes:function(){return{id:"settings-block-media","data-side-id":"settings-block-media"}},initialize:function(a){this.storage=a.storage,this.controller=a.controller,this.tpl=_.template(this.storage.getSkinTemplate("field-image-setting-preview")),this.backId=void 0===a.parentId?this.model.id:a.parentId,this.curSrc=a.curSrc,this.assets=a.assets,this.tags=a.tags,this.hideDeleteButton=a.hideDeleteButton,this.dataImages=[];for(var b=0;b<this.assets.length;b++)for(var c=0,d=this.assets[b];c<d.length;c++)"image"===d[c].type&&this.dataImages.push({src:this.assets[b][c].src,tags:this.assets[b][c].tags})},render:function(){return this.$el.html(this.tpl({curSrc:this.curSrc,hideDeleteButton:this.hideDeleteButton,back:this.storage.__("back","Back"),search:this.storage.__("search","Search"),no_image:this.storage.__("no_image","No image")})),this},afterRender:function(){var a=this;this.tags&&this.$el.find(".img-search").val(this.tags),this.loadMore(),this.$el.find(".filtered-images").on("scroll",function(){a.checkLoadMore()&&a.loadMore()})},checkLoadMore:function(){var a=this.$el.find(".filtered-images");return this.$el.find(".inview-images").offset().top<a.offset().top+a.height()},keyAction:function(a){if(13==a.keyCode)return this.$el.find(".search-button").click(),this.$el.find(".img-search").autocomplete("close"),!1},clickSearchButton:function(){var a=this.$el.find(".img-search").val().split(",");this.$el.find(".filtered-images").find(".ajax-image").remove(),this.tags=a,this.offset=0,this.loadMore()},loadMore:function(){var a=this.$el.find(".filtered-images"),b=this.getImages(this.tags,this.offset);b&&(this.offset=this.offset+this.limit,a.find(".inview-images").before(b),this.checkLoadMore()&&this.loadMore())},getImages:function(a,b){var c=a,d=[];if(_.isString(c)?c=c.split(","):_.isArray(c)&&(c=c.join("").split(",")),c.length<=1&&""===c[0]||!c)for(var e=this.dataImages.slice(b,b+this.limit),f=0;f<e.length;f++)d.push('<div class="ajax-image"><img src="'+e[f].src+'" alt="" /></div>');else{this.dataSearchImages=[];for(var g=0;g<this.dataImages.length;g++)for(var h=0;h<c.length;h++){var i=new RegExp(c[h].replace(/ /g," *"));""!==c[h]&&this.dataImages[g].tags&&this.dataImages[g].tags.join(" ").match(i)&&this.dataSearchImages.push(this.dataImages[g])}for(var j=this.dataSearchImages.slice(b,b+this.limit),k=0;k<j.length;k++)d.push('<div class="ajax-image"><img src="'+j[k].src+'" alt="" /></div>')}return d.join("")},backward:function(a){a.preventDefault(),this.controller.layout.menu.rotateBackward(this.backId)},selectImage:function(a){a.currentTarget.classList.contains("chosen")||(this.$el.find(".ajax-image").removeClass("chosen"),a.currentTarget.classList.add("chosen"),this.$el.find(".image-container img").attr("src",a.target.getAttribute("src")),this.$el.find(".selected-image").hasClass("empty")&&this.$el.find(".selected-image").removeClass("empty"),window.selectFieldImage(a.target.getAttribute("src")))},deleteImage:function(a){a.preventDefault(),window.selectFieldImage(""),this.$el.find(".selected-image").addClass("empty"),this.$el.find(".ajax-image").removeClass("chosen")},searchFilter:function(){for(var a=this,b=[],c=this.dataImages,d=0;d<c.length;d++)_.isUndefined(c[d].tags)||b.push(c[d].tags);var e=_.union(_.flatten(b));this.$el.find(".img-search").autocomplete({source:e,select:function(){a.$el.find(".search-button").trigger("click")}}).data("ui-autocomplete")._renderItem=function(a,b){return a.addClass("settings-autocomplete media-autocomplete"),jQuery("<li>").attr("data-value",b.value).append(b.label).appendTo(a)}},dispose:function(){this.$el.remove(),this.off()}}),VideoCenterView=Backbone.View.extend({className:"settings menu-block",dataVideos:null,dataSearchVideos:null,offset:0,limit:12,events:{keydown:"keyAction","click .backward-video":"backward","click #inner-settings-video .ajax-video":"selectVideo","keyup #inner-settings-video .video-search":"searchFilter","click .remove":"deleteVideo","click .search-button":"clickSearchButton",shown:"afterRender"},attributes:function(){return{id:"settings-block-media","data-side-id":"settings-block-media"}},initialize:function(a){this.storage=a.storage,this.controller=a.controller,this.tpl=_.template(this.storage.getSkinTemplate("field-video-setting-preview")),this.backId=void 0===a.parentId?this.model.id:a.parentId,this.src=a.src,this.assets=a.assets,this.tags=a.tags,this.hideDeleteButton=a.hideDeleteButton,this.dataVideos=[];for(var b=0;b<this.assets.length;b++)for(var c=0;c<this.assets[b].length;c++)"video"===this.assets[b][c].type&&this.dataVideos.push({src:this.assets[b][c].src,pack:this.assets[b][c].pack,tags:this.assets[b][c].tags,title:this.assets[b][c].title?this.assets[b][c].title:"",preview:this.assets[b][c].preview?this.assets[b][c].preview:""})},render:function(){return this.$el.html(this.tpl({back:this.storage.__("back","Back"),no_video:this.storage.__("no_video","No video"),no_poster:this.storage.__("no_poster","No poster"),search:this.storage.__("search","Search"),src:this.src,hideDeleteButton:this.hideDeleteButton})),this},afterRender:function(){var a=this;this.tags&&this.$el.find(".video-search").val(this.tags),this.loadMore(),this.$el.find(".filtered-videos").on("scroll",function(){a.checkLoadMore()&&a.loadMore()})},keyAction:function(a){if(13==a.keyCode)return this.$el.find(".search-button").click(),this.$el.find(".video-search").autocomplete("close"),!1},clickSearchButton:function(){var a=this.$el.find(".video-search").val().split(",");this.$el.find(".filtered-videos").find(".ajax-video").remove(),this.tags=a,this.offset=0,this.loadMore()},checkLoadMore:function(){var a=this.$el.find(".filtered-videos");return this.$el.find(".inview-videos").offset().top<a.offset().top+a.height()},loadMore:function(){var a=this.$el.find(".filtered-videos"),b=this.getVideos(this.tags,this.offset);b&&(this.offset=this.offset+this.limit,a.find(".inview-videos").before(b),this.checkLoadMore()&&this.loadMore())},getVideos:function(a,b){var c=a,d=[];if(_.isString(c)?c=c.split(","):_.isArray(c)&&(c=c.join("").split(",")),c.length<=1&&""===c[0]||!c)for(var e=this.dataVideos.slice(b,b+this.limit),f=0;f<e.length;f++)d.push('<div class="ajax-video" data-src="'+e[f].src+'"><img src="'+e[f].preview+'" alt="" /></div>');else{this.dataSearchVideos=[];for(var g=0;g<this.dataVideos.length;g++)for(var h=0;h<c.length;h++){var i=new RegExp(c[h].replace(/ /g," *"));""!==c[h]&&this.dataVideos[g].tags&&this.dataVideos[g].tags.join(" ").match(i)&&this.dataSearchVideos.push(this.dataVideos[g])}for(var j=this.dataSearchVideos.slice(b,b+this.limit),k=0;k<j.length;k++)d.push('<div class="ajax-video" data-src="'+j[k].src+'"><img src="'+j[k].preview+'" alt="" /></div>')}return d.join("")},backward:function(a){a.preventDefault(),this.controller.layout.menu.rotateBackward(this.backId)},selectVideo:function(a){if(!a.currentTarget.classList.contains("chosen")){this.$el.find(".ajax-video").removeClass("chosen"),a.currentTarget.classList.add("chosen");var b=this.$(a.currentTarget).attr("data-src"),c=this.$(a.currentTarget).find("img").attr("src");this.$el.find(".video-container img").attr("src",c),this.$el.find(".selected-video").hasClass("empty")&&this.$el.find(".selected-video").removeClass("empty"),window.selectFieldVideo({url:b,preview:c})}},deleteVideo:function(a){a.preventDefault(),window.selectFieldVideo(""),this.$el.find(".selected-video").addClass("empty"),this.$el.find(".ajax-video").removeClass("chosen")},searchFilter:function(){for(var a=this,b=[],c=this.dataVideos,d=0;d<c.length;d++)_.isUndefined(c[d].tags)||b.push(c[d].tags);var e=_.union(_.flatten(b));this.$el.find(".video-search").autocomplete({source:e,select:function(){a.$el.find(".search-button").trigger("click")}}).data("ui-autocomplete")._renderItem=function(a,b){return a.addClass("settings-autocomplete media-autocomplete"),jQuery("<li>").attr("data-value",b.value).append(b.label).appendTo(a)}},dispose:function(){this.$el.remove(),this.off()}}),QoobExtensions=QoobExtensions||{};QoobExtensions.templating=QoobExtensions.templating||[],QoobExtensions.templating.handlebars=QoobExtensions.templating.hbs=function(a){var b=Handlebars.compile(a);return function(a){return b(a)}};var QoobExtensions=QoobExtensions||{};QoobExtensions.templating=QoobExtensions.templating||[],QoobExtensions.templating.underscore=function(a){var b=_.template(a);return function(a){return b(a)}},QoobStorage.prototype.getGroups=function(a){var b=[];return _.each(this.librariesData,function(c){null!=a&&a!=c.name||(b=_.reduce(c.groups,function(a,b){var d=_.findWhere(a,{id:b.id});if(d)d.position=(parseInt(d.position)+parseInt(b.position))/2,d.libs.push(c.name);else{var e=_.clone(b);e.libs=[c.name],a.push(e)}return a},b))}),_.sortBy(b,"position")},QoobStorage.prototype.getBlocksByGroup=function(a,b){var c=[],d=this.librariesData;b&&(d=d.filter(function(a){return-1!==b.indexOf(a.name)}));for(var e=0;e<d.length;e++)c=c.concat(d[e].blocks.filter(function(b){return b.lib=d[e].name,a?!!b.settings&&b.groups===a:!!b.settings}));return c},QoobStorage.prototype.getSkinTemplate=function(a){return this.skinTemplates[a]},QoobStorage.prototype.getDefaultTemplateAdapter=function(){return this.blockTemplateAdapter},QoobStorage.prototype.getBlockConfig=function(a,b){var c,d=_.findWhere(this.librariesData,{name:a});return void 0!=d&&(c=_.findWhere(d.blocks,{name:b})),c},QoobStorage.prototype.getBlockTemplate=function(a,b,c){var d=this;if(this.blockTemplates[a+"_"+b])c(null,this.blockTemplates[a+"_"+b]);else{var e=_.findWhere(this.librariesData,{name:a}),f="blockNotFound";if(void 0===e)c(f,null);else{var g=_.findWhere(e.blocks,{name:b});if(void 0===g)c(f,null);else{var h=g.url+g.template;this.loader.add({type:"data",name:"block_"+a+"_"+b,src:h,onloaded:function(e){d.blockTemplates[a+"_"+b]=e,c(null,e)}})}}}},QoobStorage.prototype.save=function(a,b,c){var d={data:a,html:b,libs:this.librariesData};this.driver.savePageData(d,function(a,b){c(a,b)})},QoobStorage.prototype.__=function(a,b){return b},QoobStorage.prototype.getAssets=function(a){var b=[],c=this.librariesData;a&&(c=c.filter(function(b){return-1!==a.indexOf(b.name)}));for(var d=0;d<c.length;d++)for(var e=0;e<c[d].blocks.length;e++)c[d].blocks[e].assets&&b.push(c[d].blocks[e].assets);return b},QoobStorage.prototype.loadPageTemplates=function(a){var b=this;this.driver.loadPageTemplates(function(c,d){d&&d.length>0&&b.pageTemplatesCollection.add(d),a(c)})},QoobStorage.prototype.createPageTemplate=function(a,b){this.pageTemplatesCollection.add(a);var c=this.pageTemplatesCollection.filter(function(a){return!0!==a.get("external")});this.driver.savePageTemplate(c,function(a,c){c&&b(a,c)})},QoobStorage.prototype.removePageTemplate=function(a){var b=this.pageTemplatesCollection.get(a);this.pageTemplatesCollection.remove(b);var c=this.pageTemplatesCollection.filter(function(a){return!0!==a.get("external")});this.driver.savePageTemplate(c,function(a,b){b&&console.log("Done",b)})},QoobStorage.prototype.getLibraryByUrl=function(a,b){jQuery.ajax({dataType:"json",url:a,error:function(a,c,d){b(c)},success:function(a){b(null,a)}})};var QoobUtils={genId:function(a){window.usedQoobIds=window.usedQoobIds||[];for(var b=a||parseInt(_.uniqueId());-1!=window.usedQoobIds.indexOf(b);)b=parseInt(_.uniqueId());return window.usedQoobIds.push(b),b},createModel:function(a){a.id=QoobUtils.genId(a.id);var b=new BlockModel,c={};for(var d in a)_.isArray(a[d])?(c[d]=this.createCollection(a[d]),b.listenTo(c[d],"change",function(){this.trigger("change",this)}),c[d].forEach(function(b){b.owner_id=a.id})):c[d]=a[d],b.set(d,c[d]);return b},createCollection:function(a){for(var b=new Backbone.Collection,c=0;c<a.length;c++){var d=this.createModel(a[c]);b.add(d),b.listenTo(d,"change",function(){this.trigger("change",this)})}return b},getDefaultSettings:function(a,b){var c={},d={},e={};Array.isArray(a)?(d=_.findWhere(a,{name:b}).settings,e=_.findWhere(a,{name:b}).defaults):(d=a.settings,e=a.defaults);for(var f=0;f<d.length;f++)c[d[f].name]=e[d[f].name];return c.block=b,c.lib=a.lib,c}};